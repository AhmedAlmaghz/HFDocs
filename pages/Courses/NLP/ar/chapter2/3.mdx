# ุงูููุงุฐุฌ

ูู ูุฐุง ุงููุณูุ ุณูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุฅูุดุงุก ูุงุณุชุฎุฏุงู ูููุฐุฌ. ุณูุณุชุฎุฏู ูุฆุฉ `AutoModel`ุ ูุงูุชู ุชููู ูููุฏุฉ ุนูุฏูุง ุชุฑูุฏ ุฅูุดุงุก ูุซูู ูุฃู ูููุฐุฌ ูู ููุทุฉ ุชูุชูุด.

ูุฆุฉ `AutoModel` ูุฌููุน ุฃูุงุฑุจูุง ุนุจุงุฑุฉ ุนู ุฃุบููุฉ ุจุณูุทุฉ ุจุงููุนู ุญูู ูุฌููุนุฉ ูุชููุนุฉ ูุงุณุนุฉ ูู ุงูููุงุฐุฌ ุงููุชุงุญุฉ ูู ุงูููุชุจุฉ. ุฅูู ุบูุงู ุฐูู ูุฃูู ููููู ุชุฎููู ุจููุฉ ุงููููุฐุฌ ุงูููุงุณุจุฉ ูููุทุฉ ุงูุชูุชูุด ุชููุงุฆููุงุ ุซู ูููู ุจุฅูุดุงุก ูุซูู ููููุฐุฌ ุจูุฐู ุงูุจููุฉ.

ููุน ุฐููุ ุฅุฐุง ููุช ุชุนุฑู ููุน ุงููููุฐุฌ ุงูุฐู ุชุฑูุฏ ุงุณุชุฎุฏุงููุ ูููููู ุงุณุชุฎุฏุงู ุงููุฆุฉ ุงูุชู ุชุญุฏุฏ ุจููุชูุง ูุจุงุดุฑุฉู. ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุนูู ุฐูู ูุน ูููุฐุฌ BERT.

## ุฅูุดุงุก ูุญูู

ุฃูู ุดูุก ุณูุญุชุงุฌ ุฅูู ูุนูู ูุชููุฆุฉ ูููุฐุฌ BERT ูู ุชุญููู ูุงุฆู ุงูุชูููู:

```py
from transformers import BertConfig, BertModel

# ุจูุงุก ุงูุชูููู
config = BertConfig()

# ุจูุงุก ุงููููุฐุฌ ูู ุงูุชูููู
model = BertModel(config)
```

ูุญุชูู ุงูุชูููู ุนูู ุงูุนุฏูุฏ ูู ุงูุณูุงุช ุงูุชู ุชูุณุชุฎุฏู ูุจูุงุก ุงููููุฐุฌ:

```py
print(config)
```

```python out
BertConfig {
[...]
"hidden_size": 768ุ
"intermediate_size": 3072ุ
"max_position_embeddings": 512ุ
"num_attention_heads": 12ุ
"num_hidden_layers": 12ุ
[...]
}
```

ุนูู ุงูุฑุบู ูู ุฃูู ูู ุชุฑู ูุง ุชูุนูู ูู ูุฐู ุงูุณูุงุช ุจุนุฏุ ุฅูุง ุฃูู ูุฌุจ ุฃู ุชุนุฑู ุจุนุถูุง: ุชุญุฏุฏ ุณูุฉ `hidden_size` ุญุฌู ูุชุฌู `hidden_states`ุ ูุชุญุฏุฏ `num_hidden_layers` ุนุฏุฏ ุงูุทุจูุงุช ุงูุชู ููุชูููุง ูููุฐุฌ ุงููุญูู.

### ุทุฑู ุงูุชุญููู ุงููุฎุชููุฉ

ูุชู ุชููุฆุฉ ุงููููุฐุฌ ุงูุฐู ุชู ุฅูุดุงุคู ูู ุงูุชูููู ุงูุงูุชุฑุงุถู ุจุงุณุชุฎุฏุงู ููู ุนุดูุงุฆูุฉ:

```py
from transformers import BertConfig, BertModel

config = BertConfig()
model = BertModel(config)

# ุชู ุชููุฆุฉ ุงููููุฐุฌ ุจุดูู ุนุดูุงุฆู!
```

ูููู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ูู ูุฐู ุงูุญุงูุฉุ ููููู ุณููุชุฌ ููุงููุง ุบูุฑ ูููููุ ูุญุชุงุฌ ุฅูู ุงูุชุฏุฑูุจ ุฃููุงู. ูููููุง ุชุฏุฑูุจ ุงููููุฐุฌ ูู ุงูุตูุฑ ุนูู ุงููููุฉ ุงููุทุฑูุญุฉุ ูููู ููุง ุฑุฃูุช ูู [ุงููุตู 1](/course/chapter1)ุ ุณูุชุทูุจ ุฐูู ููุชูุง ุทูููุงู ููููุฉ ูุจูุฑุฉ ูู ุงูุจูุงูุงุชุ ูุณูููู ูู ุชุฃุซูุฑ ุจูุฆู ูุจูุฑ. ูุชุฌูุจ ุงูุฌูุฏ ุบูุฑ ุงูุถุฑูุฑู ูุงูููุฑุฑุ ูู ุงูุถุฑูุฑู ุฃู ุชููู ูุงุฏุฑูุง ุนูู ูุดุงุฑูุฉ ุงูููุงุฐุฌ ุงูุชู ุชู ุชุฏุฑูุจูุง ุจุงููุนู ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง.

ุฅู ุชุญููู ูููุฐุฌ ูุญูู ูุฏุฑุจ ุจุงููุนู ุฃูุฑ ุจุณูุท - ูููููุง ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `from_pretrained()` :

```py
from transformers import BertModel

model = BertModel.from_pretrained("bert-base-cased")
```

ููุง ุฑุฃูุช ุณุงุจููุงุ ูููููุง ุงุณุชุจุฏุงู `BertModel` ุจูุฆุฉ `AutoModel` ุงูููุงูุฆุฉ. ุณููุนู ุฐูู ูู ุงูุขู ูุตุงุนุฏูุง ุญูุซ ููุชุฌ ุนูู ุฑูุฒ ุบูุฑ ูุฑุชุจุท ุจููุทุฉ ุชูุชูุด ูุนููุฉุ ุฅุฐุง ูุงู ุฑูุฒู ูุนูู ูููุทุฉ ุชูุชูุด ูุงุญุฏุฉุ ููุฌุจ ุฃู ูุนูู ุจุณูุงุณุฉ ูุน ููุทุฉ ุฃุฎุฑู. ููุทุจู ูุฐุง ุญุชู ุฅุฐุง ูุงูุช ุงูุจููุฉ ูุฎุชููุฉุ ุทุงููุง ุชู ุชุฏุฑูุจ ููุทุฉ ุงูุชูุชูุด ุนูู ูููุฉ ููุงุซูุฉ (ุนูู ุณุจูู ุงููุซุงูุ ูููุฉ ุชุญููู ุงููุดุงุนุฑ).

ูู ุนููุฉ ุงูุฑูุฒ ุฃุนูุงูุ ูู ูุณุชุฎุฏู `BertConfig`ุ ูุจุฏูุงู ูู ุฐูู ูููุง ุจุชุญููู ูููุฐุฌ ูุฏุฑุจ ูุณุจููุง ุนุจุฑ ูุญุฏุฏ `bert-base-cased`. ูุฐู ููุทุฉ ุชูุชูุด ูููููุฐุฌ ุชู ุชุฏุฑูุจูุง ุจูุงุณุทุฉ ูุคููู BERT ุฃููุณููุ ููููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูููุง ูู [ุจุทุงูุฉ ุงููููุฐุฌ](https://huggingface.co/bert-base-cased) ุงูุฎุงุตุฉ ุจูุง.

ูุฐุง ุงููููุฐุฌ ููููุฃ ุงูุขู ุจุฌููุน ุฃูุฒุงู ููุทุฉ ุงูุชูุชูุด. ูููู ุงุณุชุฎุฏุงูู ูุจุงุดุฑุฉ ููุงุณุชุฏูุงู ุนูู ุงูููุงู ุงูุชู ุชู ุชุฏุฑูุจู ุนูููุงุ ููููู ุฃูุถูุง ุถุจุทู ุจุฏูุฉ ุนูู ูููุฉ ุฌุฏูุฏุฉ. ูู ุฎูุงู ุงูุชุฏุฑูุจ ุจุฃูุฒุงู ูุฏุฑุจุฉ ูุณุจููุง ุจุฏูุงู ูู ุงูุตูุฑุ ูููููุง ุชุญููู ูุชุงุฆุฌ ุฌูุฏุฉ ุจุณุฑุนุฉ.

ุชู ุชูุฒูู ุงูุฃูุฒุงู ูุชู ุชุฎุฒูููุง ูุคูุชูุง (ูุฐูู ูู ุชููู ุงูุงุณุชุฏุนุงุกุงุช ุงููุณุชูุจููุฉ ูุทุฑููุฉ `from_pretrained()` ุจุฅุนุงุฏุฉ ุชูุฒูููุง) ูู ูุฌูุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุชุ ูุงูุฐู ูููู ุงูุชุฑุงุถููุง *~/.cache/huggingface/transformers*. ููููู ุชุฎุตูุต ูุฌูุฏ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฎุงุต ุจู ุนู ุทุฑูู ุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ `HF_HOME`.

ูููู ุฃู ูููู ุงููุนุฑู ุงููุณุชุฎุฏู ูุชุญููู ุงููููุฐุฌ ูู ูุนุฑู ุฃู ูููุฐุฌ ุนูู Model Hubุ ุทุงููุง ุฃูู ูุชูุงูู ูุน ุจููุฉ BERT. ูููู ุงูุนุซูุฑ ุนูู ุงููุงุฆูุฉ ุงููุงููุฉ ูููุงุท ุชูุชูุด BERT ุงููุชุงุญุฉ [ููุง](https://huggingface.co/models?filter=bert).

### ุทุฑู ุงูุญูุธ

ุฅู ุญูุธ ูููุฐุฌ ุณูู ูุซู ุชุญูููู - ูุณุชุฎุฏู ุทุฑููุฉ `save_pretrained()`ุ ูุงูุชู ุชุดุจู ุทุฑููุฉ `from_pretrained()` :

```py
model.save_pretrained("directory_on_my_computer")
```

ูุฐุง ูุญูุธ ููููู ุนูู ูุฑุตู:

```
ls directory_on_my_computer

config.json pytorch_model.bin
```

ุฅุฐุง ูุธุฑุช ุฅูู ููู *config.json*ุ ูุณุชุชุนุฑู ุนูู ุงูุณูุงุช ุงููุงุฒูุฉ ูุจูุงุก ุจููุฉ ุงููููุฐุฌ. ูุญุชูู ูุฐุง ุงูููู ุฃูุถูุง ุนูู ุจุนุถ ุงูุจูุงูุงุช ุงููุตููุฉุ ูุซู ุงูููุงู ุงูุฐู ูุดุฃุช ููู ููุทุฉ ุงูุชูุชูุด ูุฅุตุฏุงุฑ ๐ค Transformers ุงูุฐู ููุช ุชุณุชุฎุฏูู ุนูุฏูุง ููุช ุขุฎุฑ ูุฑุฉ ุจุญูุธ ููุทุฉ ุงูุชูุชูุด.

ููู *pytorch_model.bin* ูุนุฑูู ุจุงุณู *ูุงููุณ ุงูุญุงูุฉ*ุ ูุญุชูู ุนูู ุฌููุน ุฃูุฒุงู ูููุฐุฌู. ูุณูุฑ ุงููููุงู ุฌูุจูุง ุฅูู ุฌูุจุ ุงูุชูููู ุถุฑูุฑู ููุนุฑูุฉ ุจููุฉ ูููุฐุฌูุ ูู ุญูู ุฃู ุฃูุฒุงู ุงููููุฐุฌ ูู ูุนููุงุช ูููุฐุฌู.

## ุงุณุชุฎุฏุงู ูููุฐุฌ ูุญูู ููุงุณุชุฏูุงู

ุงูุขู ุจุนุฏ ุฃู ุนุฑูุช ููููุฉ ุชุญููู ูุญูุธ ูููุฐุฌุ ุฏุนูุง ูุญุงูู ุงุณุชุฎุฏุงูู ูุฅุฌุฑุงุก ุจุนุถ ุงูุชูุจุคุงุช. ูุง ูููู ูููุงุฐุฌ ุงููุญูู ูุนุงูุฌุฉ ุณูู ุงูุฃุฑูุงู - ุงูุฃุฑูุงู ุงูุชู ูููุฏูุง ุงููุนุงูุฌ. ูููู ูุจู ููุงูุดุฉ ุงููุนุงูุฌุงุชุ ุฏุนูุง ูุณุชูุดู ุงููุฏุฎูุงุช ุงูุชู ููุจููุง ุงููููุฐุฌ.

ูููู ูููุนุงูุฌุงุช ุงูุชุนุงูู ูุน ูููุจุฉ ุงููุฏุฎูุงุช ุฅูู ุงูููุณูุฌุงุช ุงูุฎุงุตุฉ ุจุงูุฅุทุงุฑ ุงูููุงุณุจุ ูููู ููุณุงุนุฏุชู ุนูู ููู ูุง ูุญุฏุซุ ุณูููู ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ูุง ูุฌุจ ูุนูู ูุจู ุฅุฑุณุงู ุงููุฏุฎูุงุช ุฅูู ุงููููุฐุฌ.

ูููุชุฑุถ ุฃู ูุฏููุง ุจุนุถ ุงูุชุณูุณูุงุช:

```py
sequences = ["Hello!"ุ "Cool."ุ "Nice!"]
```

ูููู ุงููุนุงูุฌ ุจุชุญููู ูุฐู ุงูุชุณูุณูุงุช ุฅูู ููุฑุณ ุงูููุฑุฏุงุช ูุงูุชู ููุดุงุฑ ุฅูููุง ุนุงุฏุฉู ุจุงุณู *ูุนุฑูุงุช ุงูุฅุฏุฎุงู*. ูู ุชุณูุณู ุงูุขู ุนุจุงุฑุฉ ุนู ูุงุฆูุฉ ุจุงูุฃุฑูุงู! ุงููุงุชุฌ ุงููุงุชุฌ ูู:

```py no-format
encoded_sequences = [
[101ุ 7592ุ 999ุ 102]ุ
[101ุ 4658ุ 1012ุ 102]ุ
[101ุ 3835ุ 999ุ 102]ุ
]
```

ูุฐู ูุงุฆูุฉ ุจุงูุชุณูุณูุงุช ุงููุดูุฑุฉ: ูุงุฆูุฉ ุจุงูููุงุฆู. ุชูุจู ุงูููุณูุฌุงุช ุงูุฃุดูุงู ุงููุณุชุทููุฉ ููุท (ููุฑ ูู ุงููุตูููุงุช). ูุฐุง "ุงููุตูููุฉ" ูุณุชุทููุฉ ุจุงููุนูุ ูุฐุง ูุฅู ุชุญููููุง ุฅูู ููุณูุฌุฉ ุฃูุฑ ุณูู:

```py
import torch

model_inputs = torch.tensor(encoded_sequences)
```

### ุงุณุชุฎุฏุงู ุงูููุณูุฌุงุช ููุฏุฎูุงุช ูููููุฐุฌ

ุฅู ุงูุงุณุชูุงุฏุฉ ูู ุงูููุณูุฌุงุช ูุน ุงููููุฐุฌ ุฃูุฑ ุจุณูุท ููุบุงูุฉ - ูุง ุนูููุง ุณูู ุงุณุชุฏุนุงุก ุงููููุฐุฌ ุจุงููุฏุฎูุงุช:

```py
output = model(model_inputs)
```

ูู ุญูู ุฃู ุงููููุฐุฌ ููุจู ุงููุซูุฑ ูู ุงูุญุฌุฌ ุงููุฎุชููุฉุ ูุฅู ูุนุฑูุงุช ุงูุฅุฏุฎุงู ุถุฑูุฑูุฉ ููุท. ุณูุดุฑุญ ูุง ุชูุนูู ุงูุญุฌุฌ ุงูุฃุฎุฑู ููุชู ุชููู ูุทููุจุฉ ูุงุญููุงุ
ูููู ุฃููุงู ูุญุชุงุฌ ุฅูู ุฅููุงุก ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงููุนุงูุฌุงุช ุงูุชู ุชููู ุจุจูุงุก ุงููุฏุฎูุงุช ุงูุชู ูููู ููููุฐุฌ ุงููุญูู ููููุง.