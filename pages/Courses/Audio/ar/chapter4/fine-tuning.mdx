# ุถุจุท ูููุฐุฌ ูุชุตููู ุงูููุณููู 

ูู ูุฐุง ุงููุณูุ ุณููุฏู ุฏููููุง ุฎุทูุฉ ุจุฎุทูุฉ ุญูู ููููุฉ ุถุจุท ูููุฐุฌ ูุญูู ุงูุชุฑููุฒ ููุท ูุชุตููู ุงูููุณููู.

ุณูุณุชุฎุฏู ูููุฐุฌูุง ุฎููู ุงููุฒู ููุฐุง ุงูุนุฑุถ ุงูุชูุถูุญู ููุฌููุนุฉ ุจูุงูุงุช ุตุบูุฑุฉ ุฅูู ุญุฏ ูุงุ ููุง ูุนูู ุฃู ุงูููุฏ ูุงุจู ููุชูููุฐ ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ

ุนูู ุฃู ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช (GPU) ูู ุงููุฆุฉ ุงูุงุณุชููุงููุฉุ ุจูุง ูู ุฐูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช T4 16 ุฌูุฌุงุจุงูุช ุงูููุฏูุฉ ูู ุงูุทุจูุฉ ุงููุฌุงููุฉ ูู Google Colab. ูุชุถูู ูุฐุง ุงููุณู ุงูุนุฏูุฏ ูู ุงููุตุงุฆุญ ุงูุชู ููููู ุชุฌุฑุจุชูุง ุฅุฐุง ูุงู ูุฏูู ูุญุฏุฉ GPU ุฃุตุบุฑ ูุชูุงุฌู ูุดููุงุช ูู ุงูุฐุงูุฑุฉ ุนูู ุทูู ุงูุทุฑูู.

## ูุฌููุนุฉ ุงูุจูุงูุงุช

ูุชุฏุฑูุจ ูููุฐุฌูุงุ ุณูุณุชุฎุฏู ูุฌููุนุฉ ุจูุงูุงุช [GTZAN](https://huggingface.co/datasets/marsyas/gtzan)ุ ููู ูุฌููุนุฉ ุจูุงูุงุช ุดุงุฆุนุฉ

ุชุชููู ูู 1000 ุฃุบููุฉ ูุชุตููู ุงูุฃููุงุน ุงูููุณูููุฉ. ูู ุฃุบููุฉ ุนุจุงุฑุฉ ุนู ููุทุน ุตูุชู ูุฏุชู 30 ุซุงููุฉ ูู ุฃุญุฏ ุนุดุฑ ููุนูุง ูู ุงูููุณููู

ุจุฏุกูุง ูู ุงูุฏูุณูู ูุญุชู ููุณููู ุงูููุชุงู. ูููููุง ุงูุญุตูู ุนูู ุงููููุงุช ุงูุตูุชูุฉ ูุชุตูููุงุชูุง ุงูููุงุจูุฉ ูู Hugging Face Hub ุจุงุณุชุฎุฏุงู

ูุธููุฉ `load_dataset()` ูู ููุชุจุฉ ๐ค Datasets:

```python
from datasets import load_dataset

gtzan = load_dataset("marsyas/gtzan", "all")
gtzan
```

**ุงูุฅุฎุฑุงุฌ:**

```out
Dataset({
features: ['file', 'audio', 'genre'],
num_rows: 999
})
```

<Tip warning={true}>

ุฃุญุฏ ุงูุชุณุฌููุงุช ูู GTZAN ุชุงููุ ูุฐูู ุชูุช ุฅุฒุงูุชู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ูุฏููุง 999 ูุซุงููุง

ุจุฏูุง ูู 1000.

</Tip>

ูุง ุชููุฑ GTZAN ูุฌููุนุฉ ุชุญูู ูุณุจููุง ูู ุงูุตุญุฉุ ูุฐูู ุณูุชุนูู ุนูููุง ุฅูุดุงุก ูุงุญุฏุฉ ุจุฃููุณูุง. ูุฌููุนุฉ ุงูุจูุงูุงุช ูุชูุงุฒูุฉ ุนุจุฑ

ุงูุฃููุงุนุ ูุฐุง ูููููุง ุงุณุชุฎุฏุงู ุทุฑููุฉ `train_test_split()` ูุฅูุดุงุก ุชูุณูู ุณุฑูุน ุจูุณุจุฉ 90/10 ุนูู ุงููุญู ุงูุชุงูู:

```python
gtzan = gtzan["train"].train_test_split(seed=42, shuffle=True, test_size=0.1)
gtzan
```

**ุงูุฅุฎุฑุงุฌ:**

```out
DatasetDict({
train: Dataset({
features: ['file', 'audio', 'genre'],
num_rows: 899
})
test: Dataset({
features: ['file', 'audio', 'genre'],
num_rows: 100
})
})
```

ุฑุงุฆุนุ ุงูุขู ุจุนุฏ ุฃู ุญุตููุง ุนูู ูุฌููุนุงุช ุงูุชุฏุฑูุจ ูุงูุชุญูู ูู ุงูุตุญุฉุ ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุฃุญุฏ ุงููููุงุช ุงูุตูุชูุฉ:

```python
gtzan["train"][0]
```

**ุงูุฅุฎุฑุงุฌ:**

```out
{
"file": "~/.cache/huggingface/datasets/downloads/extracted/fa06ce46130d3467683100aca945d6deafb642315765a784456e1d81c94715a8/genres/pop/pop.00098.wav",
"audio": {
"path": "~/.cache/huggingface/datasets/downloads/extracted/fa06ce46130d3467683100aca945d6deafb642315765a784456e1d81c94715a8/genres/pop/pop.00098.wav",
"array": array(
[
0.10720825,
0.16122437,
0.28585815,
...,
-0.22924805,
-0.20629883,
-0.11334229,
],
dtype=float32
),
"sampling_rate": 22050,
},
"genre": 7,
}
```

ููุง ุฑุฃููุง ูู [ุงููุญุฏุฉ 1](../chapter1/audio_data)ุ ูุชู ุชูุซูู ุงููููุงุช ุงูุตูุชูุฉ ููุตูููุงุช ุฃุญุงุฏูุฉ ุงูุฃุจุนุงุฏ NumPyุ

ุญูุซ ููุซู ูููุฉ ุงููุตูููุฉ ุงููุทุงุจูุฉ ุงููุทุงุจูุฉ. ุจุงููุณุจุฉ ููุฐู ุงูุฃุบุงููุ ูุจูุบ ูุนุฏู ุงูุนููุฉ 22050 ูุฑุชุฒุ

ููุง ูุนูู ุฃูู ูุชู ุฃุฎุฐ 22050 ูููุฉ ูุทุงุจูุฉ ููู ุซุงููุฉ. ุณูุชุนูู ุนูููุง ูุฑุงุนุงุฉ ุฐูู ุนูุฏ ุงุณุชุฎุฏุงู ูููุฐุฌ ูุณุจู ุงูุชุฏุฑูุจ

ุจูุนุฏู ุนููุฉ ูุฎุชููุ ูุชุญููู ูุนุฏูุงุช ุงูุนููุงุช ุจุฃููุณูุง ูุถูุงู ุชุทุงุจููุง. ูููููุง ุฃูุถูุง ุฑุคูุฉ ุงูููุน

ูุชู ุชูุซููู ูุฑูู ุตุญูุญุ ุฃู _ุชุตููู ุงููุตู_ุ ููู ุงูุชูุณูู ุงูุฐู ุณูููู ุงููููุฐุฌ ุจุฅุฌุฑุงุก ุชูุจุคุงุชู ุจู. ุฏุนูุง ูุณุชุฎุฏู

ุทุฑููุฉ `int2str()` ูููุฒุฉ "ุงูููุน" ูุชุนููู ูุฐู ุงูุฃุฑูุงู ุงูุตุญูุญุฉ ุฅูู ุฃุณูุงุก ูููู ูุฑุงุกุชูุง ุจุดุฑูุฉ:

```python
id2label_fn = gtzan["train"].features["genre"].int2str
id2label_fn(gtzan["train"][0]["genre"])
```

**ุงูุฅุฎุฑุงุฌ:**

```out
'pop'
```

ูุจุฏู ูุฐุง ุงูุชุตููู ุตุญูุญูุงุ ุญูุซ ูุชุทุงุจู ูุน ุงุณู ููู ุงูููู ุงูุตูุชู. ุฏุนูุง ุงูุขู ูุณุชูุน ุฅูู ุจุนุถ ุงูุฃูุซูุฉ ุงูุฃุฎุฑู ุนู ุทุฑูู

ุงุณุชุฎุฏุงู Gradio ูุฅูุดุงุก ูุงุฌูุฉ ุจุณูุทุฉ ูุน ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช "Blocks":

```python
import gradio as gr


def generate_audio():
example = gtzan["train"].shuffle()[0]
audio = example["audio"]
return (
audio["sampling_rate"],
audio["array"],
), id2label_fn(example["genre"])


with gr.Blocks() as demo:
with gr.Column():
for _ in range(4):
audio, label = generate_audio()
output = gr.Audio(audio, label=label)

demo.launch(debug=True)
```

<iframe src="https://course-demos-gtzan-samples.hf.space" frameBorder="0" height="450" title="Gradio app" class="container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>

ูู ูุฐู ุงูุนููุงุช ูููููุง ุจุงูุชุฃููุฏ ุณูุงุน ุงููุฑู ุจูู ุงูุฃููุงุนุ ูููู ูู ูููู ูููุญูู ุฃูุถูุง ุงูููุงู ุจุฐููุ ุฏุนูุง ูููู ุจุชุฏุฑูุจ

ูููุฐุฌ ููุนุฑูุฉ ุฐูู! ุฃููุงูุ ุณูุชุนูู ุนูููุง ุงูุนุซูุฑ ุนูู ูููุฐุฌ ูุณุจู ุงูุชุฏุฑูุจ ููุงุณุจ ููุฐู ุงููููุฉ. ุฏุนููุง ูุฑู ููู ูููููุง ุงูููุงู ุจุฐูู.

## ุงุฎุชูุงุฑ ูููุฐุฌ ูุณุจู ุงูุชุฏุฑูุจ ูุชุตููู ุงูุตูุช

ููุจุฏุกุ ุฏุนูุง ูุฎุชุงุฑ ูููุฐุฌูุง ูุณุจู ุงูุชุฏุฑูุจ ููุงุณุจูุง ูุชุตููู ุงูุตูุช. ูู ูุฐุง ุงููุฌุงูุ ูุชู ุนุงุฏุฉู ุฅุฌุฑุงุก ุงูุชุฏุฑูุจ ุงููุณุจู

ุนูู ูููุงุช ูุจูุฑุฉ ูู ุจูุงูุงุช ุงูุตูุช ุบูุฑ ุงูููุณููุฉุ ุจุงุณุชุฎุฏุงู ูุฌููุนุงุช ุงูุจูุงูุงุช ูุซู [LibriSpeech](https://huggingface.co/datasets/librispeech_asr)

ู [Voxpopuli](https://huggingface.co/datasets/facebook/voxpopuli). ุฃูุถู ุทุฑููุฉ ููุนุซูุฑ ุนูู ูุฐู ุงูููุงุฐุฌ ุนูู Hugging Face Hub ูู ุงุณุชุฎุฏุงู ุนุงูู ุชุตููุฉ "ุชุตููู ุงูุตูุช"ุ ููุง ูู ููุถุญ ูู ุงููุณู ุงูุณุงุจู. ุนูู ุงูุฑุบู ูู ุฃู ุงูููุงุฐุฌ ูุซู Wav2Vec2 ูHuBERT ุดุงุฆุนุฉ ุฌุฏูุงุ ุฅูุง ุฃููุง ุณูุณุชุฎุฏู ูููุฐุฌูุง ูุณูู _DistilHuBERT_. ูุฐุง ุฅุตุฏุงุฑ ุฃุตุบุฑ ุจูุซูุฑ (ุฃู _ููุทูุฑ_) ูู ูููุฐุฌ [HuBERT](https://huggingface.co/docs/transformers/model_doc/hubert)ุ ูุงูุฐู ูุชุฏุฑุจ ุนูู ูุง ูุตู ุฅูู 73% ุจุดูู ุฃุณุฑุนุ ููููู ูุญุชูุธ ุจูุนุธู ุงูุฃุฏุงุก.

<iframe src="https://autoevaluate-leaderboards.hf.space" frameBorder="0" height="450" title="Gradio app" class="container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>

## ูู ุงูุตูุช ุฅูู ููุฒุงุช ุงูุชุนูู ุงูุขูู
## ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ

ุนูู ุบุฑุงุฑ ุนูููุฉ ุชูููุฒ ุงูููุงูุงุช ูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉุ ุชุชุทูุจ ููุงุฐุฌ ุงูุตูุช ูุงูููุงู ุฃู ูููู ุงููุฏุฎู ูุดูุฑูุง ุจุชูุณูู ูููู ูููููุฐุฌ ูุนุงูุฌุชู. ููู ููุชุจุฉ ๐ค Transformersุ ุชุชู ูุนุงูุฌุฉ ุงูุชุญููู ูู ุงูุตูุช ุฅูู ุชูุณูู ุงูุฅุฏุฎุงู ุจูุงุณุทุฉ _ูุณุชุฎูุต ุงูุฎุตุงุฆุต_ ูููููุฐุฌ. ูุนูู ุบุฑุงุฑ ูููุฒุงุช ุงูููุงูุงุชุ ุชููุฑ ููุชุจุฉ ๐ค Transformers ูุฆุฉ `AutoFeatureExtractor` ููุงุฆูุฉ ูููููุง ุงุฎุชูุงุฑ ูุณุชุฎูุต ุงูุฎุตุงุฆุต ุงูุตุญูุญ ุชููุงุฆููุง ููููุฐุฌ ูุนูู. ููุฑุคูุฉ ููู ูููููุง ูุนุงูุฌุฉ ูููุงุช ุงูุตูุช ุงูุฎุงุตุฉ ุจูุงุ ุฏุนููุง ูุจุฏุฃ ุจุชููุฆุฉ ูุณุชุฎูุต ุงูุฎุตุงุฆุต ูู DistilHuBERT ูู ููุทุฉ ุงูุชูุชูุด ุงููุฏุฑุจุฉ ูุณุจููุง:

```python
from transformers import AutoFeatureExtractor

model_id = "ntu-spml/distilhubert"
feature_extractor = AutoFeatureExtractor.from_pretrained(
model_id, do_normalize=True, return_attention_mask=True
)
```

ูุธุฑูุง ูุฃู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูููููุฐุฌ ููุฌููุนุฉ ุงูุจูุงูุงุช ูุฎุชููุงูุ ูุณูู ูุถุทุฑ ุฅูู ุฅุนุงุฏุฉ ุฃุฎุฐ ุนููุงุช ููู ุงูุตูุช ุฅูู 16000 ูุฑุชุฒ ูุจู ุชูุฑูุฑู ุฅูู ูุณุชุฎูุต ุงูููุฒุงุช. ูููููุง ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุงูุญุตูู ุฃููุงู ุนูู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูููููุฐุฌ ูู ูุณุชุฎูุต ุงูููุฒุงุช:

```python
sampling_rate = feature_extractor.sampling_rate
sampling_rate
```

**ุงูุฅุฎุฑุงุฌ:**

```out
16000
```

ุจุนุฏ ุฐููุ ูููู ุจุฅุนุงุฏุฉ ุฃุฎุฐ ุนููุงุช ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `cast_column()` ูููุฒุฉ `Audio` ูู ููุชุจุฉ ๐ค Datasets:

```python
from datasets import Audio

gtzan = gtzan.cast_column("audio", Audio(sampling_rate=sampling_rate))
```

ุงูุขู ูููููุง ุงูุชุญูู ูู ุงูุนููุฉ ุงูุฃููู ููุดู ุงูุชุฏุฑูุจู ูู ูุฌููุนุชูุง ููุชุฃูุฏ ูู ุฃููุง ุชุนูู ุจุงููุนู ุนูุฏ 16000 ูุฑุชุฒ. ุณุชุนูุฏ ููุชุจุฉ ๐ค Datasets ุฃุฎุฐ ุนููุงุช ููู ุงูุตูุช _ุนูู ุงูููุฑ_ ุนูุฏ ุชุญููู ูู ุนููุฉ ุตูุชูุฉ:

```python
gtzan["train"][0]
```

**ุงูุฅุฎุฑุงุฌ:**

```out
{
"file": "~/.cache/huggingface/datasets/downloads/extracted/fa06ce46130d3467683100aca945d6deafb642315765a784456e1d81c94715a8/genres/pop/pop.00098.wav",
"audio": {
"path": "~/.cache/huggingface/datasets/downloads/extracted/fa06ce46130d3467683100aca945d6deafb642315765a784456e1d81c94715a8/genres/pop/pop.00098.wav",
"array": array(
[
0.0873509,
0.20183384,
0.4790867,
...,
-0.18743178,
-0.23294401,
-0.13517427,
],
dtype=float32,
),
"sampling_rate": 16000,
},
"genre": 7,
}
```

ุฑุงุฆุน! ูููููุง ุฃู ูุฑู ุฃู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูุฏ ุชู ุชููููู ุฅูู 16 ูููู ูุฑุชุฒ. ููุง ุฃู ููู ุงููุตูููุฉ ูุฎุชููุฉ ุฃูุถูุงุ ุญูุซ ุฃู ูุฏููุง ุงูุขู ูููุฉ ูุงุญุฏุฉ ุชูุฑูุจูุง ููู 1.5 ูู ุงูููู ุงูุชู ูุงูุช ูุฏููุง ูู ูุจู.

ูู ุงูุณูุงุช ุงููููุฒุฉ ููููุฐุฌ Wav2Vec2 ูHuBERT ูุซู ุงูููุงุฐุฌ ุฃููุง ุชูุจู ูุตูููุฉ ุฃุฑูุงู ุนุดุฑูุฉ ูุทุงุจูุฉ ููุดูู ุงูููุฌู ุงูุฎุงู ูุฅุดุงุฑุฉ ุงูููุงู ูุฅุฏุฎุงู. ููุฐุง ุนูู ุนูุณ ุงูููุงุฐุฌ ุงูุฃุฎุฑูุ ูุซู Whisperุ ุญูุซ ูููู ุจูุนุงูุฌุฉ ุงูุดูู ุงูููุฌู ุงูุตูุชู ุงูุฎุงู ุฅูู ุชูุณูู ูุฎุทุท ุทููู.

ููุฏ ุฐูุฑูุง ุฃู ุจูุงูุงุช ุงูุตูุช ููุซูุฉ ููุตูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏุ ูุฐุง ููู ุจุงููุนู ูู ุงูุชูุณูู ุงูุตุญูุญ ููุฑุงุกุชูุง ุจูุงุณุทุฉ ุงููููุฐุฌ (ูุฌููุนุฉ ูู ุงูุฅุฏุฎุงูุงุช ุงููุณุชูุฑุฉ ูู ุฎุทูุงุช ุฒูููุฉ ูููุตูุฉ). ุฅุฐูุ ูุง ุงูุฐู ููุนูู ูุณุชุฎูุต ุงูููุฒุงุช ุจุงูุถุจุทุ

ุญุณููุงุ ุจูุงูุงุช ุงูุตูุช ูู ุงูุชูุณูู ุงูุตุญูุญุ ูููููุง ูู ููุฑุถ ุฃู ูููุฏ ุนูู ุงูููู ุงูุชู ูููู ุฃู ุชุฃุฎุฐูุง. ููุถูุงู ุนูู ูููุฐุฌูุง ุจุดูู ูุซุงููุ ูุฑูุฏ ุงูุญูุงุธ ุนูู ุฌููุน ุงูุฅุฏุฎุงูุงุช ุถูู ููุณ ุงููุทุงู ุงูุฏููุงูููู. ููุฐุง ุณูุถูู ุญุตูููุง ุนูู ูุทุงู ููุงุซู ูู ุงูุชูุดูุทุงุช ูุงูุชุฏุฑุฌุงุช ูุนููุงุชูุงุ ููุง ูุณุงุนุฏ ุนูู ุงูุงุณุชูุฑุงุฑ ูุงูุชูุงุฑุจ ุฃุซูุงุก ุงูุชุฏุฑูุจ.

ููููุงู ุจุฐููุ ูููู ุจู _ุชุทุจูุน_ ุจูุงูุงุช ุงูุตูุช ุงูุฎุงุตุฉ ุจูุงุ ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชุญุฌูู ูู ุนููุฉ ุฅูู ูุชูุณุท ุตูุฑู ูุงูุญุฑุงู ูุนูุงุฑู ูุณุงูู ูุงุญุฏุ ููู ุนูููุฉ ุชุณูู _ุชุฏุฑุฌ ุงูููุฒุฉ_. ููุฐุง ุจุงูุถุจุท ูุง ูููู ุจู ูุณุชุฎูุต ุงูููุฒุงุช ูุฏููุง ูู ุชุทุจูุน ุงูููุฒุฉ!

ูููููุง ุฅููุงุก ูุธุฑุฉ ุนูู ูุณุชุฎูุต ุงูููุฒุงุช ุฃุซูุงุก ุงูุชุดุบูู ุนู ุทุฑูู ุชุทุจููู ุนูู ุนููุฉ ุงูุตูุช ุงูุฃููู ูุฏููุง. ุฃููุงูุ ุฏุนููุง ูุญุณุจ ุงููุชูุณุท ูุงูุงูุญุฑุงู ุงููุนูุงุฑู ูุจูุงูุงุช ุงูุตูุช ุงูุฎุงู ูุฏููุง:

```python
import numpy as np

sample = gtzan["train"][0]["audio"]

print(f"Mean: {np.mean(sample['array']):.3}, Variance: {np.var(sample['array']):.3}")
```

**ุงูุฅุฎุฑุงุฌ:**

```out
Mean: 0.000185, Variance: 0.0493
```

ูููููุง ุฃู ูุฑู ุฃู ุงููุชูุณุท ูุฑูุจ ูู ุงูุตูุฑ ุจุงููุนูุ ูููู ุงูุงูุญุฑุงู ุงููุนูุงุฑู ุฃูุฑุจ ุฅูู 0.05. ุฅุฐุง ูุงู ุงูุงูุญุฑุงู ุงููุนูุงุฑู ููุนููุฉ ุฃูุจุฑุ ููุฏ ูุชุณุจุจ ุฐูู ูู ูุดุงูู ููููุฐุฌูุงุ ุญูุซ ุณูููู ุงููุทุงู ุงูุฏููุงูููู ูุจูุงูุงุช ุงูุตูุช ุตุบูุฑูุง ุฌุฏูุง ูุจุงูุชุงูู ูุตุนุจ ูุตูู. ุฏุนููุง ูุทุจู ูุณุชุฎูุต ุงูููุฒุงุช ููุฑู ููู ุชุจุฏู ุงูุฅุฎุฑุงุฌ:

```python
inputs = feature_extractor(sample["array"], sampling_rate=sample["sampling_rate"])

print(f"inputs keys: {list(inputs.keys())}")

print(
f"Mean: {np.mean(inputs['input_values']):.3}, Variance: {np.var(inputs['input_values']):.3}"
)
```

**ุงูุฅุฎุฑุงุฌ:**

```out
inputs keys: ['input_values', 'attention_mask']
Mean: -4.53e-09, Variance: 1.0
```

ุญุณููุง! ูุนูุฏ ูุณุชุฎูุต ุงูููุฒุงุช ูุฏููุง ูุงููุณูุง ูุญุชูู ุนูู ูุตูููุชูู: `input_values` ู`attention_mask`. ุชูุซู `input_values` ุฅุฏุฎุงูุงุช ุงูุตูุช ุงููุนุงูุฌุฉ ูุณุจููุง ุงูุชู ุณููุฑุฑูุง ุฅูู ูููุฐุฌ HuBERT. ูุณุชุฎุฏู [`attention_mask`](https://huggingface.co/docs/transformers/glossary#attention-mask) ุนูุฏ ูุนุงูุฌุฉ _ุฏูุนุฉ_ ูู ุฅุฏุฎุงูุงุช ุงูุตูุช ูู ููุช ูุงุญุฏ - ููุณุชุฎุฏู ูุฅุฎุจุงุฑ ุงููููุฐุฌ ุจุงูููุงู ุงูุฐู ูููุง ููู ุจููุก ุฅุฏุฎุงูุงุช ุฐุงุช ุฃุทูุงู ูุฎุชููุฉ.

ูููููุง ุฃู ูุฑู ุฃู ุงููููุฉ ุงููุชูุณุทุฉ ุฃุตุจุญุช ุงูุขู ุฃูุฑุจ ุฅูู ุงูุตูุฑุ ูุงูุงูุญุฑุงู ุงููุนูุงุฑู ูุณุงูู ูุงุญุฏูุง! ูุฐุง ูู ุงูุดูู ุงูุฐู ูุฑูุฏู ูุนููุงุช ุงูุตูุช ุงูุฎุงุตุฉ ุจูุง ูุจู ุฅุทุนุงููุง ููููุฐุฌ HuBERT.

<Tip warning={true}>
ูุงุญุธ ููู ูููุง ุจุชูุฑูุฑ ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูุจูุงูุงุช ุงูุตูุช ุฅูู ูุณุชุฎูุต ุงูููุฒุงุช ูุฏููุง. ูุฐู ููุงุฑุณุฉ ุฌูุฏุฉุ ุญูุซ ูููู ูุณุชุฎูุต ุงูููุฒุงุช ุจุฅุฌุฑุงุก ูุญุต ูู ุงูุฎูููุฉ ููุชุฃูุฏ ูู ุฃู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูุจูุงูุงุช ุงูุตูุช ุงูุฎุงุตุฉ ุจูุง ูุชุทุงุจู ูุน ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ุงูุฐู ูุชููุนู ุงููููุฐุฌ. ุฅุฐุง ูู ูุชุทุงุจู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ูุจูุงูุงุช ุงูุตูุช ุงูุฎุงุตุฉ ุจูุง ูุน ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ููููุฐุฌูุงุ ูุณูู ูุญุชุงุฌ ุฅูู ุฒูุงุฏุฉ ุฃู ุชูููู ุนููุงุช ุจูุงูุงุช ุงูุตูุช ุฅูู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช ุงูุตุญูุญ.
</Tip>

ุฑุงุฆุนุ ุงูุขู ุจุนุฏ ุฃู ุนุฑููุง ููููุฉ ูุนุงูุฌุฉ ูููุงุช ุงูุตูุช ุงููุนุงุฏ ุฃุฎุฐ ุนููุงุช ูููุงุ ูุฅู ุขุฎุฑ ุดูุก ูุชุนูู ุนูููุง ูุนูู ูู ุชุญุฏูุฏ ุฏุงูุฉ ูููููุง ุชุทุจูููุง ุนูู ุฌููุน ุงูุฃูุซูุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ูุธุฑูุง ูุฃููุง ูุชููุน ุฃู ุชููู ููุงุทุน ุงูุตูุช 30 ุซุงููุฉ ูู ุงูุทููุ ูุณูููู ุฃูุถูุง ุจุชูุตูุฑ ุฃู ููุงุทุน ุฃุทูู ุจุงุณุชุฎุฏุงู ุญุฌุฌู `max_length` ู`truncation` ููุณุชุฎูุต ุงูููุฒุงุช ููุง ููู:

```python
max_duration = 30.0


def preprocess_function(examples):
audio_arrays = [x["array"] for x in examples["audio"]]
inputs = feature_extractor(
audio_arrays,
sampling_rate=feature_extractor.sampling_rate,
max_length=int(feature_extractor.sampling_rate * max_duration),
truncation=True,
return_attention_mask=True,
)
return inputs
```

ูุน ุชุญุฏูุฏ ูุฐู ุงูุฏุงูุฉุ ูููููุง ุงูุขู ุชุทุจูููุง ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุทุฑููุฉ [`map()`](https://huggingface.co/docs/datasets/v2.14.0/en/package_reference/main_classes#datasets.Dataset.map). ุชุฏุนู ุทุฑููุฉ `.map()` ุงูุนูู ูุน ุฏูุนุงุช ูู ุงูุฃูุซูุฉุ ูุงูุชู ุณูููููุง ุนู ุทุฑูู ุชุนููู `batched=True`. ุญุฌู ุงูุฏูุนุฉ ุงูุงูุชุฑุงุถู ูู 1000ุ ูููููุง ุณููููู ุฅูู 100 ูุถูุงู ุจูุงุก ุฐุฑูุฉ ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุถูู ูุทุงู ูุนููู ูุทุจูุฉ Google Colab ุงููุฌุงููุฉ:

<!--- TODO(SG): revert to multiprocessing when bug in datasets is fixed
Since audio datasets can be quite
slow to process, it is usually a good idea to use multiprocessing. We can do this by passing the `num_proc` argument to
`map()` and we'll use Python's `psutil` module to determine the number of CPU cores on the system:
--->

```python
gtzan_encoded = gtzan.map(
preprocess_function,
remove_columns=["audio", "file"],
batched=True,
batch_size=100,
num_proc=1,
)
gtzan_encoded
```

**ุงูุฅุฎุฑุงุฌ:**

```out
DatasetDict({
train: Dataset({
features: ['genre', 'input_values','attention_mask'],
num_rows: 899
})
test: Dataset({
features: ['genre', 'input_values','attention_mask'],
num_rows: 100
})
})
```

<Tip warning={true}>
ุฅุฐุง ุงุณุชููุฏุช ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ูุฌูุงุฒู ุฃุซูุงุก ุชูููุฐ ุงูุฑูุฒ ุฃุนูุงูุ ูููููู ุถุจุท ูุนููุงุช ุงูุฏูุนุฉ ูุชูููู ุงุณุชุฎุฏุงู ุฐุฑูุฉ ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู. ุนูู ูุฌู ุงูุฎุตูุตุ ููุงู ุญุฌุฌุงู ูููู ุชุนุฏููููุง ุนูู ุงููุญู ุงูุชุงูู:
* `batch_size`: ุงูุงูุชุฑุงุถู ูู 1000ุ ูููู ุชู ุชุนูููู ุฅูู 100 ุฃุนูุงู. ุญุงูู ุชููููู ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููุตู ููุตุจุญ 50
* `writer_batch_size`: ุงูุงูุชุฑุงุถู ูู 1000. ุญุงูู ุชููููู ุฅูู 500ุ ูุฅุฐุง ูู ููุฌุญ ุฐููุ ููู ุจุชุฎููุถู ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููุตู ููุตุจุญ 250
</Tip>

ูุชุจุณูุท ุงูุชุฏุฑูุจุ ูููุง ุจุฅุฒุงูุฉ ุฃุนูุฏุฉ `audio` ู`file` ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ูุญุชูู ุนููุฏ `input_values` ุนูู ูููุงุช ุงูุตูุช ุงููุดูุฑุฉุ ู`attention_mask` ููุงุน ุซูุงุฆู ูููู 0/1 ุงูุชู ุชุดูุฑ ุฅูู ุงูููุงู ุงูุฐู ูููุง ููู ุจููุก ุฅุฏุฎุงู ุงูุตูุชุ ูุนููุฏ `genre` ูุญุชูู ุนูู ุงูุชุตูููุงุช (ุฃู ุงูุฃูุฏุงู) ุงูููุงุจูุฉ. ูุชูููู `Trainer` ูู ูุนุงูุฌุฉ ุชุณููุงุช ุงููุฆุงุชุ ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชุณููุฉ ุนููุฏ `genre` ุฅูู `label`:

```python
gtzan_encoded = gtzan_encoded.rename_column("genre", "label")
```

ุฃุฎูุฑูุงุ ูุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุชุนูููุงุช ุงูุชุณููุงุช ูู ูุฌููุนุฉ ุงูุจูุงูุงุช. ุณูุฃุฎุฐูุง ูุฐุง ุงูุชุนููู ูู ูุนุฑูุงุช ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ (ูุซู `7`) ุฅูู ุชุณููุงุช ุงููุฆุงุช ุงูุชู ูููู ูุฑุงุกุชูุง ุจูุงุณุทุฉ ุงูุฅูุณุงู (ูุซู `"pop"`) ูุงูุนูุณ. ูุจูุฐู ุงูุทุฑููุฉุ ูููููุง ุชุญููู ุชูุจุคุงุช ูุนุฑูุงุช ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ูููููุฐุฌ ุฅูู ุชูุณูู ูููู ูุฑุงุกุชู ุจูุงุณุทุฉ ุงูุฅูุณุงูุ ููุง ููููููุง ูู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ูู ุฃู ุชุทุจูู ูุฃุณูู. ูููููุง ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `int2str()` ููุง ููู:

```python
id2label = {
str(i): id2label_fn(i)
for i in range(len(gtzan_encoded["train"].features["label"].names))
}
label2id = {v: k for k, v in id2label.items()}

id2label["7"]
```

```out
'pop'
```

ุญุณููุงุ ูุฏููุง ุงูุขู ูุฌููุนุฉ ุจูุงูุงุช ุฌุงูุฒุฉ ููุชุฏุฑูุจ! ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุชุฏุฑูุจ ูููุฐุฌ ุนูู ูุฐู ุงููุฌููุนุฉ.
## ุถุจุท ุฏููู ูููููุฐุฌ

ูุถุจุท ุงููููุฐุฌ ุฏููููุงุ ุณูุณุชุฎุฏู ูุฆุฉ `Trainer` ูู ๐ค Transformers. ููุง ุฑุฃููุง ูู ุงููุตูู ุงูุฃุฎุฑูุ ูุฅู `Trainer` ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุนุงููุฉ ุงููุณุชูู ูุตููุฉ ููุชุนุงูู ูุน ุฃูุซุฑ ุณููุงุฑูููุงุช ุงูุชุฏุฑูุจ ุดููุนูุง. ูู ูุฐู ุงูุญุงูุฉุ ุณูุณุชุฎุฏู `Trainer` ูุถุจุท ุงููููุฐุฌ ุฏููููุง ุนูู GTZAN. ููููุงู ุจุฐููุ ุณูุญุชุงุฌ ุฃููุงู ุฅูู ุชุญููู ูููุฐุฌ ููุฐู ุงููููุฉ. ูููููุง ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ูุฆุฉ `AutoModelForAudioClassification`ุ ูุงูุชู ุณุชุถูู ุชููุงุฆููุง ุฑุฃุณ ุงูุชุตููู ุงูููุงุณุจ ุฅูู ูููุฐุฌ DistilHuBERT ุงููุนุงุฏ ุชุฏุฑูุจู ุงูุฎุงุต ุจูุง. ุฏุนููุง ูููู ุจุชูููุฐ ุงููููุฐุฌ:

```python
from transformers import AutoModelForAudioClassification

num_labels = len(id2label)

model = AutoModelForAudioClassification.from_pretrained(
model_id,
num_labels=num_labels,
label2id=label2id,
id2label=id2label,
)
```

ููุตุญู ุจุดุฏุฉ ุจุชุญููู ููุงุท ุชูุชูุด ุงููููุฐุฌ ูุจุงุดุฑุฉู ุนูู [Hugging Face Hub](https://huggingface.co/) ุฃุซูุงุก ุงูุชุฏุฑูุจ.

ูููุฑ ุงููุญูุฑ ูุง ููู:

- ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ุงููุชูุงูู: ููููู ุงูุชุฃูุฏ ูู ุนุฏู ููุฏุงู ุฃู ููุทุฉ ุชูุชูุด ูููููุฐุฌ ุฃุซูุงุก ุงูุชุฏุฑูุจ.
- ุณุฌูุงุช TensorBoard: ุชุชุจุน ุงูููุงููุณ ุงููููุฉ ุนูู ูุฏุงุฑ ุงูุชุฏุฑูุจ.
- ุจุทุงูุงุช ุงููููุฐุฌ: ูู ุจุชูุซูู ูุง ููุนูู ุงููููุฐุฌ ูุงุณุชุฎุฏุงูุงุชู ุงูููุตูุฏุฉ.
- ุงููุฌุชูุน: ุทุฑููุฉ ุณููุฉ ูููุดุงุฑูุฉ ูุงูุชุนุงูู ูุน ุงููุฌุชูุน! ๐ค

ุฅู ุฑุจุท ุงูุฏูุชุฑ ุจุงููุญูุฑ ุฃูุฑ ูุจุงุดุฑ - ููู ูุชุทูุจ ุจุจุณุงุทุฉ ุฅุฏุฎุงู ุฑูุฒ ุงููุตุงุฏูุฉ ุนูู ุงููุญูุฑ ุนูุฏ ูุทุงูุจุชู ุจุฐูู.

ุงุจุญุซ ุนู ุฑูุฒ ูุตุงุฏูุฉ ุงููุญูุฑ [ููุง](https://huggingface.co/settings/tokens):

```python
from huggingface_hub import notebook_login

notebook_login()
```

**ุงูุฅุฎุฑุงุฌ:**

```bash
ุชุณุฌูู ุงูุฏุฎูู ูุงุฌุญ
ุชู ุญูุธ ุฑูุฒู ูู /root/.huggingface/token
```

ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุชุญุฏูุฏ ุงูุญุฌุฌ ุงูุชุฏุฑูุจุ ุจูุง ูู ุฐูู ุญุฌู ุงูุฏูุนุฉุ ูุฎุทูุงุช ุชุฑุงูู ุงูุชุฏุฑุฌุ ูุนุฏุฏ ูุชุฑุงุช ุงูุชุฏุฑูุจ ููุนุฏู ุงูุชุนูู:

```python
from transformers import TrainingArguments

model_name = model_id.split("/")[-1]
batch_size = 8
gradient_accumulation_steps = 1
num_train_epochs = 10

training_args = TrainingArguments(
f"{model_name}-finetuned-gtzan",
evaluation_strategy="epoch"ุ
save_strategy="epoch"ุ
learning_rate=5e-5,
per_device_train_batch_size=batch_size,
gradient_accumulation_steps=gradient_accumulation_steps,
per_device_eval_batch_size=batch_size,
num_train_epochs=num_train_epochs,
warmup_ratio=0.1,
logging_steps=5,
load_best_model_at_end=True,
metric_for_best_model="accuracy",
fp16=True,
push_to_hub=True,
)
```

<Tip warning={true}>

ููุง ูููุง ุจุชุนููู `push_to_hub=True` ูุชูููู ุงูุชุญููู ุงูุชููุงุฆู ูููุงุท ุถุจุทูุง ุงูุฏูููุฉ ุฃุซูุงุก ุงูุชุฏุฑูุจ. ุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ุชุญููู ููุงุท ุงูุชูุชูุด ุงูุฎุงุตุฉ ุจู ุฅูู ุงููุญูุฑุ ูููููู ุชุนููู ูุฐุง ุนูู `False`.

</Tip>

ุงูุฃูุฑ ุงูุฃุฎูุฑ ุงูุฐู ูุญุชุงุฌ ุฅูู ูุนูู ูู ุชุญุฏูุฏ ุงูููุงููุณ. ูุธุฑูุง ูุฃู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุชูุงุฒูุฉุ ูุณูุณุชุฎุฏู ุงูุฏูุฉ ููููุงุณ ูุฏููุง ูุชุญูููู ุจุงุณุชุฎุฏุงู ููุชุจุฉ ๐ค Evaluate:

```python
import evaluate
import numpy as np

metric = evaluate.load("accuracy")


def compute_metrics(eval_pred):
"""Computes accuracy on a batch of predictions"""
predictions = np.argmax(eval_pred.predictions, axis=1)
return metric.compute(predictions=predictions, references=eval_pred.label_ids)
```

ุงูุขู ูุฏููุง ูู ุงููุทุน! ุฏุนููุง ูููู ุจุชูููุฐ `Trainer` ูุชุฏุฑูุจ ุงููููุฐุฌ:

```python
from transformers import Trainer

trainer = Trainer(
modelุ
training_argsุ
train_dataset=gtzan_encoded["train"]ุ
eval_dataset=gtzan_encoded["test"]ุ
tokenizer=feature_extractorุ
compute_metrics=compute_metricsุ
)

trainer.train()
```

<Tip warning={true}>

ุงุนุชูุงุฏูุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจูุ ููู ุงููููู ุฃู ุชูุงุฌู ุฎุทุฃ "ููุงุฏ ุงูุฐุงูุฑุฉ" CUDA ุนูุฏ ุจุฏุก ุงูุชุฏุฑูุจ. ูู ูุฐู ุงูุญุงูุฉุ ููููู ุชูููู ุญุฌู `batch_size` ุจุดูู ุชุฏุฑูุฌู ุจุนูุงูู 2 ูุงุณุชุฎุฏุงู [`gradient_accumulation_steps`](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.TrainingArguments.gradient_accumulation_steps) ููุชุนููุถ.

</Tip>

**ุงูุฅุฎุฑุงุฌ:**

| ุฎุณุงุฑุฉ ุงูุชุฏุฑูุจ | ุญูุจุฉ | ุฎุทูุฉ | ุฎุณุงุฑุฉ ุงูุชุญูู | ุงูุฏูุฉ |
|:-------------:|:-----:|:----:|:---------------:|:--------:|
| 1.7297        | 1.0   | 113  | 1.8011          | 0.44     |
| 1.24          | 2.0   | 226  | 1.3045          | 0.64     |
| 0.9805        | 3.0   | 339  | 0.9888          | 0.7      |
| 0.6853        | 4.0   | 452  | 0.7508          | 0.79     |
| 0.4502        | 5.0   | 565  | 0.6224          | 0.81     |
| 0.3015        | 6.0   | 678  | 0.5411          | 0.83     |
| 0.2244        | 7.0   | 791  | 0.6293          | 0.78     |
| 0.3108        | 8.0   | 904  | 0.5857          | 0.81     |
| 0.1644        | 9.0   | 1017 | 0.5355          | 0.83     |
| 0.1198        | 10.0  | 1130 | 0.5716          | 0.82     |

ุณูุณุชุบุฑู ุงูุชุฏุฑูุจ ุญูุงูู ุณุงุนุฉ ูุงุญุฏุฉ ุงุนุชูุงุฏูุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจู ุฃู ุชูู ุงููุฎุตุตุฉ ูู Google Colab. ุฃูุถู ุฏูุฉ ุชูููู ูุฏููุง ูู 83% - ููุณุช ุณูุฆุฉ ุจุงููุณุจุฉ ูู 10 ุญูุจุงุช ููุท ูุน 899 ูุซุงู ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ! ูููููุง ุจุงูุชุฃููุฏ ุชุญุณูู ูุฐู ุงููุชูุฌุฉ ูู ุฎูุงู ุงูุชุฏุฑูุจ ุนูู ุงููุฒูุฏ ูู ุงููุชุฑุงุชุ ูุงุณุชุฎุฏุงู ุชูููุงุช ุงูุชูุธูู ูุซู _dropout_ุ ุฃู ุชูุณูู ูู ูุซุงู ุตูุชู ูู 30 ุซุงููุฉ ุฅูู ุดุฑุงุฆุญ ูุฏุชูุง 15 ุซุงููุฉ ูุงุณุชุฎุฏุงู ุงุณุชุฑุงุชูุฌูุฉ ูุนุงูุฌุฉ ุจูุงูุงุช ุฃูุซุฑ ููุงุกุฉ.

ุงูุณุคุงู ุงููุจูุฑ ูู ููู ููุงุฑู ูุฐุง ุจุฃูุธูุฉ ุชุตููู ุงูููุณููู ุงูุฃุฎุฑู ๐ค

ููููุงู ุจุฐููุ ูููููุง ุนุฑุถ [ููุญุฉ ุงูููุงุฏุฉ autoevaluate](https://huggingface.co/spaces/autoevaluate/leaderboardsุdataset=marsyas%2Fgtzan&only_verified=0&task=audio-classification&config=all&split=train&metric=accuracy)ุ ููู ููุญุฉ ููุงุฏุฉ ุชุตูู ุงูููุงุฐุฌ ุญุณุจ ุงููุบุฉ ููุฌููุนุฉ ุงูุจูุงูุงุชุ ุซู ุชุตูููุง ููููุง ูุฏูุชูุง.

ูููููุง ุฅุฑุณุงู ููุทุฉ ุชูุชูุดูุง ุชููุงุฆููุง ุฅูู ููุญุฉ ุงูููุงุฏุฉ ุนูุฏูุง ูุฏูุน ูุชุงุฆุฌ ุงูุชุฏุฑูุจ ุฅูู ุงููุญูุฑ - ูู ูุง ุนูููุง ูุนูู ูู ุชุนููู ูุณูุทุงุช ุงููููุฉ ุงูุฃุณุงุณูุฉ ุงูููุงุณุจุฉ (kwargs). ููููู ุชุบููุฑ ูุฐู ุงูููู ููุทุงุจูุฉ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุงููุบุฉ ูุงุณู ุงููููุฐุฌ ุงูุฎุงุต ุจู:

```python
kwargs = {
"dataset_tags": "marsyas/gtzan"ุ
"dataset": "GTZAN"ุ
"model_name": f"{model_name}-finetuned-gtzan"ุ
"finetuned_from": model_idุ
"tasks": "audio-classification"ุ
}
```

ูููู ุงูุขู ุชุญููู ูุชุงุฆุฌ ุงูุชุฏุฑูุจ ุฅูู ุงููุญูุฑ. ููููุงู ุจุฐููุ ูู ุจุชูููุฐ ุงูุฃูุฑ `.push_to_hub`:

```python
trainer.push_to_hub(**kwargs)
```

ุณูุคุฏู ูุฐุง ุฅูู ุญูุธ ุณุฌูุงุช ุงูุชุฏุฑูุจ ูุฃูุฒุงู ุงููููุฐุฌ ูู `"your-username/distilhubert-finetuned-gtzan"`. ููุซุงููุงุ ุชุญูู ูู ุงูุชุญููู ูู [`"sanchit-gandhi/distilhubert-finetuned-gtzan"`](https://huggingface.co/sanchit-gandhi/distilhubert-finetuned-gtzan).

## ูุดุงุฑูุฉ ุงููููุฐุฌ

ุงูุขู ููููู ูุดุงุฑูุฉ ูุฐุง ุงููููุฐุฌ ูุน ุฃู ุดุฎุต ุจุงุณุชุฎุฏุงู ุงูุฑุงุจุท ุนูู ุงููุญูุฑ. ูููููู ุชุญูููู ุจุงุณุชุฎุฏุงู ุงููุนุฑู `"your-username/distilhubert-finetuned-gtzan"` ูุจุงุดุฑุฉู ูู ูุฆุฉ `pipeline()`. ุนูู ุณุจูู ุงููุซุงูุ ูุชุญููู ููุทุฉ ุชูุชูุด ุงููุนุงุฏ ุถุจุทูุง [`"sanchit-gandhi/distilhubert-finetuned-gtzan"`](https://huggingface.co/sanchit-gandhi/distilhubert-finetuned-gtzan):

```python
from transformers import pipeline

pipe = pipeline(
"audio-classification"ุ model="sanchit-gandhi/distilhubert-finetuned-gtzan"
)
```

## ุงูุฎูุงุตุฉ

ูู ูุฐุง ุงููุณูุ ูููุง ุจุชุบุทูุฉ ุฏููู ุฎุทูุฉ ุจุฎุทูุฉ ูุถุจุท ูููุฐุฌ DistilHuBERT ุฏููููุง ูุชุตููู ุงูููุณููู. ูู ุญูู ุฑูุฒูุง ุนูู ูููุฉ ุชุตููู ุงูููุณููู ููุฌููุนุฉ ุจูุงูุงุช GTZANุ ุชูุทุจู ุงูุฎุทูุงุช ุงูููุฏูุฉ ููุง ุจุดูู ุฃูุซุฑ ุนููููุฉ ุนูู ุฃู ูููุฉ ุชุตููู ุตูุชู - ูููู ุงุณุชุฎุฏุงู ููุณ ุงูุจุฑูุงูุฌ ุงููุตู ูููุงู ุชุตููู ุงูุตูุช ููุบุฉ ุงูููุทููุฉ ูุซู ุงูุชุดุงู ุงููููุงุช ุงูุฑุฆูุณูุฉ ุฃู ุชุญุฏูุฏ ุงููุบุฉ. ูู ูุง ุนููู ูุนูู ูู ุงุณุชุจุฏุงู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃุฎุฑู ุชุชูุงูู ูุน ูููุชู ุฐุงุช ุงูุงูุชูุงู! ุฅุฐุง ููุช ููุชููุง ุจุถุจุท ููุงุฐุฌ Hugging Face Hub ุงูุฃุฎุฑู ูุชุตููู ุงูุตูุชุ ููุญู ูุดุฌุนู ุนูู ุงูุชุญูู ูู ุงูุฃูุซูุฉ ุงูุฃุฎุฑู ูู ูุณุชูุฏุน ๐ค Transformers.

ูู ุงููุณู ุงูุชุงููุ ุณูุฃุฎุฐ ุงููููุฐุฌ ุงูุฐู ููุช ููุชู ุจุถุจุทู ุฏููููุง ูุจูุงุก ุนุฑุถ ุชูุถูุญู ูุชุตููู ุงูููุณููู ููููู ูุดุงุฑูุชู ุนูู Hugging Face Hub.