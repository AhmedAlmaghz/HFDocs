# ููุงููุณ ุงูุชูููู ูุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงู

ุฅุฐุง ููุช ุนูู ุฏุฑุงูุฉ ุจู "ูุณุงูุฉ ููููุดุดุชุงูู" ูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉุ ูุณุชููู ููุงููุณ ุชูููู ุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงู ูุฃูููุฉ ูุฏูู! ูุง ุชููู ุฅุฐุง ูู ุชูู ูุฐููุ ูุณูู ูุดุฑุญ ูู ุดูุก ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ ููุชุฃูุฏ ูู ูุนุฑูุชู ุจููุงููุณ ุงูุชูููู ุงููุฎุชููุฉ ูููู ูุนูุงูุง.

ุนูุฏ ุชูููู ุฃูุธูุฉ ุงูุชุนุฑู ุนูู ุงูููุงูุ ูููู ุจููุงุฑูุฉ ุชูุจุคุงุช ุงููุธุงู ูุน ุงููุตูุต ุงููุณุชูุฏูุฉุ ูุน ูุถุน ุนูุงูุงุช ุนูู ุฃู ุฃุฎุทุงุก ููุฌูุฏุฉ. ูููู ุจุชุตููู ูุฐู ุงูุฃุฎุทุงุก ุฅูู ุฅุญุฏู ุงููุฆุงุช ุงูุซูุงุซ ุงูุชุงููุฉ:

1. ุงูุงุณุชุจุฏุงูุงุช (S): ุญูุซ ูููู ุจูุชุงุจุฉ **ุงููููุฉ ุงูุฎุงุทุฆุฉ** ูู ุชูุจุคูุง ("ุงุฌูุณ" ุจุฏูุงู ูู "ุฌูุณ")
2. ุงูุฅุฏุฎุงูุงุช (I): ุญูุซ ูููู ุจุฅุถุงูุฉ **ูููุฉ ุฅุถุงููุฉ** ูู ุชูุจุคูุง
3. ุงูุญุฐู (D): ุญูุซ ูููู **ุจุญุฐู ูููุฉ** ูู ุชูุจุคูุง

ุชุธู ูุฆุงุช ุงูุฃุฎุทุงุก ูุฐู ูู ููุณูุง ูุฌููุน ููุงููุณ ุงูุชุนุฑู ุนูู ุงูููุงู. ูุง ูุฎุชูู ูู ุงููุณุชูู ุงูุฐู ูุญุณุจ ุนููู ูุฐู ุงูุฃุฎุทุงุก: ูููููุง ุญุณุงุจูุง ุนูู ูุณุชูู _ุงููููุฉ_ ุฃู ุนูู ูุณุชูู _ุงูุดุฎุตูุฉ_.

ุณูุณุชุฎุฏู ูุซุงูุงู ูุชูุฑุฑูุง ููู ุชุนุฑูู ูู ุชุนุฑููุงุช ุงูููุงุณ. ููุงุ ูุฏููุง ุชุณูุณู ูุตู _ุญูููู_ ุฃู _ูุฑุฌุนู_:

```python
reference = "the cat sat on the mat"
```

ูุชุณูุณู ูุชููุน ูู ูุธุงู ุงูุชุนุฑู ุนูู ุงูููุงู ุงูุฐู ูุญุงูู ุชููููู:

```python
prediction = "the cat sit on the"
```

ูููููุง ุฃู ูุฑู ุฃู ุงูุชูุจุค ูุฑูุจ ุฌุฏูุงุ ูููู ุจุนุถ ุงููููุงุช ููุณุช ุตุญูุญุฉ ุชูุงููุง. ุณูููู ุจุชูููู ูุฐุง ุงูุชูุจุค ููุงุจู ุงููุฑุฌุน ููููุงููุณ ุงูุซูุงุซุฉ ุงูุฃูุซุฑ ุดููุนูุง ููุชุนุฑู ุนูู ุงูููุงู ููุฑู ููุน ุงูุฃุฑูุงู ุงูุชู ูุญุตู ุนูููุง ููู ูููุง.

## ูุนุฏู ุฎุทุฃ ุงููููุฉ

ุฅู ูููุงุณ *ูุนุฏู ุฎุทุฃ ุงููููุฉ (WER)* ูู ุงููููุงุณ ุงููุนูู ููุชุนุฑู ุนูู ุงูููุงู. ููู ูุญุณุจ ุงูุงุณุชุจุฏุงูุงุช ูุงูุฅุฏุฎุงูุงุช ูุงูุญุฐู ุนูู ูุณุชูู *ุงููููุฉ*. ููุฐุง ูุนูู ุฃู ุงูุฃุฎุทุงุก ูุชู ูุถุน ุนูุงูุงุช ุนูููุง ูููุฉ ูููุฉ. ุฎุฐ ูุซุงููุง:

| ุงููุฑุฌุน: | the | cat | sat     | on  | the | mat |
|-------------|-----|-----|---------|-----|-----|-----|
| ุงูุชูุจุค: | the | cat | **sit** | on  | the |     |  |
| ุงูุชุตููู: | โ   | โ   | S       | โ   | โ   | D   | 

ููุงุ ูุฏููุง:

* 1 ุงุณุชุจุฏุงู ("ุงุฌูุณ" ุจุฏูุงู ูู "ุฌูุณ")
* 0 ุฅุฏุฎุงูุงุช
* 1 ุญุฐู ("mat" ููููุฏ)

ูุฐุง ูุนุทู ูุง ูุฌููุนู ุฎุทุฃูู. ููุญุตูู ุนูู ูุนุฏู ุงูุฎุทุฃุ ูููู ุจูุณูุฉ ุนุฏุฏ ุงูุฃุฎุทุงุก ุนูู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช ูู ูุฑุฌุนูุง (N)ุ ูุงูุฐู ูุจูุบ 6 ูู ูุฐุง ุงููุซุงู:

$$
\begin{aligned}
WER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 1}{6} \\
&= 0.333
\end{aligned}
$$

ุญุณูุง! ูุฐุง ูุฅู ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุฏููุง ูู 0.333ุ ุฃู 33.3%. ูุงุญุธ ููู ุฃู ุงููููุฉ "ุงุฌูุณ" ุจูุง ุญุฑู ูุงุญุฏ ููุท ุฎุทุฃุ ูููู ุชู ูุถุน ุนูุงูุฉ ุนูู ุงููููุฉ ุจุฃููููุง ูุฎุทุฃ. ูุฐู ูู ุงูุณูุฉ ุงููููุฒุฉ ููุนุฏู ุฎุทุฃ ุงููููุฉ: ูุชู ูุนุงูุจุฉ ุฃุฎุทุงุก ุงูุฅููุงุก ุจุดุฏุฉุ ุจุบุถ ุงููุธุฑ ุนู ูุฏู ุถุขูุชูุง.

ุชู ุชุนุฑูู ูุนุฏู ุฎุทุฃ ุงููููุฉ ุจุญูุซ ูููู *ุงูุฃุฏูู ุฃูุถู*: ุฃู ุฃู ุงูุฎูุงุถ ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุนูู ูุฌูุฏ ุฃุฎุทุงุก ุฃูู ูู ุชูุจุคูุงุ ูุฐุง ูุฅู ูุธุงู ุงูุชุนุฑู ุนูู ุงูููุงู ุงููุซุงูู ุณูููู ูู ูุนุฏู ุฎุทุฃ ูููุงุช ุตูุฑู (ุจุฏูู ุฃุฎุทุงุก).

ุฏุนููุง ูุฑู ููู ูููููุง ุญุณุงุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ ุจุงุณุชุฎุฏุงู ุชูููู ๐ค. ุณุชุญุชุงุฌ ุฅูู ุญุฒูุชูู ูุญุณุงุจ ูููุงุณ ูุนุฏู ุฎุทุฃ ุงููููุฉ: ุชูููู ๐ค ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุชุ ูJIWER ููููุงู ุจุงูุนูู ุงูุดุงู ูุญุณุงุจ:

```
pip install --upgrade evaluate jiwer
```

ุฑุงุฆุน! ูููููุง ุงูุขู ุชุญููู ูููุงุณ ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุญุณุงุจ ุงูุฑูู ููุซุงููุง:

```python
from evaluate import load

wer_metric = load("wer")

wer = wer_metric.compute(references=[reference], predictions=[prediction])

print(wer)
```

**ุฅุฎุฑุงุฌ ุงูุทุจุงุนุฉ:**
```
0.3333333333333333
```

0.33ุ ุฃู 33.3%ุ ููุง ูู ูุชููุน! ุงูุขู ูุนุฑู ูุง ูุญุฏุซ ุฎูู ุงูููุงููุณ ูุน ูุฐุง ุงูุญุณุงุจ ููุนุฏู ุฎุทุฃ ุงููููุฉ.

ุงูุขูุ ููุงู ุดูุก ูุญูุฑ ููุบุงูุฉ... ูุง ูู ุงูุญุฏ ุงูุฃูุตู ููุนุฏู ุฎุทุฃ ุงููููุฉ ูู ุฑุฃููุ ูุฏ ุชุชููุน ุฃู ูููู 1 ุฃู 100% ุตุญูุญุ ูุง! ูุธุฑูุง ูุฃู ูุนุฏู ุฎุทุฃ ุงููููุฉ ูู ูุณุจุฉ ุงูุฃุฎุทุงุก ุฅูู ุนุฏุฏ ุงููููุงุช (N)ุ ููุง ููุฌุฏ ุญุฏ ุฃุนูู ููุนุฏู ุฎุทุฃ ุงููููุฉ!

ููุฃุฎุฐ ูุซุงูุงู ุญูุซ ูุชููุน 10 ูููุงุช ูุงููุฏู ูุญุชูู ุนูู ูููุชูู ููุท. ุฅุฐุง ูุงูุช ุฌููุน ุชูุจุคุงุชูุง ุฎุงุทุฆุฉ (10 ุฃุฎุทุงุก)ุ ูุณูููู ูุฏููุง ูุนุฏู ุฎุทุฃ ูููุงุช ูุจูุบ 10 / 2 = 5ุ ุฃู 500%! ูุฐุง ุดูุก ูุฌุจ ูุฑุงุนุงุชู ุฅุฐุง ููุช ุจุชุฏุฑูุจ ูุธุงู ASR ูุฑุฃูุช ูุนุฏู ุฎุทุฃ ูููุงุช ูุฒูุฏ ุนู 100%. ุนูู ุงูุฑุบู ูู ุฃูู ุฅุฐุง ููุช ุชุฑู ูุฐุงุ ููู ุงููุญุชูู ุฃู ูููู ุดูุก ูุง ูุฏ ุญุฏุซ ุจุดูู ุฎุงุทุฆ... ๐

## ุฏูุฉ ุงููููุฉ

ูููููุง ุนูุณ ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุฅุนุทุงุฆูุง ูููุงุณูุง ูููู ููู *ุงูุฃุนูู ุฃูุถู*. ุจุฏูุงู ูู ููุงุณ ูุนุฏู ุฎุทุฃ ุงููููุฉุ ูููููุง ููุงุณ *ุฏูุฉ ุงููููุฉ (WAcc)* ููุธุงููุง:

$$
\begin{equation}
WAcc = 1 - WER \nonumber
\end{equation}
$$

ูุชู ููุงุณ ุฏูุฉ ุงููููุฉ ุฃูุถูุง ุนูู ูุณุชูู ุงููููุฉุ ููู ุจุจุณุงุทุฉ ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุนุงุฏ ุตูุงุบุชู ููููุงุณ ุฏูุฉ ุจุฏูุงู ูู ูููุงุณ ุงูุฎุทุฃ. ูุงุฏุฑูุง ูุง ูุชู ุงูุงุณุชุดูุงุฏ ุจุฏูุฉ ุงููููุฉ ูู ุฃุฏุจูุงุช ุงูููุงู - ููุญู ูููุฑ ูู ุชูุจุคุงุช ุงููุธุงู ูู ุญูุซ ุฃุฎุทุงุก ุงููููุงุชุ ูุจุงูุชุงูู ูุฅููุง ููุถู ููุงููุณ ูุนุฏู ุงูุฎุทุฃ ุงููุฑุชุจุทุฉ ุฃูุซุฑ ุจูุฐู ุงูุฃููุงุน ูู ุนูุงูุงุช ุงูุฎุทุฃ.

## ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑู

ูุจุฏู ูู ุงูุธูู ุฃููุง ูุถุนูุง ุนูุงูุฉ ุนูู ุงููููุฉ ุจุฃููููุง ูู "ุงุฌูุณ" ุฎุทุฃ ุจูููุง ูู ุงููุงูุน ูุงู ุญุฑู ูุงุญุฏ ููุท ุบูุฑ ุตุญูุญ.

ููุฑุฌุน ุฐูู ุฅูู ุฃููุง ูููู ูุธุงููุง ุนูู ูุณุชูู ุงููููุฉุ ูุจุงูุชุงูู ูุถุน ุนูุงูุงุช ุนูู ุงูุฃุฎุทุงุก ูููุฉ ูููุฉ. ูููู *ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑู (CER)* ุจุชูููู ุงูุฃูุธูุฉ ุนูู ูุณุชูู *ุงูุดุฎุตูุฉ*. ููุฐุง ูุนูู ุฃููุง ููุณู ูููุงุชูุง ุฅูู ุฃุญุฑู ูุฑุฏูุฉุ ููุถุน ุนูุงูุงุช ุนูู ุงูุฃุฎุทุงุก ุญุฑููุง ุจุญุฑู:

| ุงููุฑุฌุน: | t   | h   | e   |     | c   | a   | t   |     | s   | a     | t   |     | o   | n   |     | t   | h   | e   |     | m   | a   | t   |
|-------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| ุงูุชูุจุค: | t   | h   | e   |     | c   | a   | t   |     | s   | **i** | t   |     | o   | n   |     | t   | h   | e   |     |     |     |     |
| ุงูุชุตููู: | โ   | โ   | โ   |     | โ   | โ   | โ   |     | โ   | S     | โ   |     | โ   | โ   |     | โ   | โ   | โ   |     | D   | D   | D   | 

ุงูุขู ูููููุง ุฃู ูุฑู ุฃูู ุจุงููุณุจุฉ ูููููุฉ "ุงุฌูุณ"ุ ุชู ูุถุน ุนูุงูุฉ ุนูู "s" ู "t" ูุตุญูุญูู. ุฅููุง ุนูุงูุฉ "i" ููุท ุงูุชู ุชู ุชุตููููุง ุนูู ุฃููุง ุฎุทุฃ ุงุณุชุจุฏุงู (S). ูุจุงูุชุงููุ ูุฅููุง ููุงูุฆ ูุธุงููุง ุนูู ุงูุชูุจุค ุงูุฌุฒุฆู ุงูุตุญูุญ ๐ค

ูู ูุซุงููุงุ ูุฏููุง ุงุณุชุจุฏุงู ุญุฑู ูุงุญุฏุ 0 ุฅุฏุฎุงูุงุชุ ู3 ุนูููุงุช ุญุฐู. ูู ุงููุฌููุนุ ูุฏููุง 14 ุญุฑููุง. ูุฐููุ ูุฅู ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑู ูุฏููุง ูู:

$$
\begin{aligned}
CER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 3}{14} \\
&= 0.286
\end{aligned}
$$

ุตุญูุญ! ูุฏููุง ูุนุฏู ุฎุทุฃ ุฃุญุฑู ูุจูุบ 0.286ุ ุฃู 28.6%. ูุงุญุธ ููู ุฃู ูุฐุง ุฃูู ูู ูุนุฏู ุฎุทุฃ ุงููููุฉ - ููุฏ ุนุงูุจูุง ุฎุทุฃ ุงูุฅููุงุก ุจุดูู ุฃูู.

## ุฃู ูููุงุณ ูุฌุจ ุฃู ุฃุณุชุฎุฏููุ

ุจุดูู ุนุงูุ ูุชู ุงุณุชุฎุฏุงู ูุนุฏู ุฎุทุฃ ุงููููุฉ ุฃูุซุฑ ูู ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑู ูุชูููู ุฃูุธูุฉ ุงูููุงู. ููุฑุฌุน ุฐูู ุฅูู ุฃู ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุชุทูุจ ูู ุงูุฃูุธูุฉ ููููุง ุฃูุจุฑ ูุณูุงู ุงูุชูุจุคุงุช. ูู ูุซุงููุงุ ูุฅู ุงููุนู "ุงุฌูุณ" ูู ูู ุงูุฒูู ุงูุฎุทุฃ. ููู ุดุฃู ุงููุธุงู ุงูุฐู ูููู ุงูุนูุงูุฉ ุจูู ุงููุนู ูุฒูู ุงูุฌููุฉ ุฃู ูุชูุจุฃ ุจุงูุฒูู ุงูุตุญูุญ ูููุนู
"ุฌูุณ". ูุฑูุฏ ุชุดุฌูุน ูุฐุง ุงููุณุชูู ูู ุงูููู ูู ุฃูุธูุฉ ุงูููุงู ูุฏููุง. ูุฐูู ุนูู ุงูุฑุบู ูู ุฃู ูุนุฏู ุฎุทุฃ ุงููููุฉ ุฃูู ุชุณุงูุญูุง ูู ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑูุ ุฅูุง ุฃูู ุฃูุถูุง ุฃูุซุฑ ููุงุกูุฉ ูุฃููุงุน ุงูุฃูุธูุฉ ุงูุชู ูููู ููููุง ูุงูุชู ูุฑูุฏ ุชุทููุฑูุง. ูุฐููุ ูุณุชุฎุฏู ุนุงุฏุฉู ูุนุฏู ุฎุทุฃ ุงููููุฉ ููุดุฌุนู ุนูู ุฐูู ุฃูุถูุง! ููุน ุฐููุ ููุงู ุธุฑูู ูุง ูููู ูููุง ุงุณุชุฎุฏุงู ูุนุฏู ุฎุทุฃ ุงููููุฉ.

ุชูุชูุฑ ุจุนุถ ุงููุบุงุชุ ูุซู ุงููุงูุฏุฑูู ูุงููุงุจุงููุฉุ ุฅูู ููููู "ุงููููุงุช"ุ ูุฐุง ูุฅู ูุนุฏู ุฎุทุฃ ุงููููุฉ ูุง ูุนูู ูู. ููุงุ ูุนูุฏ ุฅูู ุงุณุชุฎุฏุงู ูุนุฏู ุฎุทุฃ ุงูุฃุญุฑู.

ูู ูุซุงููุงุ ุงุณุชุฎุฏููุง ุฌููุฉ ูุงุญุฏุฉ ููุท ุนูุฏ ุญุณุงุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ. ุนุงุฏุฉู ูุง ูุณุชุฎุฏู ูุฌููุนุฉ ุงุฎุชุจุงุฑ ูุงููุฉ ุชุชููู ูู ุนุฏุฉ ุขูุงู ูู ุงูุฌูู ุนูุฏ ุชูููู ูุธุงู ุญูููู. ุนูุฏ ุงูุชูููู ุนูู ุนุฏุฉ ุฌููุ ูููู ุจุชุฌููุน S ูI ูD ูN ุนุจุฑ ุฌููุน ุงูุฌููุ ุซู ูุญุณุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ ููููุง ูููุนุงุฏูุฉ ุงููุญุฏุฏุฉ ุฃุนูุงู. ูููุฑ ูุฐุง ุชูุฏูุฑูุง ุฃูุถู ููุนุฏู ุฎุทุฃ ุงููููุฉ ููุจูุงูุงุช ุบูุฑ ุงููุฑุฆูุฉ.

## ุงูุชุทุจูุน

ุฅุฐุง ูููุง ุจุชุฏุฑูุจ ูููุฐุฌ ASR ุนูู ุจูุงูุงุช ุชุญุชูู ุนูู ุนูุงูุงุช ุชุฑููู ูุฃุญุฑู ูุจูุฑุฉุ ูุณูู ูุชุนูู ุงูุชูุจุค ุจุนูุงูุงุช ุงูุชุฑููู ูุงูุฃุญุฑู ุงููุจูุฑุฉ ูู ูุตูุตู. ูุฐุง ุฃูุฑ ุฑุงุฆุน ุนูุฏูุง ูุฑูุฏ ุงุณุชุฎุฏุงู ูููุฐุฌูุง ูุชุทุจููุงุช ุงูุชุนุฑู ุนูู ุงูููุงู ุงููุนููุฉุ ูุซู ูุณุฎ ุงูุงุฌุชูุงุนุงุช ุฃู ุงูุฅููุงุกุ ุญูุซ ุชููู ุงููุตูุต ุงููุชููุนุฉ ููุชูุจุฉ ุจุดูู ูุงูู ุจุนูุงูุงุช ุงูุชุฑููู ูุงูุฃุญุฑู ุงููุจูุฑุฉุ ููู ุฃุณููุจ ููุดุงุฑ ุฅููู ุจุงุณู *ุงูุฃุฑุซูุบุฑุงูู*.

ููุน ุฐููุ ูุฏููุง ุฃูุถูุง ุฎูุงุฑ *ุชุทุจูุน* ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฅุฒุงูุฉ ุฃู ุฃุญุฑู ูุจูุฑุฉ ูุนูุงูุงุช ุชุฑููู. ูุฌุนู ุชุทุจูุน ูุฌููุนุฉ ุงูุจูุงูุงุช ูููุฉ ุงูุชุนุฑู ุนูู ุงูููุงู ุฃุณูู: ูู ูุนุฏ ุงููููุฐุฌ ุจุญุงุฌุฉ ุฅูู ุงูุชูููุฒ ุจูู ุงูุฃุญุฑู ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉุ ุฃู ุงูุชูุจุค ุจุนูุงูุงุช ุงูุชุฑููู ูู ุจูุงูุงุช ุงูุตูุช ูุญุฏูุง (ุนูู ุณุจูู ุงููุซุงูุ ูุง ูู ุงูุตูุช ุงูุฐู ุชุตุฏุฑู ุงููุงุตูุฉ ุงูููููุทุฉุ).

ูุจุณุจุจ ูุฐุงุ ุชููู ูุนุฏูุงุช ุฎุทุฃ ุงููููุงุช ุฃูู ุจุดูู ุทุจูุนู (ููุง ูุนูู ุฃู ุงููุชุงุฆุฌ ุฃูุถู). ุชูุถุญ ูุฑูุฉ Whisper ุงูุชุฃุซูุฑ ุงููุจูุฑ ุงูุฐู ูููู ุฃู ูุญุฏุซู ุชุทุจูุน ุงููุตูุต ุนูู ูุชุงุฆุฌ ูุนุฏู ุฎุทุฃ ุงููููุฉ (*ุฑุงุฌุน* ุงููุณู 4.4 ูู [ูุฑูุฉ Whisper](https://cdn.openai.com/papers/whisper.pdf)).

ุนูู ุงูุฑุบู ูู ุฃููุง ูุญุตู ุนูู ูุนุฏูุงุช ุฎุทุฃ ูููุงุช ุฃููุ ุฅูุง ุฃู ุงููููุฐุฌ ููุณ ุจุงูุถุฑูุฑุฉ ุฃูุถู ููุฅูุชุงุฌ. ูุฌุนู ุนุฏู ูุฌูุฏ ุฃุญุฑู ูุจูุฑุฉ ูุนูุงูุงุช ุชุฑููู ุงููุต ุงููุชููุน ูู ุงููููุฐุฌ ุฃูุซุฑ ุตุนูุจุฉ ูู ุงููุฑุงุกุฉ. ุฎุฐ ุงููุซุงู ูู [ุงููุณู ุงูุณุงุจู](asr_models)ุ ุญูุซ ูููุง ุจุชุดุบูู Wav2Vec2 ูWhisper ุนูู ููุณ ุนููุฉ ุงูุตูุช ูู ูุฌููุนุฉ ุจูุงูุงุช LibriSpeech. ูุง ูุชูุจุฃ ูููุฐุฌ Wav2Vec2 ุจุนูุงูุงุช ุงูุชุฑููู ุฃู ุงูุฃุญุฑู ุงููุจูุฑุฉุ ุจูููุง ูุชูุจุฃ ุจูุง Whisper. ุนูุฏ ููุงุฑูุฉ ุงููุตูุต ุฌูุจูุง ุฅูู ุฌูุจุ ูุฑู ุฃู ูุณุฎุฉ Whisper ุฃุณูู ูู ุงููุฑุงุกุฉ:

```
Wav2Vec2: HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAUS AND ROSE BEEF LOOMING BEFORE US SIMALYIS DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND
Whisper: He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind.
```

ุฅู ูุณุฎุฉ Whisper ุฃุฑุซูุบุฑุงููุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู - ููู ููุชูุจุฉ ููุง ูุชููุน ููุณุฎุฉ ุงูุงุฌุชูุงุน ุฃู ูุต ุงูุฅููุงุก ูุน ุนูุงูุงุช ุงูุชุฑููู ูุงูุฃุญุฑู ุงููุจูุฑุฉ. ุนูู ุงููููุถ ูู ุฐููุ ุณูุชุนูู ุนูููุง ุงุณุชุฎุฏุงู ูุนุงูุฌุฉ ูุงุญูุฉ ุฅุถุงููุฉ ูุงุณุชุนุงุฏุฉ ุนูุงูุงุช ุงูุชุฑููู ูุงูุฃุญุฑู ุงููุจูุฑุฉ ูู ุชูุจุคุงุชูุง ุงูุฎุงุตุฉ ุจู Wav2Vec2 ุฅุฐุง ุฃุฑุฏูุง ุงุณุชุฎุฏุงููุง ูุชุทุจููุงุช ุงููุตุจ.

ููุงู ุญู ูุณุท ุจูู ุงูุชุทุจูุน ูุนุฏู ุงูุชุทุจูุน: ูููููุง ุชุฏุฑูุจ ุฃูุธูุชูุง ุนูู ุงููุตูุต ุงูุฃุฑุซูุบุฑุงููุฉุ ุซู ุชุทุจูุน ุงูุชูุจุคุงุช ูุงูุฃูุฏุงู ูุจู ุญุณุงุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ. ุจูุฐู ุงูุทุฑููุฉุ ูููู ุจุชุฏุฑูุจ ุฃูุธูุชูุง ุนูู ุงูุชูุจุค ุจุงููุต ุงูููุณู ุจุงููุงููุ ูููููุง ูุณุชููุฏ ุฃูุถูุง ูู ุชุญุณููุงุช ูุนุฏู ุฎุทุฃ ุงููููุฉ ุงูุชู ูุญุตู ุนูููุง ูู ุฎูุงู ุชุทุจูุน ุงููุตูุต.

ุชู ุฅุตุฏุงุฑ ูููุฐุฌ Whisper ุจูุทุจุน ูุนุงูุฌ ุชุทุจูุน ุงูุฃุญุฑู ุงููุจูุฑุฉ ูุนูุงูุงุช ุงูุชุฑููู ูุชูุณูู ุงูุฃุฑูุงู ูู ุจูู ุฃููุฑ ุฃุฎุฑู. ุฏุนููุง ูุทุจู ุงููุทุจุน ุนูู ูุตูุต Whisper ูุฅุธูุงุฑ ููููุฉ ุชุทุจูุนูุง:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

prediction = " He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind."
normalized_prediction = normalizer(prediction)

normalized_prediction
```

**ุงูุฅุฎุฑุงุฌ:**
```
' he tells us that at this festive season of the year with christmas and roast beef looming before us similarly is drawn from eating and its results occur most readily to the mind '
```

ุฑุงุฆุน! ูููููุง ุฃู ูุฑู ุฃู ุงููุต ุชู ุชุญูููู ุจุงููุงูู ุฅูู ุฃุญุฑู ุตุบูุฑุฉ ูุชูุช ุฅุฒุงูุฉ ุฌููุน ุนูุงูุงุช ุงูุชุฑููู. ุฏุนููุง ุงูุขู ูุญุฏุฏ ุงููุต ุงููุฑุฌุนู ุซู ูุญุณุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ ุงููุนูุงุฑู ุจูู ุงููุฑุฌุน ูุงูุชูุจุค:

```python
reference = "HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAS AND ROAST BEEF LOOMING BEFORE US SIMILES DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND"
normalized_referece = normalizer(reference)

wer = wer_metric.compute(
references=[normalized_referece], predictions=[normalized_prediction]
)
wer
```

**ุงูุฅุฎุฑุงุฌ:**
```
0.0625
```

6.25% - ูุฐุง ูุง ูุชููุนู ุชูุฑูุจูุง ููููุฐุฌ Whisper ุงูุฃุณุงุณู ุนูู ูุฌููุนุฉ ุงูุชุญูู ูู ุตุญุฉ LibriSpeech. ููุง ูุฑู ููุงุ ููุฏ ุชูุจุฃูุง ุจูุต ุฃุฑุซูุบุฑุงููุ ูููููุง ุงุณุชูุฏูุง ูู ุชุนุฒูุฒ ูุนุฏู ุฎุทุฃ ุงููููุฉ ุงูุฐู ูุญุตู ุนููู ูู ุฎูุงู ุชุทุจูุน ุงููุฑุฌุน ูุงูุชูุจุค ูุจู ุญุณุงุจ ูุนุฏู ุฎุทุฃ ุงููููุฉ.

ูู ุงูููุงูุฉุ ูุนุชูุฏ ุงุฎุชูุงุฑ ููููุฉ ุชุทุจูุน ุงููุตูุต ุนูู ุงุญุชูุงุฌุงุชู. ููุตู ุจุงูุชุฏุฑูุจ ุนูู ุงููุต ุงูุฃุฑุซูุบุฑุงูู ูุชูููู ุงููุต ุงููุนูุงุฑู ููุญุตูู ุนูู ุฃูุถู ูุง ูู ุงูุนุงูููู.
## ุฌูุน ูู ุดูุก ูุนูุง

ุญุณูุง! ููุฏ ุบุทููุง ุญุชู ุงูุขู ุซูุงุซุฉ ููุงุถูุน ูู ูุฐู ุงููุญุฏุฉ: ุงูููุงุฐุฌ ุงูููุฏุฑุจุฉ ูุณุจููุงุ ูุงุฎุชูุงุฑ ูุฌููุนุฉ ุงูุจูุงูุงุชุ ูุงูุชูููู.

ุฏุนููุง ูุณุชูุชุน ููููุงู ููุถุนูุง ูุนูุง ูู ูุซุงู ุดุงูู ๐ ุณูู ูุฌูุฒ ุฃููุณูุง ูููุณู ุงูุชุงูู ุญูู ุงูุถุจุท ุงูุฏููู ูู ุฎูุงู ุชูููู ูููุฐุฌ Whisper ุงูููุฏุฑุจ ูุณุจููุง ุนูู ูุฌููุนุฉ ุงุฎุชุจุงุฑ Common Voice 13 Dhivehi. ุณูุณุชุฎุฏู ุฑูู WER ุงูุฐู ูุญุตู ุนููู ูู _ุฎุท ุฃุณุงุณ_ ูุชุดุบูู ุงูุถุจุท ุงูุฏููู ุงูุฎุงุต ุจูุงุ ุฃู ุฑูู ูุณุชูุฏู ุณูุญุงูู ุงูุชุบูุจ ุนููู ๐ฅ

ุฃููุงูุ ุณูููู ุจุชุญููู ูููุฐุฌ Whisper ุงูููุฏุฑุจ ูุณุจููุง ุจุงุณุชุฎุฏุงู ูุฆุฉ `pipeline()`. ุณุชููู ูุฐู ุงูุนูููุฉ ูุฃูููุฉ ููุบุงูุฉ ุงูุขู! ุงูุดูุก ุงูุฌุฏูุฏ ุงููุญูุฏ ุงูุฐู ุณูููู ุจู ูู ุชุญููู ุงููููุฐุฌ ุจูุตู ุงูุฏูุฉ (float16) ุฅุฐุง ูุงู ูุนูู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU) - ููุฐุง ุณูุณุฑุน ุงูุงุณุชุฏูุงู ุจุชูููุฉ ุถุฆููุฉ ุฃู ูุนุฏููุฉ ูุฏูุฉ WER.

```python
from transformers import pipeline
import torch

if torch.cuda.is_available():
    device = "cuda:0"
    torch_dtype = torch.float16
else:
    device = "cpu"
    torch_dtype = torch.float32

pipe = pipeline(
    "automatic-speech-recognition",
    model="openai/whisper-small",
    torch_dtype=torch_dtype,
    device=device,
)
```

ุจุนุฏ ุฐููุ ุณูููู ุจุชุญููู ูุณู ุงูุงุฎุชุจุงุฑ Dhivehi ูู Common Voice 13. ุณุชุชุฐูุฑ ูู ุงููุณู ุงูุณุงุจู ุฃู Common Voice 13 ูู *ูุญุฏุฏ*ุ ููุง ูุนูู ุฃูู ูุงู ุนูููุง ุงูููุงููุฉ ุนูู ุดุฑูุท ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุจู ุงููุตูู ุฅูููุง. ูููููุง ุงูุขู ุฑุจุท ุญุณุงุจ Hugging Face ุงูุฎุงุต ุจูุง ุจุฏูุชุฑ ุงูููุงุญุธุงุช ุงูุฎุงุต ุจูุงุ ุจุญูุซ ูููููุง ุงููุตูู ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูู ุงูุฌูุงุฒ ุงูุฐู ูุณุชุฎุฏูู ุญุงูููุง.

ุฅู ุฑุจุท ุงูุฏูุชุฑ ุจุงููุฑูุฒ ุฃูุฑ ูุจุงุดุฑ - ูู ูุง ูุชุทูุจู ุงูุฃูุฑ ูู ุฅุฏุฎุงู ุฑูุฒ ุงููุตุงุฏูุฉ ุงูุฎุงุต ุจู ุนูุฏ ุงููุทุงูุจุฉ. ููููู ุงูุนุซูุฑ ุนูู ุฑูุฒ ูุตุงุฏูุฉ Hub [ููุง](https://huggingface.co/settings/tokens) ูุฅุฏุฎุงูู ุนูุฏ ุงููุทุงูุจุฉ:

```python
from huggingface_hub import notebook_login

notebook_login()
```

ุฑุงุฆุน! ุจูุฌุฑุฏ ุฑุจุท ุงูุฏูุชุฑ ุจุญุณุงุจ Hugging Face ุงูุฎุงุต ุจูุงุ ูููููุง ุงููุชุงุจุนุฉ ูุชูุฒูู ูุฌููุนุฉ ุจูุงูุงุช Common Voice. ุณูุณุชุบุฑู ุฐูู ุจุถุน ุฏูุงุฆู ูุชูุฒููู ููุนุงูุฌุชูุ ุญูุซ ูุชู ุฌูุจ ุงูุจูุงูุงุช ูู Hugging Face Hub ูุฅุนุฏุงุฏูุง ุชููุงุฆููุง ูู ุฏูุชุฑ ุงูููุงุญุธุงุช ุงูุฎุงุต ุจู:

```python
from datasets import load_dataset

common_voice_test = load_dataset(
    "mozilla-foundation/common_voice_13_0", "dv", split="test"
)
```

<Tip>
ุฅุฐุง ูุงุฌูุชู ูุดููุฉ ูู ุงููุตุงุฏูุฉ ุนูุฏ ุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุชุ ูุชุฃูุฏ ูู ูุจููู ูุดุฑูุท ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุงูุจูุงูุงุช ุนูู Hugging Face Hub ูู ุฎูุงู ุงูุฑุงุจุท ุงูุชุงูู: https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0
</Tip>

ูููู ุฅุฌุฑุงุก ุงูุชูููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุงููุฉ ุจููุณ ุทุฑููุฉ ุงูุชูููู ุนูู ูุซุงู ูุงุญุฏ - ูู ูุง ุนูููุง ูุนูู ูู **ุงูุญููุฉ** ุนุจุฑ ูููุงุช ุงูุตูุช ุงููุฏุฎูุฉุ ุจุฏูุงู ูู ุงูุงุณุชุฏูุงู ุนูู ุนููุฉ ูุงุญุฏุฉ ููุท. ููููุงู ุจุฐููุ ูููู ุฃููุงู ุจุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุฅูู `KeyDataset`. ูู ูุง ูู ุงูุฃูุฑ ูู ุงุฎุชูุงุฑ ุนููุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุญุฏุฏุฉ ุงูุฐู ูุฑูุฏ ุฅุฑุณุงูู ุฅูู ุงููููุฐุฌ (ูู ุญุงูุชูุงุ ูุฐุง ูู ุนููุฏ `"audio"`)ุ ูุชุฌุงููุงู ุงูุจุงูู (ูุซู ุงููุณุฎ ุงููุณุชูุฏูุฉุ ูุงูุชู ูุง ูุฑูุฏ ุงุณุชุฎุฏุงููุง ููุงุณุชุฏูุงู). ุซู ูููู ุจุงูุชุนููู ุนูู ูุฐู ุงููุฌููุนุงุช ุงููุฑุนูุฉ ุงููุญููุฉุ ูุฅุถุงูุฉ ุงููุฎุฑุฌุงุช ุฅูู ูุงุฆูุฉ ูุญูุธ ุงูุชููุนุงุช. ุณุชุณุชุบุฑู ุฎููุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ุญูุงูู ุฎูุณ ุฏูุงุฆู ุฅุฐุง ุชู ุชุดุบูููุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU) ุจูุตู ุงูุฏูุฉุ ูุชุตู ุฅูู 12 ุฌูุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ:

```python
from tqdm import tqdm
from transformers.pipelines.pt_utils import KeyDataset

all_predictions = []

# run streamed inference
for prediction in tqdm(
    pipe(
        KeyDataset(common_voice_test, "audio"),
        max_new_tokens=128,
        generate_kwargs={"task": "transcribe"},
        batch_size=32,
    ),
    total=len(common_voice_test),
):
    all_predictions.append(prediction["text"])
```

<Tip>
ุฅุฐุง ูุงุฌูุช ูุดููุฉ ูู ุฐุงูุฑุฉ CUDA (OOM) ุนูุฏ ุชุดุบูู ุงูุฎููุฉ ุฃุนูุงูุ ููู ุจุฎูุถ ุญุฌู `batch_size` ุชุฏุฑูุฌูุงู ุจูุถุงุนูุงุช 2 ุญุชู ุชุฌุฏ ุญุฌู ุฏูุนุฉ ููุงุณุจ ุฌูุงุฒู.
</Tip>

ูุฃุฎูุฑูุงุ ูููููุง ุญุณุงุจ WER. ุฏุนููุง ูุญุณุจ ุฃููุงู WER ุงูุฅููุงุฆูุ ุฃู WER ุจุฏูู ุฃู ูุนุงูุฌุฉ ูุงุญูุฉ:

```python
from evaluate import load

wer_metric = load("wer")

wer_ortho = 100 * wer_metric.compute(
    references=common_voice_test["sentence"], predictions=all_predictions
)
wer_ortho
```

**ุงูุฅุฎุฑุงุฌ:**
```
167.29577268612022
```

ุญุณููุง... 167% ุชุนูู ุจุดูู ุฃุณุงุณู ุฃู ูููุฐุฌูุง ููุชุฌ ูุชุงุฆุฌ ุบูุฑ ูููููุฉ ๐ ูุง ุฏุงุนู ูููููุ ุณูููู ูุฏููุง ูู ุชุญุณูู ุฐูู ูู ุฎูุงู ุถุจุท ุงููููุฐุฌ ุงูุฏููู ุนูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ Dhivehi!

ุจุนุฏ ุฐููุ ุณูููู ุจุชูููู WER ุงูุนุงุฏูุ ุฃู WER ุจูุนุงูุฌุฉ ุงูุชุทุจูุน. ูุชุนูู ุนูููุง ุชุตููุฉ ุงูุนููุงุช ุงูุชู ุณุชููู ูุงุฑุบุฉ ุจุนุฏ ุงูุชุทุจูุนุ ูุฅูุง ูุฅู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช ูู ูุฑุฌุนูุง (N) ุณูููู ุตูุฑูุงุ ููุง ุณูุคุฏู ุฅูู ุญุฏูุซ ุฎุทุฃ ูู ุงููุณูุฉ ุงูุตูุฑูุฉ ูู ุญุณุงุจูุง:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

# compute normalized WER
all_predictions_norm = [normalizer(pred) for pred in all_predictions]
all_references_norm = [normalizer(label) for label in common_voice_test["sentence"]]

# filtering step to only evaluate the samples that correspond to non-zero references
all_predictions_norm = [
    all_predictions_norm[i]
    for i in range(len(all_predictions_norm))
    if len(all_references_norm[i]) > 0
]
all_references_norm = [
    all_references_norm[i]
    for i in range(len(all_references_norm))
    if len(all_references_norm[i]) > 0
]

wer = 100 * wer_metric.compute(
    references=all_references_norm, predictions=all_predictions_norm
)

wer
```

**ุงูุฅุฎุฑุงุฌ:**
```
125.69809089960707
```

ูุฑุฉ ุฃุฎุฑูุ ูุฑู ุงูุงูุฎูุงุถ ุงููุจูุฑ ูู WER ุงูุฐู ูุญุตู ุนููู ูู ุฎูุงู ุชุทุจูุน ูุฑุงุฌุนูุง ูุชููุนุงุชูุง: ูุญูู ุงููููุฐุฌ ุงูุฃุณุงุณู ูุนุฏู ุฎุทุฃ ูููุฉ ุฅููุงุฆู ุจูุณุจุฉ 168%ุ ูู ุญูู ุฃู WER ุงููุนูุงุฑู ูู 126%.

ุญุณููุง! ูุฐู ูู ุงูุฃุฑูุงู ุงูุชู ูุฑูุฏ ูุญุงููุฉ ุงูุชุบูุจ ุนูููุง ุนูุฏ ุถุจุท ุงููููุฐุฌ ุงูุฏูููุ ูุชุญุณูู ูููุฐุฌ Whisper ููุชุนุฑู ุนูู ุงูููุงู ูู Dhivehi. ุงุณุชูุฑ ูู ุงููุฑุงุกุฉ ููุงุทูุงุน ุนูู ูุซุงู ุนููู ุนูู ุงูุถุจุท ุงูุฏููู ๐