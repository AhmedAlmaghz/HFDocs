# ุถุจุท ูููุฐุฌ ASR

ูู ูุฐุง ุงููุณูุ ุณููุฏู ุฏููููุง ุฎุทูุฉ ุจุฎุทูุฉ ูุถุจุท Whisper ููุชุนุฑู ุนูู ุงูููุงู ูู ูุฌููุนุฉ ุจูุงูุงุช Common Voice 13. ุณูุณุชุฎุฏู ุงูุฅุตุฏุงุฑ "ุงูุตุบูุฑ" ูู ุงููููุฐุฌ ููุฌููุนุฉ ุจูุงูุงุช ุฎูููุฉ ูุณุจููุงุ ููุง ูุชูุญ ูู ุชุดุบูู ุงูุถุจุท ุงูุฏููู ุจุณุฑุนุฉ ุฅูู ุญุฏ ูุง ุนูู ุฃู ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช (GPU) ุจุณุนุฉ 16 ุฌูุฌุงุจุงูุช+ ูุน ูุชุทูุจุงุช ูุณุงุญุฉ ุชุฎุฒูู ููุฎูุถุฉุ ูุซู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช T4 ุจุณุนุฉ 16 ุฌูุฌุงุจุงูุช ุงูููุฏูุฉ ูู ุงูุทุจูุฉ ุงููุฌุงููุฉ ูู Google Colab.

ุฅุฐุง ูุงู ูุฏูู ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช ุฃุตุบุฑ ุฃู ูุงุฌูุช ูุดููุงุช ูู ุงูุฐุงูุฑุฉ ุฃุซูุงุก ุงูุชุฏุฑูุจุ ูููููู ุงุชุจุงุน ุงูุงูุชุฑุงุญุงุช ุงูููุฏูุฉ ูุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ. ุนูู ุงูุนูุณ ูู ุฐููุ ุฅุฐุง ูุงู ูุฏูู ุฅููุงููุฉ ุงููุตูู ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช ุฃูุจุฑุ ูููููู ุชุนุฏูู ุญุฌุฌ ุงูุชุฏุฑูุจ ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ ุฅูู ุงูุญุฏ ุงูุฃูุตู. ูุจุงูุชุงููุ ูููู ุงููุตูู ุฅูู ูุฐุง ุงูุฏููู ุจุบุถ ุงููุธุฑ ุนู ููุงุตูุงุช ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุงูุฎุงุตุฉ ุจู!

ูุจุงููุซูุ ููุถุญ ูุฐุง ุงูุฏููู ููููุฉ ุถุจุท ูููุฐุฌ Whisper ููุบุฉ ุงูุฏููููู. ููุน ุฐููุ ูุฅู ุงูุฎุทูุงุช ุงููุดูููุฉ ููุง ูุนููุฉ ูุฃู ูุบุฉ ูู ูุฌููุนุฉ ุจูุงูุงุช Common Voiceุ ูุจุดูู ุฃูุซุฑ ุนููููุฉ ูุฃู ูุฌููุนุฉ ุจูุงูุงุช ASR ุนูู Hugging Face Hub. ููููู ุถุจุท ุงูููุฏ ุจุณุฑุนุฉ ููุชุจุฏูู ุฅูู ูุบุฉ ูู ุงุฎุชูุงุฑู ูุถุจุท ูููุฐุฌ Whisper ุจูุบุชู ุงูุฃุตููุฉ ๐

ุญุณููุง! ุงูุขู ููุฏ ุงูุชูููุง ูู ุฐููุ ุฏุนููุง ูุจุฏุฃ ููุทูู ุฎุท ุฃูุงุจูุจ ุงูุถุจุท ุงูุฏููู!

## ุฅุนุฏุงุฏ ุงูุจูุฆุฉ

ููุตุญู ุจุดุฏุฉ ุจุชุญููู ููุงุท ุชูุชูุด ุงููููุฐุฌ ูุจุงุดุฑุฉู ุฅูู [Hugging Face Hub](https://huggingface.co/) ุฃุซูุงุก ุงูุชุฏุฑูุจ.

ูููุฑ ุงููุฑูุฒ ูุง ููู:

- ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ ุงููุชูุงูู: ููููู ุงูุชุฃูุฏ ูู ุนุฏู ููุฏุงู ุฃู ููุทุฉ ุชูุชูุด ูููููุฐุฌ ุฃุซูุงุก ุงูุชุฏุฑูุจ.
- ุณุฌูุงุช TensorBoard: ุชุชุจุน ุงูููุงููุณ ุงููููุฉ ุนูู ูุฏุงุฑ ุงูุชุฏุฑูุจ.
- ุจุทุงูุงุช ุงููููุฐุฌ: ูู ุจุชูุซูู ูุง ููุนูู ุงููููุฐุฌ ูุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูููุตูุฏุฉ ููู.
- ุงููุฌุชูุน: ุทุฑููุฉ ุณููุฉ ูููุดุงุฑูุฉ ูุงูุชุนุงูู ูุน ุงููุฌุชูุน! ๐ค

ุฑุจุท ุงูุฏูุชุฑ ุจุงููุฑูุฒ ุฃูุฑ ุจุณูุท - ููู ูุชุทูุจ ููุท ุฅุฏุฎุงู ุฑูุฒ ุงููุตุงุฏูุฉ ุงูุฎุงุต ุจู ุนูุฏ ุงููุทุงูุจุฉ.

ุงุจุญุซ ุนู ุฑูุฒ ูุตุงุฏูุฉ ุงููุฑูุฒ [ููุง](https://huggingface.co/settings/tokens) ูุฃุฏุฎูู ุนูุฏ ุงููุทุงูุจุฉ:

```python
from huggingface_hub import notebook_login

notebook_login()
```

**ุงูุฅุฎุฑุงุฌ:**

```bash
ุชุณุฌูู ุงูุฏุฎูู ูุงุฌุญ
ุชู ุญูุธ ุฑูุฒู ูู /root/.huggingface/token
```

## ุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุช

ุชุญุชูู [Common Voice 13](https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0) ุนูู ุญูุงูู ุนุดุฑ ุณุงุนุงุช ูู ุจูุงูุงุช Dhivehi ุงูููุณููุฉุ ูููุง ุซูุงุซ ุณุงุนุงุช ูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุงููุญุฌูุฒุฉ. ูุฐุง ูููู ุฌุฏูุง ูู ุงูุจูุงูุงุช ููุถุจุท ุงูุฏูููุ ูุฐุง ุณูุนุชูุฏ ุนูู ุงูุงุณุชูุงุฏุฉ ูู ุงููุนุฑูุฉ ุงููุงุณุนุฉ ูุชุนุฏุฏุฉ ุงููุบุงุช ASR ุงูุชู ุงูุชุณุจุชูุง Whisper ุฃุซูุงุก ุงูุชุฏุฑูุจ ุงููุณุจู ููุบุฉ Dhivehi ููุฎูุถุฉ ุงูููุงุฑุฏ.

ุจุงุณุชุฎุฏุงู Datasets ๐คุ ูููู ุชูุฒูู ุงูุจูุงูุงุช ูุฅุนุฏุงุฏูุง ุจุณูุทูุง ููุบุงูุฉ. ูููููุง ุชูุฒูู ูุฅุนุฏุงุฏ ุชูุณููุงุช Common Voice 13 ูู ุณุทุฑ ูุงุญุฏ ูู ุงูููุฏ. ูุธุฑูุง ูุฃู Dhivehi ููุฎูุถุฉ ุงูููุงุฑุฏ ููุบุงูุฉุ ูุณูู ูุฌูุน ุจูู ุชูุณููุงุช "ุงูุชุฏุฑูุจ" ู"ุงูุชุญูู ูู ุงูุตุญุฉ" ูุฅุนุทุงุก ูุง ููุฑุจ ูู ุณุจุน ุณุงุนุงุช ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ. ุณูุณุชุฎุฏู ุซูุงุซ ุณุงุนุงุช ูู ุจูุงูุงุช "ุงูุงุฎุชุจุงุฑ" ููุฌููุนุฉ ุงุฎุชุจุงุฑ ูุญุฌูุฒุฉ ูุฏููุง:

```python
from datasets import load_dataset, DatasetDict

common_voice = DatasetDict()

common_voice["train"] = load_dataset(
"mozilla-foundation/common_voice_13_0", "dv", split="train+validation"
)
common_voice["test"] = load_dataset(
"mozilla-foundation/common_voice_13_0", "dv", split="test"
)

print(common_voice)
```

**ุงูุฅุฎุฑุงุฌ:**

```
DatasetDict({
train: Dataset({
features: ['client_id', 'path', 'audio', 'sentence', 'up_votes', 'down_votes', 'age', 'gender', 'accent', 'locale', 'segment', 'variant'],
num_rows: 4904
})
test: Dataset({
features: ['client_id', 'path', 'audio', 'sentence', 'up_votes', 'down_votes', 'age', 'gender', 'accent', 'locale', 'segment', 'variant'],
num_rows: 2212
})
})
```

<Tip>
ููููู ุชุบููุฑ ูุนุฑู ุงููุบุฉ ูู `"dv"` ุฅูู ูุนุฑู ูุบุฉ ูู ุงุฎุชูุงุฑู. ููุดุงูุฏุฉ ุฌููุน ุงููุบุงุช ุงูููููุฉ ูู Common Voice 13ุ ุฑุงุฌุน ุจุทุงูุฉ ูุฌููุนุฉ ุงูุจูุงูุงุช ุนูู Hugging Face Hub: https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0
</Tip>

ุชููุฑ ูุนุธู ูุฌููุนุงุช ุจูุงูุงุช ASR ููุท ุนููุงุช ุตูุชูุฉ ุตูุชูุฉ (`audio`) ูุงููุต ุงูููููู ุงูููุงุจู (`sentence`). ุชุญุชูู Common Voice ุนูู ูุนูููุงุช ุฅุถุงููุฉ ุญูู ุงูุจูุงูุงุช ุงููุตููุฉุ ูุซู `accent` ู`locale`ุ ูุงูุชู ูููููุง ุชุฌุงูููุง ูู ASR. ููุญูุงุธ ุนูู ุงูุฏูุชุฑ ุจุฃูุจุฑ ูุฏุฑ ูููู ูู ุงูุนููููุฉุ ูุฅููุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ููุท ุงูุตูุช ุงููุฏุฎู ูุงููุต ุงูููููู ููุถุจุท ุงูุฏูููุ ููููู ุจุชุฌุงูู ูุนูููุงุช ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฅุถุงููุฉ:

```python
common_voice = common_voice.select_columns(["audio", "sentence"])
```

## ูุณุชุฎุฑุฌ ุงูููุฒุงุช ูุงููุญูู ูุนูููุงุช ุงููุนุงูุฌุฉ

ูููู ุชูุณูู ุฎุท ุฃูุงุจูุจ ASR ุฅูู ุซูุงุซ ูุฑุงุญู:

1. ูุณุชุฎุฑุฌ ุงูููุฒุงุช ุงูุฐู ูููู ุจูุนุงูุฌุฉ ุงูุตูุช ุงูุฎุงู ุฅูู ูุฎุทุทุงุช mel-log
2. ุงููููุฐุฌ ุงูุฐู ูููู ุจุชูููุฐ ุงูุชุฎุทูุท ุงูุชุณูุณูู ุฅูู ุงูุชุณูุณูู
3. ุงููุญูู ุงูุฐู ูููู ุจูุนุงูุฌุฉ ุงูุฑููุฒ ุงููููุฒุฉ ุงููุชููุนุฉ ุฅูู ูุต

ูู ๐ค Transformersุ ูุฑุชุจุท ูููุฐุฌ Whisper ุจูุณุชุฎุฑุฌ ููุฒุงุช ููุญููุ ูุณูู [WhisperFeatureExtractor](https://huggingface.co/docs/transformers/main/model_doc/whisper#transformers.WhisperFeatureExtractor) ู [WhisperTokenizer](https://huggingface.co/docs/transformers/main/model_doc/whisper#transformers.WhisperTokenizer)
ุนูู ุงูุชูุงูู. ูุชุจุณูุท ุงูุฃููุฑุ ูุชู ุชุบููู ูุฐูู ุงููุงุฆููู ูู ูุฆุฉ ูุงุญุฏุฉุ ุชุณูู [WhisperProcessor](https://huggingface.co/docs/transformers/model_doc/whisper#transformers.WhisperProcessor).

ูููููุง ุงุณุชุฏุนุงุก WhisperProcessor ูุฃุฏุงุก ูู ูู ูุนุงูุฌุฉ ุงูุตูุช ุงูุณุงุจูุฉ ููุนุงูุฌุฉ ุฑููุฒ ุงููุต ุงููุงุญูุฉ. ุนูุฏ ุงูููุงู
ุจูุฐู ุงูุทุฑููุฉุ ูุญุชุงุฌ ููุท ุฅูู ุชุชุจุน ูุงุฆููู ุฃุซูุงุก ุงูุชุฏุฑูุจ: ุงููุนุงูุฌ ูุงููููุฐุฌ.

ุนูุฏ ุฅุฌุฑุงุก ุงูุถุจุท ุงูุฏููู ูุชุนุฏุฏ ุงููุบุงุชุ ููุฒู ุชุนููู `"language"` ู `"task"` ุนูุฏ ุฅูุดุงุก ุงููุนุงูุฌ. ูุฌุจ ุชุนููู `"language"` ุนูู ูุบุฉ ุงูุตูุช ุงููุตุฏุฑุ ูุงููููุฉ ุฅูู `"transcribe"` ููุชุนุฑู ุนูู ุงูููุงู ุฃู `"translate"` ูุชุฑุฌูุฉ ุงูููุงู. ุชุนุฏูู ูุฐู ุงูุญุฌุฌ ุณููู ุงููุญููุ ููุฌุจ ุชุนููููุง ุจุดูู ุตุญูุญ
ูุถูุงู ุชุฑููุฒ ุงูุชุณููุงุช ุงููุณุชูุฏูุฉ ุจุดูู ุตุญูุญ.

ูููููุง ูุนุฑูุฉ ุฌููุน ุงููุบุงุช ุงูุชู ุชุฏุนููุง Whisper ุนู ุทุฑูู ุงุณุชูุฑุงุฏ ูุงุฆูุฉ ุงููุบุงุช:

```python
from transformers.models.whisper.tokenization_whisper import TO_LANGUAGE_CODE

TO_LANGUAGE_CODE
```

ุฅุฐุง ููุช ุจุงูุชูุฑูุฑ ุฎูุงู ูุฐู ุงููุงุฆูุฉุ ูุณุชูุงุญุธ ุฃู ุงูุนุฏูุฏ ูู ุงููุบุงุช ููุฌูุฏุฉุ ูููู Dhivehi ููุณุช ูุงุญุฏุฉ ูููุง!
ูุฐุง ูุนูู ุฃู Whisper ูู ูุชู ุงูุชุฏุฑูุจ ุงููุณุจู ุนููู ูู Dhivehi. ููุน ุฐููุ ูุฅู ูุฐุง ูุง ูุนูู ุฃููุง ูุง ูุณุชุทูุน ุถุจุท Whisper ุนููู.
ุนูุฏ ุงูููุงู ุจุฐููุ ุณูููู ุจุชุนููู Whisper ูุบุฉ ุฌุฏูุฏุฉุ ููู ูุบุฉ ูุง ุชุฏุนููุง ููุทุฉ ุงูุชุญูู ุงููุณุจูุฉ ุงูุชุฏุฑูุจ. ูุฐุง ุฑุงุฆุนุ ุฃููุณ ูุฐูู!

ุนูุฏูุง ุชููู ุจุถุจุทู ุจุฏูุฉ ุนูู ูุบุฉ ุฌุฏูุฏุฉุ ูุฅู Whisper ูููู ุจุนูู ุฌูุฏ ูู ุงูุงุณุชูุงุฏุฉ ูู ูุนุฑูุชู ุจุงููุบุงุช ุงูุฃุฎุฑู
96 ูุบุฉ ุงูุชู ูุนุฑููุง ุจุงููุนู. ุจุดูู ุนุงูุ ุณุชููู ุฌููุน ุงููุบุงุช ุงูุญุฏูุซุฉ ูุดุงุจูุฉ ูุบูููุง ููุงุญุฏุฉ ุนูู ุงูุฃูู ูู
96 ูุบุฉ Whisper ูุนุฑู ุจุงููุนูุ ูุฐูู ุณููุน ุชุญุช ูุฐู ุงููุธูุฉ ูุชูุซูู ุงููุนุฑูุฉ ุนุจุฑ ุงููุบุงุช.

ูุง ูุญุชุงุฌ ุฅูู ูุนูู ูุถุจุท Whisper ุจุฏูุฉ ุนูู ูุบุฉ ุฌุฏูุฏุฉ ูู ุงูุนุซูุฑ ุนูู ุงููุบุฉ **ุงูุฃูุซุฑ ุชุดุงุจูุง** ุงูุชู ุชู ุจูุง
ุชู ุชุฏุฑูุจ Whisper ูุณุจููุง. ุชูุต ููุงูุฉ Wikipedia ุงูุฎุงุตุฉ ุจู Dhivehi ุนูู ุฃู Dhivehi ุชุฑุชุจุท ุงุฑุชุจุงุทูุง ูุซูููุง ุจูุบุฉ ุงูุณููุงูุง ูู ุณุฑููุงููุง.
ุฅุฐุง ุชุญูููุง ูู ุฑููุฒ ุงููุบุฉ ูุฑุฉ ุฃุฎุฑูุ ูุณูุฑู ุฃู ุงูุณููุงููุฉ ููุฌูุฏุฉ ูู ูุฌููุนุฉ ูุบุงุช Whisperุ
ูุฐุง ูููููุง ุจุจุณุงุทุฉ ุชุนููู ุญุฌุฉ ุงููุบุฉ ุงูุฎุงุตุฉ ุจูุง ุฅูู `"sinhalese"`.

ุญุณููุง! ุณูููู ุจุชุญููู ุงููุนุงูุฌ ุงูุฎุงุต ุจูุง ูู ููุทุฉ ุงูุชุญูู ุงููุณุจูุฉุ ูุน ุชุนููู ุงููุบุฉ ุฅูู `"sinhalese"` ูุงููููุฉ ุฅูู `"transcribe"`
ููุง ูู ููุถุญ ุฃุนูุงู:

```python
from transformers import WhisperProcessor

processor = WhisperProcessor.from_pretrained(
"openai/whisper-small", language="sinhalese", task="transcribe"
)
```

ูู ุงูุฌุฏูุฑ ุจุงูุชูุฑุงุฑ ุฃูู ูู ูุนุธู ุงูุธุฑููุ ุณุชุฌุฏ ุฃู ุงููุบุฉ ุงูุชู ุชุฑูุฏ ุงูุถุจุท ุงูุฏููู ุนูููุง ููุฌูุฏุฉ ูู ูุฌููุนุฉ
ูุบุงุช ุงูุชุฏุฑูุจ ุงููุณุจูุ ูู ูุฐู ุงูุญุงูุฉ ููููู ุจุจุณุงุทุฉ ุชุนููู ุงููุบุฉ ูุจุงุดุฑุฉู ููุบุฉ ุตูุช ุงููุตุฏุฑ ุงูุฎุงุตุฉ ุจู! ูุงุญุธ ุฃู
ูุฌุจ ุญุฐู ููุง ุงูุญุฌุชูู ููุถุจุท ุงูุฏููู ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ููุทุ ุญูุซ ููุฌุฏ ุฎูุงุฑ ูุงุญุฏ ููุท ููุบุฉ
(`"English"`) ูุงููููุฉ (`"transcribe"`).

## ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุณุจููุง

ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููุฒุงุช ูุฌููุนุฉ ุงูุจูุงูุงุช. ุงูุชุจู ุจุดูู ุฎุงุต ุฅูู ุนููุฏ "ุงูุตูุช" - ููุถุญ ูุฐุง ุชูุงุตูู ูุนุฏู ุฃุฎุฐ ุงูุนููุงุช
ูู ุนููุงุช ุงูุตูุช ูุฏููุง:

```python
common_voice["train"].features
```

**ุงูุฅุฎุฑุงุฌ:**

```
{'audio': Audio(sampling_rate=48000ุ mono=Trueุ decode=Trueุ id=None)ุ
'ุงูุฌููุฉ': ุงููููุฉ (dtype='string'ุ id=None)}
```

ูุธุฑูุง ูุฃู ุงูุตูุช ุงููุฏุฎู ูุฏููุง ุชู ุฃุฎุฐ ุนููุงุช ููู ุจูุนุฏู 48 ูููู ูุฑุชุฒุ ููุฌุจ ุนูููุง _ุชุฎููุถ_ ูุนุฏู ุงูุนููุงุช ุฅูู 16 ูููู ูุฑุชุฒ ูุจู ุชูุฑูุฑู ุฅูู ูุณุชุฎุฑุฌ ููุฒุงุช Whisperุ ุญูุซ ุฃู ูุนุฏู ุงูุนููุงุช ุงูุฐู ูุชููุนู ูููุฐุฌ Whisper ูู 16 ูููู ูุฑุชุฒ.

ุณูููู ุจุถุจุท ุนููุงุช ุงูุตูุช ุนูู ูุนุฏู ุงูุนููุงุช ุงูุตุญูุญ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ [`cast_column`](https://huggingface.co/docs/datasets/main/en/package_reference/main_classes#datasets.Dataset.cast_column)
ูู ูุฌููุนุงุช ุงูุจูุงูุงุช. ูุง ุชุบูุฑ ูุฐู ุงูุนูููุฉ ุงูุตูุช ูู ููุงููุ ูููููุง ุชุดูุฑ ุฅูู ูุฌููุนุงุช ุงูุจูุงูุงุช ูุฅุนุงุฏุฉ ุฃุฎุฐ ุนููุงุช ุนููุงุช ุงูุตูุช
ุนูุฏ ุชุญููููุง:

```python
from datasets import Audio

sampling_rate = processor.feature_extractor.sampling_rate
common_voice = common_voice.cast_column("audio", Audio(sampling_rate=sampling_rate))
```

ุงูุขู ูููููุง ูุชุงุจุฉ ุฏุงูุฉ ูุฅุนุฏุงุฏ ุจูุงูุงุชูุง ุฌุงูุฒุฉ ูููููุฐุฌ:

1. ูููู ุจุชุญููู ุจูุงูุงุช ุงูุตูุช ูุฅุนุงุฏุฉ ุฃุฎุฐ ุนููุงุช ูููุง ุนูู ุฃุณุงุณ ุงูุนููุฉ ุนู ุทุฑูู ุงุณุชุฏุนุงุก `sample ["audio"]`. ููุง ูู ููุถุญ ุฃุนูุงูุ ุชููู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค Datasets ุจุฃู ุนูููุงุช ุฅุนุงุฏุฉ ุฃุฎุฐ ุนููุงุช ูุทููุจุฉ ุฃุซูุงุก ุงูุชููู.
2. ูุณุชุฎุฏู ูุณุชุฎุฑุฌ ุงูููุฒุงุช ูุญุณุงุจ ูุฎุทุทุงุช mel-log ูู ุตููู ุงูุตูุช ุฃุญุงุฏู ุงูุจุนุฏ ุงูุฎุงุต ุจูุง.
3. ูููู ุจุชุฑููุฒ ุงููุตูุต ุงููููููุฉ ุฅูู ูุนุฑูุงุช ุงูุนูุงูุงุช ูู ุฎูุงู ุงุณุชุฎุฏุงู ุงููุญูู.

```python
def prepare_dataset(example):
audio = example["audio"]

example = processor(
audio=audio["array"],
sampling_rate=audio["sampling_rate"],
text=example["sentence"],
)

# ุงุญุณุจ ุทูู ุงูุฅุฏุฎุงู ุงูุตูุชู ููุนููุฉ ุจุงูุซูุงูู
example["input_length"] = len(audio["array"]) / audio["sampling_rate"]

return example
```

ูููููุง ุชุทุจูู ุฏุงูุฉ ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุนูู ุฌููุน ุฃูุซูุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจูุง ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `.map` ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค. ุณูููู
ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ุงูุฎุงู (ุงูุตูุช ูุงููุต)ุ ุชุงุฑูุฉ ููุท ุงูุฃุนูุฏุฉ ุงูุชู ุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ
ุฏุงูุฉ `prepare_dataset`:

```python
common_voice = common_voice.map(
prepare_dataset, remove_columns=common_voice.column_names["train"], num_proc=1
)
```

ุฃุฎูุฑูุงุ ูููู ุจุชุตููุฉ ุฃู ุจูุงูุงุช ุชุฏุฑูุจ ุชุญุชูู ุนูู ุนููุงุช ุตูุชูุฉ ุฃุทูู ูู 30 ุซุงููุฉ. ุณูุชู ุงูุชุตุงุต ูุฐู ุงูุนููุงุช ุจุฎูุงู ุฐูู ุจูุงุณุทุฉ
ูุณุชุฎุฑุฌ ููุฒุงุช Whisper ูุงูุฐู ูุฏ ูุคุซุฑ ุนูู ุงุณุชูุฑุงุฑ ุงูุชุฏุฑูุจ. ูุญุฏุฏ ุฏุงูุฉ ุชุนูุฏ `True` ููุนููุงุช ุงูุชู ุชูู ุนู 30 ุซุงููุฉุ ู`False` ูุชูู ุงูุชู ุชุฒูุฏ ุนู 30 ุซุงููุฉ:

```python
max_input_length = 30.0


def is_audio_in_length_range(length):
return length < max_input_length
```

ูุทุจู ุฏุงูุฉ ุงูุชุตููุฉ ุงูุฎุงุตุฉ ุจูุง ุนูู ุฌููุน ุนููุงุช ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจูุง ูู ุฎูุงู ุทุฑููุฉ `.filter` ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ๐ค:

```python
common_voice["train"] = common_voice["train"].filter(
is_audio_in_length_range,
input_columns=["input_length"],
)
```

ุฏุนููุง ูุชุญูู ูู ููุฏุงุฑ ุจูุงูุงุช ุงูุชุฏุฑูุจ ุงูุชู ุชูุช ุฅุฒุงูุชูุง ูู ุฎูุงู ุฎุทูุฉ ุงูุชุตููุฉ ูุฐู:

```python
common_voice["train"]
```

**ุงูุฅุฎุฑุงุฌ**

```
Dataset({
features: ['input_features', 'labels', 'input_length'],
num_rows: 4904
})
```

ุญุณููุง! ูู ูุฐู ุงูุญุงูุฉุ ูุฏููุง ููุณ ุนุฏุฏ ุงูุนููุงุช ููุง ูุงู ูู ูุจูุ ูุฐูู ูู ุชูู ููุงู ุนููุงุช ุฃุทูู ูู 30 ุซุงููุฉ.
ูุฏ ูุง ูููู ูุฐุง ูู ุงูุญุงู ุฅุฐุง ููุช ุจุงูุชุจุฏูู ุจูู ุงููุบุงุชุ ูุฐุง ููู ุงูุฃูุถู ุงูุงุญุชูุงุธ ุจุฎุทูุฉ ุงูุชุตููุฉ ูุฐู ูู ููุงููุง ูููุชุงูุฉ. ูุน
ุฐููุ ูุฏููุง ุจูุงูุงุชูุง ุฌุงูุฒุฉ ููุชุฏุฑูุจ ุชูุงููุง! ุฏุนููุง ููุงุตู ููููู ูุธุฑุฉ ุนูู ููููุฉ ุงุณุชุฎุฏุงู ูุฐู ุงูุจูุงูุงุช ูุถุจุท Whisper ุจุฏูุฉ.

## ุงูุชุฏุฑูุจ ูุงูุชูููู

ุงูุขู ุจุนุฏ ุฃู ุฃุนุฏุฏูุง ุจูุงูุงุชูุงุ ูุญู ูุณุชุนุฏูู ููุบูุต ูู ุฎุท ุฃูุงุจูุจ ุงูุชุฏุฑูุจ.

ุณูุชููู [๐ค Trainer](https://huggingface.co/transformers/master/main_classes/trainer.html?highlight=trainer)
ุฌุฒุก ูุจูุฑ ูู ุงูุนูู ุงูุดุงู ููุงุจุฉ ุนูุง. ูู ูุง ุนูููุง ูุนูู ูู:

- ุชุญุฏูุฏ ุฌุงูุน ุงูุจูุงูุงุช: ูููู ุฌุงูุน ุงูุจูุงูุงุช ุจุฃุฎุฐ ุจูุงูุงุชูุง ุงูุชู ุชูุช ูุนุงูุฌุชูุง ูุณุจููุง ูุฅุนุฏุงุฏ ุชูุณููุงุช PyTorch ุฌุงูุฒุฉ ูููููุฐุฌ.
- ููุงููุณ ุงูุชูููู: ุฃุซูุงุก ุงูุชููููุ ูุฑูุฏ ุชูููู ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู ูููุงุณ ุฎุทุฃ ุงููููุฉ (WER). ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุฏุงูุฉ `compute_metrics` ุงูุชู ุชุชููู ูุฐุง ุงูุญุณุงุจ.
- ุชุญููู ููุทุฉ ุชูุชูุด ูุณุจูุฉ ุงูุชุฏุฑูุจ: ูุญุชุงุฌ ุฅูู ุชุญููู ููุทุฉ ุชูุชูุด ูุณุจูุฉ ุงูุชุฏุฑูุจ ูุชูููููุง ุจุดูู ุตุญูุญ ููุชุฏุฑูุจ.
- ุชุญุฏูุฏ ุญุฌุฌ ุงูุชุฏุฑูุจ: ุณูุชู ุงุณุชุฎุฏุงู ูุฐู ุงูุญุฌุฌ ุจูุงุณุทุฉ ๐ค Trainer ูู ุจูุงุก ุฌุฏูู ุงูุชุฏุฑูุจ.

ุจูุฌุฑุฏ ุถุจุท ุงููููุฐุฌ ุจุฏูุฉุ ุณูููู ุจุชููููู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ููุชุญูู ูู ุฃููุง ูููุง ุจุชุฏุฑูุจู ุจุดูู ุตุญูุญ
ููุณุฎ ุงูููุงู ูู Dhivehi.
### ุชุนุฑูู ูุฌูุน ุงูุจูุงูุงุช
ูุฌูุน ุงูุจูุงูุงุช ููููุฐุฌ ุชุญููู ุงููุต ุฅูู ููุงู ูุฑูุฏ ูู ุญูุซ ุฃูู ูุชุนุงูู ูุน `input_features` ู `labels` ุจุดูู ูุณุชูู: ูุฌุจ ุฃู ุชุชู ูุนุงูุฌุฉ `input_features` ุจูุงุณุทุฉ ูุณุชุฎูุต ุงูููุฒุงุช ู `labels` ุจูุงุณุทุฉ ุงูุฑูุฒ ุงููููุฒ. ุชู ุจุงููุนู ุชุญููู `input_features` ุฅูู 30 ุซุงููุฉ ูุชุญููููุง ุฅูู ูุฎุทุท Mel-Spectrogram ุซุงุจุช ุงูุฃุจุนุงุฏุ ูุฐูู ูู ูุง ุนูููุง ูุนูู ูู ุชุญููููุง ุฅูู ููุชุฑุงุช PyTorch ูุฌูุนุฉ. ููุนู ูุฐุง ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `.pad` ููุณุชุฎูุต ุงูููุฒุงุช ูุน `return_tensors=pt`. ูุงุญุธ ุฃูู ูู ูุชู ุชุทุจูู ุฃู ูุณุงุฏุฉ ุฅุถุงููุฉ ููุง ูุฃู ุงูุฅุฏุฎุงูุงุช ุฐุงุช ุฃุจุนุงุฏ ุซุงุจุชุฉุ ู `input_features` ูุชู ุชุญููููุง ุจุจุณุงุทุฉ ุฅูู ููุชุฑุงุช PyTorch.

ูู ูุงุญูุฉ ุฃุฎุฑูุ ูุฅู `labels` ุบูุฑ ูุจุทูุฉ. ุฃููุงูุ ูููู ุจุชุจุทูู ุงูุชุณูุณูุงุช ุฅูู ุงูุทูู ุงูุฃูุตู ูู ุงูุฏูุนุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `.pad` ูููุญูู ุงููุบูู. ุซู ูุชู ุงุณุชุจุฏุงู ุฑููุฒ ุงูุญุดู ุจู `-100` ุจุญูุซ ูุง ูุชู ุฃุฎุฐ ูุฐู ุงูุฑููุฒ ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุญุณุงุจ ุงูุฎุณุงุฑุฉ. ุจุนุฏ ุฐููุ ูููู ุจูุทุน ุจุฏุงูุฉ ุชุณูุณู ุงูุนูุงูุงุช ูู ุจุฏุงูุฉ ุชุณูุณู ุงูุนูุงูุงุช ุญูุซ ูููู ุจุฅูุญุงูู ูุงุญููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ.

ูููููุง ุงูุงุณุชูุงุฏุฉ ูู `WhisperProcessor` ุงูุฐู ุญุฏุฏูุงู ุณุงุจููุง ูุฃุฏุงุก ุนูููุงุช ูู ูู ูุณุชุฎูุต ุงูููุฒุงุช ูุงููุญูู ุงููุบูู:

```python
import torch

from dataclasses import dataclass
from typing import Any, Dict, List, Union


@dataclass
class DataCollatorSpeechSeq2SeqWithPadding:
    processor: Any

    def __call__(
        self, features: List[Dict[str, Union[List[int], torch.Tensor]]]
    ) -> Dict[str, torch.Tensor]:
        # split inputs and labels since they have to be of different lengths and need different
        # padding methods
        # first treat the audio inputs by simply returning torch tensors
        input_features = [
            {"input_features": feature["input_features"][0]} for feature in features
        ]
        batch = self.processor.feature_extractor.pad(input_features, return_tensors="pt")

        # get the tokenized label sequences
        label_features = [{"input_ids": feature["labels"]} for feature in features]
        # pad the labels to max length
        labels_batch = self.processor.tokenizer.pad(label_features, return_tensors="pt")

        # replace padding with -100 to ignore loss correctly
        labels = labels_batch["input_ids"].masked_fill(
            labels_batch.attention_mask.ne(1), -100
        )

        # if bos token is appended in previous tokenization step,
        # cut bos token here as it's append later anyways
        if (labels[:, 0] == self.processor.tokenizer.bos_token_id).all().cpu().item():
            labels = labels[:, 1:]

        batch["labels"] = labels

        return batch
```

ุงูุขู ูููููุง ุชููุฆุฉ ูุฌูุน ุงูุจูุงูุงุช ุงูุฐู ุญุฏุฏูุงู ููุชู:

```python
data_collator = DataCollatorSpeechSeq2SeqWithPadding(processor=processor)
```

### ููุงููุณ ุงูุชูููู
ุจุนุฏ ุฐููุ ูุญุฏุฏ ูููุงุณ ุงูุชูููู ุงูุฐู ุณูุณุชุฎุฏูู ูู ูุฌููุนุฉ ุงูุชูููู ุงูุฎุงุตุฉ ุจูุง. ุณูุณุชุฎุฏู ูููุงุณ Word Error Rate (WER) ุงูุฐู ุชู ุชูุฏููู ูู ูุณู [ุงูุชูููู](evaluation)ุ ููู ูููุงุณ "ุจุญูู ุงูุฃูุฑ ุงููุงูุน" ูุชูููู ุฃูุธูุฉ ASR.

ุณูููู ุจุชุญููู ูููุงุณ WER ูู ๐ค ุชูููู:

```python
import evaluate

metric = evaluate.load("wer")
```

ุจุนุฏ ุฐููุ ูุง ุนูููุง ุณูู ุชุญุฏูุฏ ุฏุงูุฉ ุชุฃุฎุฐ ุชูุจุคุงุช ุงููููุฐุฌ ูุชุนูุฏ ูููุงุณ WER. ุชููู ูุฐู ุงูุฏุงูุฉุ ุงููุณูุงุฉ `compute_metrics`ุ ุฃููุงู ุจุงุณุชุจุฏุงู `-100` ุจู `pad_token_id` ูู `label_ids` (ุฅูุบุงุก ุงูุฎุทูุฉ ุงูุชู ุทุจููุงูุง ูู ูุฌูุน ุงูุจูุงูุงุช ูุชุฌุงูู ุงูุฑููุฒ ุงููุญุดูุฉ ุจุดูู ุตุญูุญ ูู ุงูุฎุณุงุฑุฉ). ุจุนุฏ ุฐููุ ูููู ุจูู ุชุดููุฑ ูุนุฑูุงุช ุงูุชูุจุค ูุงูุนูุงูุงุช ุฅูู ุณูุงุณู. ุฃุฎูุฑูุงุ ูุญุณุจ WER ุจูู ุงูุชูุจุคุงุช ูุงูุนูุงูุงุช ุงููุฑุฌุนูุฉ. ููุงุ ูุฏููุง ุฎูุงุฑ ุงูุชูููู ุจุงุณุชุฎุฏุงู ุงููุณุฎ ุงููุตูุฉ ูุงูุชูุจุคุงุช "ุงูุทุจูุนูุฉ"ุ ูุงูุชู ุชูุช ุฅุฒุงูุฉ ุนูุงูุงุช ุงูุชุฑููู ูุงูุญุงูุฉ ูููุง. ููุตู ุจุงุชุจุงุน ูุฐุง ุงูุฃูุฑ ููุงุณุชูุงุฏุฉ ูู ุชุญุณูู WER ุงูุฐู ุชู ุงูุญุตูู ุนููู ุนู ุทุฑูู ุชุทุจูุน ุงููุณุฎ ุงููุตูุฉ.

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()


def compute_metrics(pred):
    pred_ids = pred.predictions
    label_ids = pred.label_ids

    # replace -100 with the pad_token_id
    label_ids[label_ids == -100] = processor.tokenizer.pad_token_id

    # we do not want to group tokens when computing the metrics
    pred_str = processor.batch_decode(pred_ids, skip_special_tokens=True)
    label_str = processor.batch_decode(label_ids, skip_special_tokens=True)

    # compute orthographic wer
    wer_ortho = 100 * metric.compute(predictions=pred_str, references=label_str)

    # compute normalised WER
    pred_str_norm = [normalizer(pred) for pred in pred_str]
    label_str_norm = [normalizer(label) for label in label_str]
    # filtering step to only evaluate the samples that correspond to non-zero references:
    pred_str_norm = [
        pred_str_norm[i] for i in range(len(pred_str_norm)) if len(label_str_norm[i]) > 0
    ]
    label_str_norm = [
        label_str_norm[i] for i in range(len(label_str_norm)) if len(label_str_norm[i]) > 0
    ]

    wer = 100 * metric.compute(predictions=pred_str_norm, references=label_str_norm)

    return {"wer_ortho": wer_ortho, "wer": wer}
```

### ุชุญููู ููุทุฉ ุชูุชูุด ูุณุจูุฉ ุงูุชุฏุฑูุจ
ุงูุขู ุฏุนูุง ูุญูู ููุทุฉ ุชูุชูุด Whisper ุงูุตุบูุฑุฉ ูุณุจูุฉ ุงูุชุฏุฑูุจ. ูุฑุฉ ุฃุฎุฑูุ ูุฐุง ุฃูุฑ ุณูู ูู ุฎูุงู ุงุณุชุฎุฏุงู ๐ค Transformers!

```python
from transformers import WhisperForConditionalGeneration

model = WhisperForConditionalGeneration.from_pretrained("openai/whisper-small")
```

ุณูููู ุจุชุนููู `use_cache` ุฅูู `False` ููุชุฏุฑูุจ ูุฃููุง ูุณุชุฎุฏู [ูุญุต ุชุฏุฑุฌ](https://huggingface.co/docs/transformers/v4.18.0/en/performance#gradient-checkpointing) ูุงูุงุซูุงู ุบูุฑ ูุชูุงูููู. ุณูููู ุฃูุถูุง ุจุชุฌุงูุฒ ุญุฌุชูู ููุฌูู ููุชุญูู ูู ุณููู ุงููููุฐุฌ ุฃุซูุงุก ุงูุงุณุชุฏูุงู: ุณููุฑุถ ุงููุบุฉ ูุงูุฑููุฒ ุฃุซูุงุก ุงูุชูููุฏ ุนู ุทุฑูู ุชุนููู ูุณูุทู `language` ู `task`ุ ูุฅุนุงุฏุฉ ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุณุฑุนุฉ - ุฒูุงุฏุฉ ููุช ุงูุงุณุชุฏูุงู:

```python
from functools import partial

# disable cache during training since it's incompatible with gradient checkpointing
model.config.use_cache = False

# set language and task for generation and re-enable cache
model.generate = partial(
    model.generate, language="sinhalese", task="transcribe", use_cache=True
)
```

## ุชุญุฏูุฏ ุชูููู ุงูุชุฏุฑูุจ
ูู ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉุ ูููู ุจุชุนุฑูู ุฌููุน ุงููุนููุงุช ุงููุชุนููุฉ ุจุงูุชุฏุฑูุจ. ููุงุ ูููู ุจุชุนููู ุนุฏุฏ ุฎุทูุงุช ุงูุชุฏุฑูุจ ุฅูู 500. ูุฐุง ูููู ูู ุงูุฎุทูุงุช ูุฑุคูุฉ ุชุญุณู ูุจูุฑ ูู WER ููุงุฑูุฉ ุจูููุฐุฌ Whisper ุงูููุฏุฑุจ ูุณุจููุงุ ูุน ุถูุงู ุฅููุงููุฉ ุชุดุบูู ุงูุถุจุท ุงูุฏููู ูู ุบุถูู 45 ุฏูููุฉ ุชูุฑูุจูุง ุนูู Google Colab ูุฌุงููุง. ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุญุฌุฌ ุงูุชุฏุฑูุจุ ุฑุงุฌุน ูุซุงุฆู Seq2SeqTrainingArguments [docs](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.Seq2SeqTrainingArguments).

```python
from transformers import Seq2SeqTrainingArguments

training_args = Seq2SeqTrainingArguments(
    output_dir="./whisper-small-dv",  # name on the HF Hub
    per_device_train_batch_size=16,
    gradient_accumulation_steps=1,  # increase by 2x for every 2x decrease in batch size
    learning_rate=1e-5,
    lr_scheduler_type="constant_with_warmup",
    warmup_steps=50,
    max_steps=500,  # increase to 4000 if you have your own GPU or a Colab paid plan
    gradient_checkpointing=True,
    fp16=True,
    fp16_full_eval=True,
    evaluation_strategy="steps",
    per_device_eval_batch_size=16,
    predict_with_generate=True,
    generation_max_length=225,
    save_steps=500,
    eval_steps=500,
    logging_steps=25,
    report_to=["tensorboard"],
    load_best_model_at_end=True,
    metric_for_best_model="wer",
    greater_is_better=False,
    push_to_hub=True,
)
```

<Tip>
ุฅุฐุง ููุช ูุง ุชุฑูุฏ ุชุญููู ููุงุท ุชูุชูุด ุงููููุฐุฌ ุฅูู Hubุ ูุงุถุจุท `push_to_hub=False`.
</Tip>

ูููููุง ุชูุฑูุฑ ุญุฌุฌ ุงูุชุฏุฑูุจ ุฅูู ๐ค Trainer ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุงููููุฐุฌ ููุฌููุนุฉ ุงูุจูุงูุงุช ููุฌูุน ุงูุจูุงูุงุช ููุธููุฉ `compute_metrics`:

```python
from transformers import Seq2SeqTrainer

trainer = Seq2SeqTrainer(
    args=training_args,
    model=model,
    train_dataset=common_voice["train"],
    eval_dataset=common_voice["test"],
    data_collator=data_collator,
    compute_metrics=compute_metrics,
    tokenizer=processor,
)
```

ูุจูุฐุง ูููู ูุณุชุนุฏูู ูุจุฏุก ุงูุชุฏุฑูุจ!

### ุงูุชุฏุฑูุจ
ูุจุฏุก ุงูุชุฏุฑูุจุ ูุง ุนููู ุณูู ุชูููุฐ:

```python
trainer.train()
```

ุณูุณุชุบุฑู ุงูุชุฏุฑูุจ ุญูุงูู 45 ุฏูููุฉ ุงุนุชูุงุฏูุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจู ุฃู ุงูุชู ุชู ุชุฎุตูุตูุง ูู Google Colab. ุงุนุชูุงุฏูุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจูุ ูู ุงููุญุชูู ุฃู ุชูุงุฌู ุฎุทุฃ "ููุงุฏ ุงูุฐุงูุฑุฉ" ูู CUDA ุนูุฏ ุจุฏุก ุงูุชุฏุฑูุจ. ูู ูุฐู ุงูุญุงูุฉุ ููููู ุชูููู `per_device_train_batch_size` ุจุดูู ุชุฏุฑูุฌู ุจุนูุงูู 2 ูุงุณุชุฎุฏุงู [`gradient_accumulation_steps`](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.Seq2SeqTrainingArguments.gradient_accumulation_steps) ููุชุนููุถ.

**ุงููุชูุฌุฉ:**

| ุฎุณุงุฑุฉ ุงูุชุฏุฑูุจ | ุญูุจุฉ | ุฎุทูุฉ | ุฎุณุงุฑุฉ ุงูุชุญูู | ูุฑ ุฃูุฑุซู | ููุฑ |
|:-------------:|:-----:|:----:|:---------------:|:---------:|:-------:|
| 0.136         | 1.63  | 500  | 0.1727          | 63.8972   | 14.0661 |

ุชุจูุบ ูุณุจุฉ WER ุงูููุงุฆูุฉ ูุฏููุง 14.1% - ููู ูุณุจุฉ ุฌูุฏุฉ ูุจูุงูุงุช ุชุฏุฑูุจ ูุฏุชูุง ุณุจุน ุณุงุนุงุช ู500 ุฎุทูุฉ ุชุฏุฑูุจ ููุท! ููุฐุง ููุซู ุชุญุณููุง ุจูุณุจุฉ 112% ููุงุฑูุฉ ุจุงููููุฐุฌ ุงูููุฏุฑุจ ูุณุจููุง! ููุฐุง ูุนูู ุฃููุง ูููุง ุจุชุฏุฑูุจ ูููุฐุฌ ูู ููู ูุฏูู ุฃู ูุนุฑูุฉ ุณุงุจูุฉ ุจูุบุฉ ุงูุฏูููููุ ููููุง ุจุถุจุทู ุฏููููุง ููุชุนุฑู ุนูู ุงูููุงู ุจูุบุฉ ุงูุฏููููู ุจุฏูุฉ ูุงููุฉ ูู ุฃูู ูู ุณุงุนุฉ ๐คฏ

ุงูุณุคุงู ุงููุจูุฑ ูู ููู ููุงุฑู ูุฐุง ุจุฃูุธูุฉ ASR ุงูุฃุฎุฑู. ููููุงู ุจุฐููุ ูููููุง ุนุฑุถ ููุญุฉ ุงูููุงุฏุฉ [autoevaluate](https://huggingface.co/spaces/autoevaluate/leaderboards?dataset=mozilla-foundation%2Fcommon_voice_13_0&only_verified=0&task=automatic-speech-recognition&config=dv&split=test&metric=wer)ุ ููู ููุญุฉ ููุงุฏุฉ ุชุตูู ุงูููุงุฐุฌ ุญุณุจ ุงููุบุฉ ููุฌููุนุฉ ุงูุจูุงูุงุชุ ุซู ุชุตูููุง ููููุง ููููุงุณ WER ุงูุฎุงุต ุจูุง.

ุนูุฏ ุงููุธุฑ ุฅูู ููุญุฉ ุงูููุงุฏุฉุ ูุฑู ุฃู ูููุฐุฌูุง ุงูุฐู ุชู ุชุฏุฑูุจู ููุฏุฉ 500 ุฎุทูุฉ ูุชููู ุจุดูู ูููุน ุนูู ููุทุฉ ุชูุชูุด [Whisper Small](https://huggingface.co/openai/whisper-small) ูุณุจูุฉ ุงูุชุฏุฑูุจ ุงูุชู ูููุง ุจุชูููููุง ูู ุงููุณู ุงูุณุงุจู. ุฃุญุณูุช ๐

ููุฑู ุฃู ููุงู ุจุนุถ ููุงุท ุงูุชูุชูุด ุงูุชู ุชุคุฏู ุฃุฏุงุกู ุฃูุถู ูู ุชูู ุงูุชู ูููุง ุจุชุฏุฑูุจูุง. ุฌูุงู Hub Hugging Face ูู ุฃูู ููุตุฉ ุชุนุงูููุฉ - ุฅุฐุง ูู ููู ูุฏููุง ุงูููุช ุฃู ุงูููุงุฑุฏ ููููุงู ุจุชุดุบูู ุชุฏุฑูุจ ุฃุทูู ุจุฃููุณูุงุ ููููููุง ุชุญููู ููุทุฉ ุชูุชูุด ูุงู ุดุฎุต ุขุฎุฑ ูู ุงููุฌุชูุน ุจุชุฏุฑูุจูุง ููุงู ูุทูููุง ุจูุง ูููู ููุดุงุฑูุชูุง (ูุน ุงูุชุฃูุฏ ูู ุดูุฑูู ุนูู ุฐูู!). ุณุชุชููู ูู ุชุญููู ูุฐู ููุงุท ุงูุชูุชูุด ุจููุณ ุงูุทุฑููุฉ ุชูุงููุง ููุง ูู ุงูุญุงู ูุน ููุงุท ุงูุชูุชูุด ูุณุจูุฉ ุงูุชุฏุฑูุจ ุจุงุณุชุฎุฏุงู ูุฆุฉ `pipeline` ููุง ูุนููุง ุณุงุจููุง! ูุฐูู ูุง ุดูุก ูููุนู ูู ุงุฎุชูุงุฑ ุฃูุถู ูููุฐุฌ ูู ููุญุฉ ุงูููุงุฏุฉ ูุงุณุชุฎุฏุงูู ูู ูููุชู!

ูููููุง ุฅุฑุณุงู ููุทุฉ ุงูุชูุชูุด ุงูุฎุงุตุฉ ุจูุง ุชููุงุฆููุง ุฅูู ููุญุฉ ุงูููุงุฏุฉ ุนูุฏ ุฅุฑุณุงู ูุชุงุฆุฌ ุงูุชุฏุฑูุจ ุฅูู Hub - ูู ูุง ุนูููุง ูุนูู ูู ุชุนููู ูุณูุทุงุช ุงููููุงุช ุงูุฑุฆูุณูุฉ (kwargs) ุงูููุงุณุจุฉ. ููููู ุชุบููุฑ ูุฐู ุงูููู ูุชุชูุงุณุจ ูุน ูุฌููุนุฉ ุงูุจูุงูุงุช ูุงููุบุฉ ูุงุณู ุงููููุฐุฌ ุงูุฎุงุต ุจู:

```python
kwargs = {
    "dataset_tags": "mozilla-foundation/common_voice_13_0",
    "dataset": "Common Voice 13",  # a 'pretty' name for the training dataset
    "language": "dv",
    "model_name": "Whisper Small Dv - Sanchit Gandhi",  # a 'pretty' name for your model
    "finetuned_from": "openai/whisper-small",
    "tasks": "automatic-speech-recognition",
}
```

ูููู ุงูุขู ุชุญููู ูุชุงุฆุฌ ุงูุชุฏุฑูุจ ุฅูู Hub. ููููุงู ุจุฐููุ ูู ุจุชูููุฐ ุฃูุฑ `push_to_hub`:

```python
trainer.push_to_hub(**kwargs)
```

ุณูุคุฏู ูุฐุง ุฅูู ุญูุธ ุณุฌูุงุช ุงูุชุฏุฑูุจ ูุฃูุฒุงู ุงููููุฐุฌ ูู `"your-username/the-name-you-picked"`. ุจุงููุณุจุฉ ููุฐุง ุงููุซุงูุ ุฑุงุฌุน ุงูุชุญููู ูู `sanchit-gandhi/whisper-small-dv`.

ูู ุญูู ุฃู ุงููููุฐุฌ ุงูุฏููู ุงูุฏููู ูุนุทู ูุชุงุฆุฌ ูุฑุถูุฉ ุนูู ุจูุงูุงุช ุงุฎุชุจุงุฑ Dhivehi Common Voice 13ุ ุฅูุง ุฃูู ููุณ ูุซุงูููุง ุจุฃู ุญุงู ูู ุงูุฃุญูุงู. ุงูุบุฑุถ ูู ูุฐุง ุงูุฏููู ูู ุชูุถูุญ ููููุฉ ุถุจุท ูููุฐุฌ ASR ุฏููู ุจุงุณุชุฎุฏุงู ๐ค Trainer ููุชุนุฑู ุนูู ุงูููุงู ูุชุนุฏุฏ ุงููุบุงุช.

ุฅุฐุง ูุงู ูุฏูู ุฅููุงููุฉ ุงููุตูู ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจู ุฃู ููุช ูุดุชุฑููุง ูู ุฎุทุฉ Google Colab ูุฏููุนุฉ ุงูุฃุฌุฑุ ูููููู ุฒูุงุฏุฉ `max_steps` ุฅูู 4000 ุฎุทูุฉ ูุชุญุณูู WER ุฃูุซุฑ ุนู ุทุฑูู ุงูุชุฏุฑูุจ ุนูู ุงููุฒูุฏ ูู ุงูุฎุทูุงุช. ุณูุณุชุบุฑู ุงูุชุฏุฑูุจ ููุฏุฉ 4000 ุฎุทูุฉ ุญูุงูู 3-5 ุณุงุนุงุช ุงุนุชูุงุฏูุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงูุฎุงุตุฉ ุจู ูุณูุคุฏู ุฅูู ูุชุงุฆุฌ WER ุฃูู ุจุญูุงูู 3% ูู ุงูุชุฏุฑูุจ ููุฏุฉ 500 ุฎุทูุฉ. ุฅุฐุง ูุฑุฑุช ุงูุชุฏุฑูุจ ููุฏุฉ 4000 ุฎุทูุฉุ ููุญู ููุตู ุฃูุถูุง ุจุชุบููุฑ ุฌุฏูู ูุนุฏู ุงูุชุนูู ุฅูู ุฌุฏูู *ุฎุทู* (ูู ุจุชุนููู `lr_scheduler_type="linear"`)ุ ุญูุซ ุณูููุฑ ุฐูู ุชุนุฒูุฒูุง ุฅุถุงูููุง ููุฃุฏุงุก ุนูู ูุฏุงุฑ ุนูููุงุช ุงูุชุฏุฑูุจ ุงูุทูููุฉ.

ูู ุงููุญุชูู ุฃู ุชุชุญุณู ุงููุชุงุฆุฌ ุฃูุซุฑ ุนู ุทุฑูู ุชุญุณูู ูุนููุงุช ุงูุชุฏุฑูุจุ ูุซู _ูุนุฏู ุงูุชุนูู_ ู _ุงูุชุฎููุถ_ุ ูุงุณุชุฎุฏุงู ููุทุฉ ุชูุชูุด ูุณุจูุฉ ุงูุชุฏุฑูุจ ุฃูุจุฑ (`medium` ุฃู `large`). ูุชุฑู ูุฐุง ูุชูุฑูู ูููุงุฑุฆ.

## ูุดุงุฑูุฉ ูููุฐุฌู
ููููู ุงูุขู ูุดุงุฑูุฉ ูุฐุง ุงููููุฐุฌ ูุน ุฃู ุดุฎุต ุจุงุณุชุฎุฏุงู ุงูุฑุงุจุท ุนูู Hub. ูููููู ุชุญูููู ุจุงุณุชุฎุฏุงู ุงููุนุฑู `"your-username/the-name-you-picked"` ูุจุงุดุฑุฉู ูู ูุงุฆู `pipeline()`. ุนูู ุณุจูู ุงููุซุงูุ ูุชุญููู ููุทุฉ ุงูุชูุชูุด ุงูุฏูููุฉ ["sanchit-gandhi/whisper-small-dv"](https://huggingface.co/sanchit-gandhi/whisper-small-dv):

```python
from transformers import pipeline

pipe = pipeline("automatic-speech-recognition", model="sanchit-gandhi/whisper-small-dv")
```
## ุฎุงุชูุฉ

ูู ูุฐุง ุงููุณูุ ูููุง ุจุชุบุทูุฉ ุฏููู ุฎุทูุฉ ุจุฎุทูุฉ ุญูู ุงูุถุจุท ุงูุฏููู ููููุฐุฌ Whisper ููุชุนุฑู ุนูู ุงูููุงู ๐ค Datasets ู Transformers ู Hugging Face Hub. ุฃููุงูุ ูููุง ุจุชุญููู ุงูุฌุฒุก ุงููุฑุนู Dhivehi ูู ูุฌููุนุฉ ุงูุจูุงูุงุช Common Voice 13 ููููุง ุจูุนุงูุฌุชู ูุณุจููุง ุนู ุทุฑูู ุญุณุงุจ ูุฎุทุทุงุช log-mel ูtokenising ุงููุต. ุจุนุฏ ุฐููุ ูููุง ุจุชุญุฏูุฏ ุฃุฏุงุฉ ุชุฌููุน ุงูุจูุงูุงุช ูููุงููุณ ุงูุชูููู ูุญุฌุฌ ุงูุชุฏุฑูุจุ ูุจู ุงุณุชุฎุฏุงู ๐ค Trainer ูุชุฏุฑูุจ ูุชูููู ูููุฐุฌูุง. ูุฃุฎูุฑูุงุ ูููุง ุจุชุญููู ุงููููุฐุฌ ุงููุถุจูุท ุจุฏูุฉ ุฅูู Hugging Face Hubุ ูุดุฑุญูุง ููููุฉ ูุดุงุฑูุชู ูุงุณุชุฎุฏุงูู ูุน ูุฆุฉ `pipeline()`.

ุฅุฐุง ุชุงุจุนุช ุญุชู ูุฐู ุงูููุทุฉุ ููุฌุจ ุฃู ูููู ูุฏูู ุงูุขู ููุทุฉ ุชูุชูุด ูุถุจูุทุฉ ุจุฏูุฉ ููุชุนุฑู ุนูู ุงูููุงูุ ุชูุงูููุง! ๐ฅณ ูุงูุฃูู ูู ุฐููุ ุฃูู ูุฌูุฒ ุจุฌููุน ุงูุฃุฏูุงุช ุงูุชู ุชุญุชุงุฌูุง ูุถุจุท ูููุฐุฌ Whisper ุจุฏูุฉ ุนูู ุฃู ูุฌููุนุฉ ุจูุงูุงุช ุฃู ูุฌุงู ููุชุนุฑู ุนูู ุงูููุงู. ูุฐุงุ ูุง ุงูุฐู ุชูุชุธุฑู! ุงุฎุชุฑ ูุงุญุฏุฉ ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงููุดูููุฉ ูู ุงููุณู [ุงุฎุชูุงุฑ ูุฌููุนุฉ ุจูุงูุงุช](choosing_dataset) ุฃู ุญุฏุฏ ูุฌููุนุฉ ุจูุงูุงุช ุฎุงุตุฉ ุจูุ ูุชุญูู ููุง ุฅุฐุง ูุงู ุจุฅููุงูู ุชุญููู ุฃุฏุงุก ุฃูุถู ูู ุฃุฏุงุก ุงูููุงุฐุฌ ุงูุญุงููุฉ! ุฅู ููุญุฉ ุงูููุงุฏุฉ ุจุงูุชุธุงุฑู...