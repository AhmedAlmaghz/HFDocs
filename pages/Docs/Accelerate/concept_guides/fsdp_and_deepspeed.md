# ุงูุงูุชูุงู ุจูู FSDP ู DeepSpeed

ูููุฑ ๐ค Accelerate ูุฑููุฉ ูู ุฃุทุฑ ุงูุชุฏุฑูุจุ ูู ุฎูุงู ุฏูุฌ ุฃุฏุงุชูู ูููุชูู ููุบุงูุฉ ููุชุฏุฑูุจ ุงูููุฒุนุ ูููุง [Pytorch FSDP](../usage_guides/fsdp) ู [Microsoft DeepSpeed](../usage_guides/deepspeed). ูููุฏู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุฅูู ุฑุณู ุฃูุฌู ุงูุชุดุงุจูุ ููุฐูู ุชูุถูุญ ุงูุงุฎุชูุงูุงุช ุงููุญุชููุฉุ ูุชูููู ุงููุณุชุฎุฏู ูู ุงูุชุจุฏูู ุจุณูุงุณุฉ ุจูู ูุฐูู ุงูุฅุทุงุฑูู.

<Tip>

ููุชุจุฏูู ุจูู ุงูุฃุทุฑุ ููุตู ุจุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ๐ค `accelerate launch` ูุน ุชูุฑูุฑ ููู ุงูุชูููู ุงูุตุญูุญ ุจุงุณุชุฎุฏุงู `--config_file`ุ ุฃู ุชูุฑูุฑ ุงูุญุฌุฌ ุงูููุงุจูุฉ ูุจุงุดุฑุฉ ูู [FSDP ู DeepSpeed](../package_reference/cli#accelerate-launch).

ูููู ุงูุนุซูุฑ ุนูู ุฃูุซูุฉ ูุชููููุงุช ๐ค Accelerate ููุง ูู [DeepSpeed](../usage_guides/deepspeed#accelerate-deepspeed-plugin) ู [FSDP](../usage_guides/fsdp#how-it-works-out-of-the-box)ุ ุฃู ูู [ูุซุงู Zoo ุชุญุช "ุชููููุงุช ุงูุฅุทูุงู"](../usage_guides/explore)

</Tip>

<Tip warning={true}>

ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ูุฎุตุต ูุณููุงุฑูููุงุช ุงูุนูุฏุฉ ุงููุงุญุฏุฉุ ูุชุนุฏุฏุฉ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ููุท.

</Tip>

## ุชูููู ุงููุธุงุฆู

ูุชู ุชูุณูู ุชูุณูุฑุงุช ุงููููุฐุฌ ุฅูู ูุญุฏุงุช ูุนุงูุฌุฉ ุฑุณููุงุช (GPU) ูุฎุชููุฉ ูู ูุญุงููุฉ ูุฒูุงุฏุฉ ุฃุญุฌุงู ุงูููุงุฐุฌุ ููุทูู ุนูู ุฐูู *sharding* ูู FSDPุ ู *partitioning* ูู DeepSpeed. ูุชู ุชูููู ูุฑุงุญู FSDP sharding ู DeepSpeed ZeRO (ุงูุชูุณูู) ุจูุงุณุทุฉ `--fsdp_sharding_strategy`ุ ู `--zero_stage`ุ ุนูู ุงูุชูุงูู. ุนูู ูุฌู ุงูุฎุตูุตุ ูุชูุงูู FSDP `FULL_SHARD` ูุน DeepSpeed ZeRO stage `3`ุ ุฑุงุฌุน ูุฐุง [ุงูุฑุณู ุงูุจูุงูู ุงูุดุงูู ุจูู ุงุณุชุฑุงุชูุฌูุงุช FSDP sharding ูุฅุนุฏุงุฏุงุช DeepSpeed ZeRO](../usage_guides/fsdp#mapping-between-fsdp-sharding-strategies-and-deepspeed-zero-stages). ููุฎุต ุงูุฌุฏูู ุฃุฏูุงู ููุตูู ุงูุฅุนุฏุงุฏุงุช ุงููุชุดุงุจูุฉ:

ุงููุฌููุนุฉ | ุงูุฅุทุงุฑ | ุงูุชูููู | ูุซุงู | ุงููููุฏ (ุฅู ูุฌุฏุช)
--|--|--|--|--
ุงูุชูุณูู / ุงูุชุฌุฒุฆุฉ | FSDP<br>DeepSpeed | `--fsdp_sharding_strategy`<br>`--zero_stage` | `1` (`FULL_SHARD`) <br>`3` |
ุงูุชุญููู ูู ุงูุฐุงูุฑุฉ | FSDP<br>DeepSpeed | `--fsdp_offload_params`<br>`--offload_param_device`<br>`--offload_optimizer_device` | `true`<br>`cpu`<br>`cpu` | ุงููู ุฃู ูุง ุดูุก <br><br>
ุชุญููู ุงููููุฐุฌ | FSDP<br>DeepSpeed | <span style="white-space:nowrap;">`--fsdp_cpu_ram_efficient_loading`</span><br>`--zero3_init_flag` | `true`<br>`true` | <br>Zero 3 ููุท
ุงูููุทุฉ ุงููุฑุฌุนูุฉ ุงููุนุงูุฉ | FSDP<br>DeepSpeed | `--fsdp_state_dict_type`<br>`--zero3_save_16bit_model` |  `SHARDED_STATE_DICT`<br>`true` |  <br>Zero 3 ููุท
ุงุณุชุฑุฏุงุฏ ุงูุฃูุฒุงู ูุณุจููุง | FSDP<br><br>DeepSpeed | `--fsdp_forward_prefetch`<br>`--fsdp_backward_prefetch`<br>None | `true`<br>`BACKWARD_PRE` | <br><br>
ุงููููุฐุฌ | FSDP<br><br>DeepSpeed |  `--fsdp_auto_wrap_policy`<br><span style="white-space:nowrap;">`--fsdp_transformer_layer_cls_to_wrap`</span><br>None | `TRANSFORMER_BASED_WRAP`<br><Layer Class> |<br>ุนุงุฏุฉ ูุง ูุง ุชููู ููุงู ุญุงุฌุฉ <br>ุดูุงูุฉ ูููุณุชุฎุฏู.
ุงุณุชุฏุนุงุก ุงููุนููุงุช | FSDP<br>DeepSpeed | `--fsdp_use_orig_params`<br>None | `true` | ูุทููุจ ูู `torch.compile`<br>ุดูุงูุฉ ูููุณุชุฎุฏู
ูุฒุงููุฉ ุงููุนููุงุช | FSDP<br>DeepSpeed | `--fsd-p_sync_module_states`<br>None | `true` |
ุงูุชุฏุฑูุจ | FSDP<br>DeepSpeed | None<br>`--gradient_accumulation_steps`<br>`--gradient_clipping` | <br>`auto`<br>`auto` | ุดูุงูุฉ ูููุณุชุฎุฏู

ููุงุทูุงุน ุนูู ุฃูุตุงู ููุตูุฉ ููุง ุณุจูุ ุฑุงุฌุน [๐ค ูุซุงุฆู ุฅุทูุงู `Accelerate`](../package_reference/cli#accelerate-launch).

<Tip>

ูููุตูู ุฅูู ุชููููุงุช DeepSpeed ุงูุฃุฎุฑูุ ูุซู ุฅุนุฏุงุฏุงุช ุงูุฏูุฉ ุงููุฎุชูุทุฉุ ูุฌุจ ุชูุฑูุฑ ููู ุชูููู DeepSpeed ุจุงุณุชุฎุฏุงู `--deepspeed_config_file`ุ ุฑุงุฌุน [ุงููุซุงุฆู](../usage_guides/deepspeed#deepspeed-config-file).

ูููู ุฃูุถูุง ุชูููู DeepSpeed ุนุจุฑ [`DeepSpeedPlugin`]ุ ุนูู ุณุจูู ุงููุซุงูุ `DeepSpeedPlugin.zero_stage` ูุนุงุฏู `--zero_stage`ุ ููููู ุงุณุชุฎุฏุงู `DeepSpeedPlugin.hf_ds_config` ูุชูุฑูุฑ `--deepeed_config_file.`

</Tip>

<Tip>

ูููู ุฃูุถูุง ุชูููู FSDP ุนุจุฑ [`FullyShardedDataParallelPlugin`]ุ ุนูู ุณุจูู ุงููุซุงูุ `FullyShardedDataParallelPlugin.sharding_strategy` ูุนุงุฏู `--fsdp_sharding_strategy`.

</Tip>

### ููุงุท ุงููุฑุงูุจุฉ

ูุงุญุธ ุฃูู ูู ุญูู ูููู ุชูููู FSDP ุนุจุฑ `--fsdp_state_dict_type` ูุญูุธ ููุงุท ุงููุฑุงูุจุฉ ุงููุงููุฉ / ุงููุฌุฒุฃุฉ.

<Tip>

ุจุงููุณุจุฉ ูู DeepSpeed Zero3ุ ููููู ุชูุฑูุฑ `--zero3_save_16bit_model true`ุ ูุงูุฐู ูููู ุจุชูุญูุฏ ุงููููุฐุฌ ุจุดูู ููุงุณุจ ูู ุชุฑุชูุจ ูุงุญุฏ ูุญูุธูุ ูุฐุง ูุนุงุฏู FSDP ูู `fsdp_state_dict_type: FULL_STATE_DICT`.

</Tip>

<Tip warning={true}>

ุจุงููุณุจุฉ ููููุงุฐุฌ ุงููุจูุฑุฉุ ูุฏ ูููู ุชูุญูุฏ ุงููููุฐุฌ ุฅูู ุชุฑุชูุจ ูุงุญุฏ ุจุทูุฆูุง ุฌุฏูุง.

</Tip>

<Tip>

ููุญุตูู ุนูู ููุงุท ูุฑุฌุนูุฉ ุฃุณุฑุนุ ุงุณุชุฎุฏู FSDP `fsdp_state_dict_type: SHARDED_STATE_DICT`ุ ูุจุงููุณุจุฉ ูู DeepSpeed Zero3 [ุงุณุชุฎุฏู ูุต ุงูุจุฑูุงูุฌ ุงููุตู `zero_to_fp32.py` ูุชุญููู ููุงุท ุงููุฑุงูุจุฉ ุงููุฌุฒุฃุฉ](https://www.deepspeed.ai/tutorials/zero/#extracting-weights).

</Tip>

### ุงูุชุญููู ูู ุงูุฐุงูุฑุฉ

ูุณูุญ FSDP ููุท ุจุงูุชุญููู ูู ุงูุฐุงูุฑุฉ *all-or-nothing* (ุฃู ุฅูุง ุชุญููู ุงููุนููุงุช ูุงููุฏุฑุจุ ุฃู ุงูุงุญุชูุงุธ ุจูุง ุฌููุนูุง ูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU))ุ ูููู ูููู ูู DeepSpeed ุชุญููู ุงููุนููุงุช ูุงููุฏุฑุจ ุจุดูู ูุฎุชูู. ุนูุงูุฉ ุนูู ุฐููุ ูุฏุนู DeepSpeed ุฃูุถูุง [ุงูุชุญููู ูู ุงูุฐุงูุฑุฉ ุฅูู NVME](https://www.deepspeed.ai/docs/config-json/#parameter-offloading).

### ุงูุงุณุชุฑุฏุงุฏ ุงููุณุจู

ูุณูุญ FSDP ุจุชูููู ุงุณุชุฑุฏุงุฏ ูุณุจู ููุงุณุชุฑุฏุงุฏ ุงููุณุจู `--fsdp_forward_prefetch` ู `--fsdp_backward_prefetch` ูุชุญุณูู ุชุฏุงุฎู ุงูุงุชุตุงูุงุช / ุงูุญุณุงุจุงุช ุนูู ุญุณุงุจ ุงูุฐุงูุฑุฉ ุงูุฅุถุงููุฉุ ุฑุงุฌุน [ูุซุงุฆู FSDP](https://pytorch.org/docs/stable/fsdp.html).

ุจุงููุณุจุฉ ูู DeepSpeedุ ุณูุชู ุชุดุบูู ุงูุงุณุชุฑุฏุงุฏ ุงููุณุจู ุนูุฏ ุงูุญุงุฌุฉุ ููุชู ุชุดุบููู ุจูุงุกู ุนูู ุจุนุถ ุงููุนููุงุช ูุงุฆูุฉ ุงูุฏูุฉ ูุซู `stage3_param_persistence_threshold`ุ `stage3_max_reuse_distance`ุ ุฅูุฎุ [ุงูุชู ูููู ุชูููููุง ูู Zero3](https://www.deepspeed.ai/docs/config-json/#parameter-offloading)ุ ูุฏ ูููู ๐ค `accelerate` ุจุชุนููู ูุฐู ุงููุนููุงุช ูุงุฆูุฉ ุงูุฏูุฉ ุชููุงุฆููุง ุฅุฐุง ูู ุชูู ุจุชุนููููุง ุตุฑุงุญุฉู ูู ููู ุชูููู DeepSpeed.

<Tip>

ุจุงููุณุจุฉ ูู FSDPุ ูู ุจุชุนููู `fsdp_backward_prefetch: BACKWARD_PRE` ูุชุญุณูู ุงูุฅูุชุงุฌูุฉ ุฅุฐุง ุณูุญุช ุงูุฐุงูุฑุฉ.

</Tip>

### ุชุญููู ุงููููุฐุฌ

ูู ุญูู ุฃู FSDP ูุชุทูุจ `--fsdp_cpu_ram_efficient_loading true` ูุชูุดูุท ุชุญููู ุงููููุฐุฌ ุงููุนุงูุ ุณูููู ๐ค `transformers` ุจุชูุดูุท ููุฒุฉ ููุงุซูุฉ ูููุง ุชู ุงุณุชุฎุฏุงู DeepSpeed Zero3.

<Tip>

ุจุงููุณุจุฉ ูู FSDPุ ุนูุฏูุง ุชููู ุจุชุนููู `--fsdp_cpu_ram_efficient_loading true`ุ ุณูููู ๐ค `accelerate` ุชููุงุฆููุง ุจุชุนููู `sync_module_states` ุฅูู true.

ุจุงููุณุจุฉ ูุชุญููู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู (RAM) ุงููุนุงูุ ุณูุชู ุชุญููู ุงูุฃูุฒุงู ููุท ูู ุชุฑุชูุจ ูุงุญุฏุ ูุจุงูุชุงูู ูุชุทูุจ `sync_module_states` ูุจุซ ุงูุฃูุฒุงู ุฅูู ุงูุชุฑุชูุจุงุช ุงูุฃุฎุฑู.

</Tip>

### ุงููููุฐุฌ

ูุชุทูุจ FSDP `--fsdp_auto_wrap_policy` ุตุฑูุญูุง ุญุชู ูุชููู ุงูุฎูุงุฑุฒููุฉ ูู ุชุญุฏูุฏ ููููุฉ ุฌุฏููุฉ ุนูููุงุช all-gather ู reduce-scatter. ูููู ุจุงููุณุจุฉ ูู DeepSpeedุ ูููู ุฐูู ุดูุงููุง ูููุณุชุฎุฏู.

<Tip>

ุจุงููุณุจุฉ ูู FSDPุ ูู ุจุจุณุงุทุฉ ุจุชุนููู `fsdp_auto_wrap_policy: TRANSFORMER_BASED_WRAP`. ุจุงุณุชุฎุฏุงู ุฃุญุฏุซ ุฅุตุฏุงุฑุงุช [`transformers`]ุ ูุจุฐู ูุตุงุฑู ุฌูุฏูุง ููุนุฑูุฉ ูุฆุฉ ุงูุทุจูุฉ ุงูููุงุณุจุฉ ูู HF transformers models. ููุน ุฐููุ ุฅุฐุง ุชูููุช ุฎุทุฃู ุจุฎุตูุต ุฐููุ ูุฑุฌู ุชุญุฏูุฏู.

</Tip>

### ุงุณุชุฏุนุงุก ุงููุนููุงุช

ูุชุทูุจ FSDP ุนูููุง ุตุฑูุญูุง `--fsdp_use_orig_params` ุฅุฐุง ููุช ุชุณุชุฎุฏู `torch.compile`ุ ุฑุงุฌุน [ูุซุงุฆู PyTorch](https://pytorch.org/docs/stable/fsdp.html#module-torch.distributed.fsdp). ุจุงููุณุจุฉ ูู DeepSpeedุ ูููู ุฐูู ุดูุงููุง ูููุณุชุฎุฏู.

<Tip>

ุจุงููุณุจุฉ ูู FSDPุ ุนูุฏ ุงุณุชุฎุฏุงู `torch.compile`ุ ูุฑุฌู ุชุนููู `fsdp_use_orig_params: True`.

</Tip>

## ุงูุชุฏุฑูุจ

ูุชุทูุจ Deepspeed ุฃุนูุงู `--gradient_accumulation_steps` ู `--gradient_clipping` ุตุฑูุญุฉ. ุจุงููุณุจุฉ ูู FSDPุ ูููู ุฐูู ุดูุงููุง ูููุณุชุฎุฏู.

<Tip>

ุนูุฏ ุงุณุชุฎุฏุงู DeepSpeedุ ูู ุจุชุนููู `gradient_accumulation_steps: "auto"` ู `gradient_clipping: "auto"` ูุงุฎุชูุงุฑ ุงูููู ุงูุชู ุชู ุชุนููููุง ุชููุงุฆููุง ูู [`Accelerator`] ุฃู [`TrainingArguments`] (ุฅุฐุง ููุช ุชุณุชุฎุฏู `transformers`).

</Tip>

## ุงูุงุฎุชูุงูุงุช ูู ุงูุชุนุงูู ูุน ุฏูุฉ ุงูุจูุงูุงุช

ููุชุญุฏุซ ุนู ููููุฉ ุงูุชุนุงูู ูุน ุฏูุฉ ุงูุจูุงูุงุช ูู ูู ูู FSDP ู Deepspeedุ ูู ุงููููุฏ ุฃููุงู ุฅุนุทุงุก ูุธุฑุฉ ุนุงูุฉ ุญูู ููููุฉ ุงูุชุนุงูู ูุน ูุนููุงุช ุงููููุฐุฌ ูู ูุฐู ุงูุฃุทุฑ. ูุจู ุชูุฒูุน ูุนููุงุช ุงููููุฐุฌ / ุงููุฏุฑุจ ุนุจุฑ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU)ุ ุชููู ููุงู ุนูููุฉ ุฅุนุฏุงุฏ ุงููุนููุงุช ูุฅูุดุงุก "ูุนููุงุช ูุณุทุญุฉ" ุฃููุงู ูู ุชูุณูุฑ ุฃุญุงุฏู ุงูุจุนุฏ [`torch.Tensor`](https://pytorch.org/docs/stable/tensors.html#torch-tensor). ูุฎุชูู ุชูููุฐ FSDP / DeepSpeed ูู ูุง ูุชุนูู ุจู `dtype` ุงูุฐู ูุชู ููู ุชุฎุฒูู ูุฐู ุงููุนููุงุช "ุงููุณุทุญุฉ"ุ ูููุงู ุนูุงูุจ ูููุง ูุชุนูู ุจููููุฉ ุชุฎุตูุต [`torch.Optimizer`](https://pytorch.org/docs/stable/optim.html#module-torch.optim) `dtype`s ุงูุฎุงุตุฉ ุจูู. ููุฎุต ุงูุฌุฏูู ุฃุฏูุงู ุงูุนูููุงุช ูููุง ุงูุฅุทุงุฑููุ ูุดูุฑ ุนููุฏ "ุงููุญูู" ุฅูู ุงูุนูููุฉ ุงูุชู ุชุญุฏุซ ุนูู ูุณุชูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงููุฑุฏูุฉุ ูุฐูู ูุฌุจ ููู ุฃู ูููุงุช ุนุงูุฉ ููุฐุงูุฑุฉ ุจุณุจุจ upcasting ูู ุฎูุงู ุนุฏุฏ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุงููุณุชุฎุฏูุฉ.

<Tip>

ููุงุนุฏุฉ ุนุงูุฉุ ุจุงููุณุจุฉ ููุชุฏุฑูุจ ุงููุณุชูุฑ ุจุงุณุชุฎุฏุงู ุงูุฏูุฉ ุงููุฎุชูุทุฉ ุงูุชููุงุฆูุฉุ ูุฌุจ ุฃู ุชููู ุฌููุน ุงููุนููุงุช ุงููุงุจูุฉ ููุชุฏุฑูุจ ูู `torch.float32`.

</Tip>

ุงูุนูููุฉ | ุงููุญูู | ุงูุฅุทุงุฑ | ุงูุชูุงุตูู
--|--|--|--
ุงูุชุญูููุ ุฃู [`AutoModel.from_pretrained(..., torch_dtype=torch_dtype)`] |
ุงูุฅุนุฏุงุฏุ ุฃู ุฅูุดุงุก "ูุนููุงุช ูุณุทุญุฉ" | โ | FSDP<br>DeepSpeed | ุชู ุฅูุดุงุคู ูู `torch_dtype`.<br> ุชุฌุงูู `torch_dtype`ุ ุชู ุฅูุดุงุคู ูู `float32`.
ุชููุฆุฉ ุงููุฏุฑุจ | โ | FSDP<br>DeepSpeed  | ุฅูุดุงุก ุงููุนููุงุช ูู `torch_dtype`<br> ุฅูุดุงุก ุงููุนููุงุช ูู `float32`
ุฎุทูุฉ ุงูุชุฏุฑูุจุ ุฃูุ ุฅูู ุงูุฃูุงูุ ุฅูู ุงูุฎููุ ุงูุชุฎููุถ | | FSDP<br>DeepSpeed  | ุงุชุจุน [`MixedPrecision`](https://pytorch.org/docs/stable/fsdp.html#torch.distributed.fsdp.MixedPrecision)<br> ุงุชุจุน ุฅุนุฏุงุฏุงุช ุงูุฏูุฉ ุงููุฎุชูุทุฉ ูู ููู ุชูููู DeepSpeed.
ุงููุฏุฑุจ (ูุง ูุจู ุงูุฎุทูุฉ) | โ | FSDP<br>DeepSpeed | upcasting (ุฅู ูุฌุฏ) ุฅูู `torch_dtype`<br> ุชู upcast ุฅูู `float32`
ุงููุฏุฑุจ (ุงูุฎุทูุฉ ุงููุนููุฉ) | โ | FSDP<br>DeepSpeed  | ูุญุฏุซ ูู `torch_dtype` <br> ูุญุฏุซ ูู `float32`.
<Tip warning={true}>

ูุฐูู ุนูุฏ ุงุณุชุฎุฏุงู DeepSpeed ุจุนุฏุฏ ุตุบูุฑ ูู ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU)ุ ูู ุนูู ุฏุฑุงูุฉ ุจุงุญุชูุงููุฉ ูุฌูุฏ ูููุงุช ุนุงูุฉ ูุจูุฑุฉ ููุฐุงูุฑุฉ ุจุณุจุจ upcasting ุฃุซูุงุก ุงูุฅุนุฏุงุฏ.

</Tip>

<Tip>

ูุน FSDPุ ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุฏูุฉ ูุฎุชูุทุฉุ ูู ุงููููู ุชุดุบูู [`torch.Optimizer`](https://pytorch.org/docs/stable/optim.html#module-torch.optim) ูู ุฏูุฉ ููุฎูุถุฉ `torch_dtype`ุ ูุงูุชู ูุฏ ุชููู ูููุฏุฉ ุนูุฏ ุงุณุชุฎุฏุงู ุนุฏุฏ ุตุบูุฑ ูู ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU).

</Tip>

<Tip warning={true}>

ูุน ุงูุฏูุฉ ุงููุฎุชูุทุฉุ ุณูููู ูู ูู FSDP ู DeepSpeed ุจุงูุชุญููู ุฅูู ุฏูุฉ ุฃุนูู ูู ุฎุทูุฉ ุฅุนุฏุงุฏ ุงููููุฐุฌ (ุฑุงุฌุน ุงูุฌุฏูู ุฃุนูุงู). ูููู ูุงุญุธ ุฃู FSDP ุณูููู ุจุนุฏ ุฐูู ุจุญูุธ ููุงุท ุงููุฑุงูุจุฉ ูู ุงูุฏูุฉ ุงูุฃุนููุ ูุฏ ูููู Deepspeed ุฃูุถูุง ุจุญูุธ ููุงุท ุงููุฑุงูุจุฉ ููุฎูุถุฉ ุงูุฏูุฉ ุฅุฐุง ุชู ุชุญุฏูุฏ `--zero3_save_16bit_model`.

</Tip>

ูุชูุถูุญ ุงูุฌุฏูู ุฃุนูุงูุ ุถุน ูู ุงุนุชุจุงุฑู ุงูุฃูุซูุฉ ุงูููููุณุฉ ุฃุฏูุงูุ ุชู ุฏูุฌ ุฎุทูุฉ ุงููุฏุฑุจ ุงููุนููุฉ ูุฎุทูุฉ ูุง ูุจู ุงููุฏุฑุจ ููุงุฎุชุตุงุฑ. ูุน FSDPุ ูู ุงููููู ุงูุนูู ูู ุงููุถุนูู ุงูููุถุญูู ุฃุฏูุงูุ ูููู ูููู ูู DeepSpeed ุงูุนูู ูู ูุถุน ูุงุญุฏ ููุท.

ุงูุฅุทุงุฑ | ุชุญููู ุงููููุฐุฌ (`torch_dtype`) | ุงูุฏูุฉ ุงููุฎุชูุทุฉ | ุงูุฅุนุฏุงุฏ (ุงููุญูู) | ุงูุชุฏุฑูุจ | ุงููุฏุฑุจ (ุงููุญูู)
--|--|--|--|--|--
FSDP | bf16 | ุงูุงูุชุฑุงุถู (ูุง ุดูุก) | bf16 | bf16 | bf16
FSDP | bf16 | bf16 | fp32 | bf16 | fp32
DeepSpeed | bf16 | bf16 | fp32 | bf16 | fp32