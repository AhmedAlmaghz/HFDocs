# DeepSpeed

ูููุฐ DeepSpeed ูู ูุง ูู ููุตูู ูู ูุฑูุฉ ZeRO. ุจุนุถ ุงูุชุญุณููุงุช ุงูููุญูุธุฉ ูู:

1. ุชุฌุฒุฆุฉ ุญุงูุฉ ุงููุญุณู (ุงููุฑุญูุฉ ุงูุฃููู ูู ZeRO)
2. ุชุฌุฒุฆุฉ ุงูุชุฏุฑุฌ (ุงููุฑุญูุฉ ุงูุซุงููุฉ ูู ZeRO)
3. ุชุฌุฒุฆุฉ ุงููุนููุงุช (ุงููุฑุญูุฉ ุงูุซุงูุซุฉ ูู ZeRO)
4. ุงูุชุนุงูู ูุน ุงูุชุฏุฑูุจ ุนูู ุงูุฏูุฉ ุงููุฎุชูุทุฉ ุงููุฎุตุตุฉ
5. ูุฌููุนุฉ ูู ุงููุญุณูุงุช ุงูุณุฑูุนุฉ ุงููุณุชูุฏุฉ ุฅูู ุงูุชุฏุงุฏ CUDA
6. ZeRO-Offload ุฅูู CPU ูุงููุฑุต/NVMe
7. ุงูุชุฌุฒุฆุฉ ุงููุฑููุฉ ููุนููุงุช ุงููููุฐุฌ (ZeRO++)

ูุฏู ZeRO-Offload ูุฑูุชู ุงูุฎุงุตุฉ: [ZeRO-Offload: Democratizing Billion-Scale Model Training](https://arxiv.org/abs/2101.06840). ููุชู ูุตู ุฏุนู NVMe ูู ุงููุฑูุฉ [ZeRO-Infinity: Breaking the GPU Memory Wall for Extreme Scale Deep Learning](https://arxiv.org/abs/2104.07857).

ูุณุชุฎุฏู DeepSpeed ZeRO-2 ุจุดูู ุฃุณุงุณู ููุชุฏุฑูุจ ููุทุ ุญูุซ ุฃู ููุฒุงุชู ูุง ุชููุฏ ุงูุงุณุชุฏูุงู.

ูููู ุงุณุชุฎุฏุงู DeepSpeed ZeRO-3 ููุงุณุชุฏูุงู ุฃูุถูุง ูุฃูู ูุณูุญ ุจุชุญููู ููุงุฐุฌ ุถุฎูุฉ ุนูู ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ูุชุนุฏุฏุฉุ ููู ูุง ูู ูููู ูููููุง ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ูุงุญุฏุฉ.

ูุฏูุฌ ๐ค Accelerate [DeepSpeed](https://github.com/microsoft/DeepSpeed) ุนุจุฑ ุฎูุงุฑูู:

1. ุฏูุฌ ููุฒุงุช DeepSpeed ุนุจุฑ ููุงุตูุงุช `deepspeed config file` ูู `accelerate config`. ูุง ุนููู ุณูู ุชูููุฑ ููู ุงูุชูููู ุงููุฎุตุต ุงูุฎุงุต ุจู ุฃู ุงุณุชุฎุฏุงู ุงููุงูุจ ุงูุฎุงุต ุจูุง. ูุฑูุฒ ูุนุธู ูุฐู ุงููุซููุฉ ุนูู ูุฐู ุงูููุฒุฉ. ูุฏุนู ูุฐุง ุฌููุน ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ ูู DeepSpeed ููููุญ ุงููุณุชุฎุฏู ุงููุซูุฑ ูู ุงููุฑููุฉ. ูุฏ ูุถุทุฑ ุงููุณุชุฎุฏู ุฅูู ุชุบููุฑ ุจุถุน ุณุทูุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงุนุชูุงุฏูุง ุนูู ุงูุชูููู.
2. ุงูุชูุงูู ุนุจุฑ `deepspeed_plugin`. ูุฏุนู ูุฐุง ุฌุฒุกูุง ูุฑุนููุง ูู ููุฒุงุช DeepSpeed ููุณุชุฎุฏู ุงูุฎูุงุฑุงุช ุงูุงูุชุฑุงุถูุฉ ูุจููุฉ ุงูุชููููุงุช. ูุง ูุญุชุงุฌ ุงููุณุชุฎุฏู ุฅูู ุชุบููุฑ ุฃู ุฑูุฒ ููู ุฌูุฏ ููู ูุฑุถูู ุนู ูุนุธู ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ูู DeepSpeed.

## ูุง ูู ุงููุฏูุฌุ

ุงูุชุฏุฑูุจ:

1. ูุฏูุฌ ๐ค Accelerate ุฌููุน ููุฒุงุช DeepSpeed ZeRO. ููุดูู ุฐูู ุฌููุน ูุฑุงุญู ZeRO 1 ู2 ู3 ุจุงูุฅุถุงูุฉ ุฅูู ZeRO-Offload ูZeRO-Infinity (ุงูุชู ูููููุง ุชูุฑูุบ ุงููุฑุต/NVMe) ูZeRO++. ูููุง ููู ูุตู ูุตูุฑ ูุชูุงุฒู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ZeRO - Zero Redundancy Optimizer ุฅูู ุฌุงูุจ ุฑุณู ุจูุงูู ูู ูุฐู [ุงูุชุฏูููุฉ](https://www.microsoft.com/en-us/research/blog/zero-deepspeed-new-system-optimizations-enable-training-models-with-over-100-billion-parameters/)

![ุชูุงุฒู ุจูุงูุงุช ZeRO](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/parallelism-zero.png)

(ุงููุตุฏุฑ: [ุงูุฑุงุจุท](https://www.microsoft.com/en-us/research/blog/zero-deepspeed-new-system-optimizations-enable-training-models-with-over-100-billion-parameters/))

 ุฃ. **ุงููุฑุญูุฉ 1**: ุดุธุงูุง ุญุงูุงุช ุงููุญุณู ุนุจุฑ ุนูุงู/ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุงููุชูุงุฒูุฉ ููุจูุงูุงุช
 ุจ. **ุงููุฑุญูุฉ 2**: ุดุธุงูุง ุญุงูุงุช ุงูุชุฏุฑุฌ + ุงููุญุณู ุนุจุฑ ุนูุงู/ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุงููุชูุงุฒูุฉ ููุจูุงูุงุช
 ุฌ. **ุงููุฑุญูุฉ 3**: ุดุธุงูุง ุญุงูุงุช ุงูุชุฏุฑุฌ + ุงููุญุณู + ูุนููุงุช ุงููููุฐุฌ ุนุจุฑ ุนูุงู/ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุงููุชูุงุฒูุฉ ููุจูุงูุงุช
 ุฏ. **ุชุญุณูู ุงูุชูุฑูุบ**: ูููู ุจุชูุฑูุบ ุงูุชุฏุฑุฌุงุช + ุญุงูุงุช ุงููุญุณู ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ/ุงููุฑุต ุจูุงุกู ุนูู ZERO Stage 2
 ูู. **ุชูุฑูุบ ุงููุนููุฉ**: ูููู ุจุชูุฑูุบ ูุนููุงุช ุงููููุฐุฌ ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ/ุงููุฑุต ุจูุงุกู ุนูู ZERO Stage 3
 ู. **ุงูุชุฌุฒุฆุฉ ุงููุฑููุฉ**: ุชููู ุงูุชุฏุฑูุจ ูุชุนุฏุฏ ุงูุนูุฏ ุจููุงุกุฉ ูุน ุงูุชุฏุฑูุจ ุงููุชูุงุฒู ููุจูุงูุงุช ุนุจุฑ ุงูุนูุฏ ูุชุฌุฒุฆุฉ ZeRO-3 ุฏุงุฎู ุงูุนูุฏุฉุ ุงููุจููุฉ ุนูู ZeRO Stage 3.

> ููุงุญุธุฉ: ูููุง ูุชุนูู ุจุชูุฑูุบ ุงููุฑุตุ ูุฌุจ ุฃู ูููู ุงููุฑุต NVME ููุญุตูู ุนูู ุณุฑุนุฉ ุฌูุฏุฉ ููููู ูุนูู ูู ุงููุงุญูุฉ ุงููููุฉ ุนูู ุฃู ูุฑุต.

ุงูุงุณุชุฏูุงู:

1. ูุฏุนู DeepSpeed ZeRO Inference ูุฑุญูุฉ ZeRO 3 ูุน ZeRO-Infinity. ูุณุชุฎุฏู ููุณ ุจุฑูุชูููู ZeRO ูุซู ุงูุชุฏุฑูุจุ ููููู ูุง ูุณุชุฎุฏู ูุญุณููุง ููุฎุทุทูุง ููุชุนูู ููุนุฏู ุงูุฎุทุฃุ ูุงููุฑุญูุฉ 3 ููุท ุฐุงุช ุตูุฉ. ููุฒูุฏ ูู ุงูุชูุงุตููุ ุฑุงุฌุน: [deepspeed-zero-inference](#deepspeed-zero-inference).

## ููู ูุนููุ

**ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ**: ูู ุจุชุซุจูุช DeepSpeed ุงูุฅุตุฏุงุฑ >=0.6.5. ูุฑุฌู ุงูุฑุฌูุน ุฅูู [ุชูุงุตูู ุชุซุจูุช DeepSpeed](https://github.com/microsoft/DeepSpeed#installation) ููุฒูุฏ ูู ุงููุนูููุงุช.

ุณูููู ูุธุฑุฉ ุฃููุงู ุนูู ุชูุงูู ุณูู ุงูุงุณุชุฎุฏุงู ุนุจุฑ `accelerate config`.

ุชูููุง ุฃูุซุฑ ูุฑููุฉ ูุบููุฉ ุจุงูููุฒุงุช `ุฏูุฌ ููู ุชูููู DeepSpeed`.

### ูููู ุฅุถุงูู DeepSpeed ุงููุนุฌู

ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู (ุฃุฌูุฒุชู) ููุท ูู ุจุชุดุบูู:

```bash
accelerate config
```

ูุงูุฅุฌุงุจุฉ ุนู ุงูุฃุณุฆูุฉ ุงููุทุฑูุญุฉ. ุณูุณุฃูู ุนูุง ุฅุฐุง ููุช ุชุฑูุฏ ุงุณุชุฎุฏุงู ููู ุชูููู ูู DeepSpeed ูุงูุฐู ูุฌุจ ุฃู ุชุฌูุจ ุนููู ุจูุง. ุซู ุฃุฌุจ ุนู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ ูุฅูุดุงุก ุชูููู DeepSpeed ุงูุฃุณุงุณู.

ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ููู ุชูููู ุณูุชู ุงุณุชุฎุฏุงูู ุชููุงุฆููุง ูุถุจุท

ุงูุฎูุงุฑุงุช ุงูุงูุชุฑุงุถูุฉ ุนูุฏ ุงูููุงู ุจุฐูู

```bash
accelerate launch my_script.py --args_to_my_script
```

ุนูู ุณุจูู ุงููุซุงูุ ุฅููู ููููุฉ ุชุดุบูู ูุซุงู NLP `examples/nlp_example.py` (ูู ุงูุฌุฐุฑ ุงููุณุชูุฏุน) ุจุงุณุชุฎุฏุงู ูููู DeepSpeed ุงูุฅุถุงูู:

**ูุซุงู ุนูู ูุฑุญูุฉ ZeRO Stage-2 DeepSpeed Plugin**

```bash
compute_environment: LOCAL_MACHINE
deepspeed_config:
gradient_accumulation_steps: 1
gradient_clipping: 1.0
offload_optimizer_device: none
offload_param_device: none
zero3_init_flag: true
zero_stage: 2
distributed_type: DEEPSPEED
fsdp_config: {}
machine_rank: 0
main_process_ip: null
main_process_port: null
main_training_function: main
mixed_precision: fp16
num_machines: 1
num_processes: 2
use_cpu: false
```

```bash
accelerate launch examples/nlp_example.py --mixed_precision fp16
```

**ูุซุงู ุนูู ูุฑุญูุฉ ZeRO Stage-3 ูุน ุชูุฑูุบ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ DeepSpeed Plugin**

```bash
compute_environment: LOCAL_MACHINE
deepspeed_config:
gradient_accumulation_steps: 1
gradient_clipping: 1.0
offload_optimizer_device: cpu
offload_param_device: cpu
zero3_init_flag: true
zero3_save_16bit_model: true
zero_stage: 3
distributed_type: DEEPSPEED
fsdp_config: {}
machine_rank: 0
main_process_ip: null
main_process_port: null
main_training_function: main
mixed_precision: fp16
num_machines: 1
num_processes: 2
use_cpu: false
```

```bash
accelerate launch examples/nlp_example.py --mixed_precision fp16
```

ูุฏุนู ุญุงูููุง `Accelerate` ุงูุชูููู ุงูุชุงูู ุนุจุฑ ูุงุฌูุฉ ุณุทุฑ ุงูุฃูุงูุฑ:

```bash
`zero_stage`: [0] Disabledุ [1] ุชุฌุฒุฆุฉ ุญุงูุฉ ุงููุญุณูุ [2] ุชุฌุฒุฆุฉ ุญุงูุฉ ุงูุชุฏุฑุฌ + ุงููุญุณู ู[3] ุชุฌุฒุฆุฉ ุงูุชุฏุฑุฌ + ุงููุญุณู + ุชุฌุฒุฆุฉ ุงููุนููุงุช
`gradient_accumulation_steps`: ุนุฏุฏ ุฎุทูุงุช ุงูุชุฏุฑูุจ ูุชุฑุงูู ุงูุชุฏุฑุฌุงุช ูุจู ูุชูุณุทูุง ูุชุทุจูููุง.
`gradient_clipping`: ุชูููู ูุต ุงูุชุฏุฑุฌ ุจุงููููุฉ.
`offload_optimizer_device`: [none] ุชุนุทูู ุชูุฑูุบ ุงููุญุณูุ [cpu] ุชูุฑูุบ ุงููุญุณู ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉุ [nvme] ุชูุฑูุบ ุงููุญุณู ุฅูู SSD NVMe. ููุทุจู ููุท ูุน ZeRO >= Stage-2.
`offload_optimizer_nvme_path`: ูุญุฏุฏ ูุณุงุฑ Nvme ูุชูุฑูุบ ุญุงูุงุช ุงููุญุณู. ุฅุฐุง ูู ูุชู ุชุญุฏูุฏูุ ูุณูุชู ุชุนูููู ุงูุชุฑุงุถููุง ุนูู 'none'.
`offload_param_device`: [none] ุชุนุทูู ุชูุฑูุบ ุงููุนููุฉุ [cpu] ุชูุฑูุบ ุงููุนููุงุช ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉุ [nvme] ุชูุฑูุบ ุงููุนููุงุช ุฅูู SSD NVMe. ููุทุจู ููุท ูุน ูุฑุญูุฉ ZeRO 3.
`offload_param_nvme_path`: ูุญุฏุฏ ูุณุงุฑ Nvme ูุชูุฑูุบ ุงููุนููุงุช. ุฅุฐุง ูู ูุชู ุชุญุฏูุฏูุ ูุณูุชู ุชุนูููู ุงูุชุฑุงุถููุง ุนูู 'none'.
`zero3_init_flag`: ููุฑุฑ ูุง ุฅุฐุง ูุงู ุณูุชู ุชูููู `deepspeed.zero.Init` ูุจูุงุก ุงูููุงุฐุฌ ุงูุถุฎูุฉ. ููุทุจู ููุท ูุน ูุฑุญูุฉ ZeRO 3.
`zero3_save_16bit_model`: ููุฑุฑ ูุง ุฅุฐุง ูุงู ุณูุชู ุญูุธ ุฃูุฒุงู ุงููููุฐุฌ 16 ุจุช ุนูุฏ ุงุณุชุฎุฏุงู ูุฑุญูุฉ ZeRO 3.
`mixed_precision`: `no` ููุชุฏุฑูุจ FP32ุ `fp16` ููุชุฏุฑูุจ ุนูู ุงูุฏูุฉ ุงููุฎุชูุทุฉ FP16 ู`bf16` ููุชุฏุฑูุจ ุนูู ุงูุฏูุฉ ุงููุฎุชูุทุฉ BF16.
`deepspeed_moe_layer_cls_names`: ูุงุฆูุฉ ููุตููุฉ ุจููุงุตู ูุฃุณูุงุก ูุฆุงุช ุทุจูุฉ Mixture-of-Experts (MoE) ุงููุญููุฉ (ุญุณุงุณุฉ ูุญุงูุฉ ุงูุฃุญุฑู) ููุชุบูููุ ุนูู ุณุจูู ุงููุซุงูุ `MixtralSparseMoeBlock`ุ `Qwen2MoeSparseMoeBlock`ุ `JetMoEAttention,JetMoEBlock` ...
`deepspeed_hostfile`: ููู ุงููุถูู DeepSpeed ูุชูููู ููุงุฑุฏ ุงูุญูุณุจุฉ ูุชุนุฏุฏุฉ ุงูุนูุฏ.
`deepspeed_exclusion_filter`: ุณูุณูุฉ ุนุงูู ุชุตููุฉ ุงูุงุณุชุจุนุงุฏ DeepSpeed ุนูุฏ ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏ ูุชุนุฏุฏ ุงูุนูุฏ.
`deepspeed_inclusion_filter`: ุณูุณูุฉ ุนุงูู ุชุตููุฉ ุงูุฅุฏุฑุงุฌ DeepSpeed ุนูุฏ ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏ ูุชุนุฏุฏ ุงูุนูุฏ.
`deepspeed_multinode_launcher`: ุจุฑูุงูุฌ ุงูุฅุทูุงู ูุชุนุฏุฏ ุงูุนูุฏ DeepSpeed ุงูุฐู ุณูุชู ุงุณุชุฎุฏุงูู. ุฅุฐุง ูู ูุชู ุชุญุฏูุฏูุ ูุณูุชู ุชุนูููู ุงูุชุฑุงุถููุง ุนูู "pdsh".
`deepspeed_config_file`: ูุณุงุฑ ุฅูู ููู ุชูููู DeepSpeed ุจุชูุณูู "json". ุฑุงุฌุน ุงููุณู ุงูุชุงูู ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ูุฐุง.
```

ููุชููู ูู ุถุจุท ุงููุฒูุฏ ูู ุงูุฎูุงุฑุงุชุ ุณุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ููู ุชูููู DeepSpeed.
### ููู ุชูููู DeepSpeed

ุนูู ุฌูุงุฒู (ุฃุฌูุฒุชู)ุ ูู ููุท ุจุชุดุบูู ูุง ููู:

```bash
accelerate config
```

ูุฃุฌุจ ุนู ุงูุฃุณุฆูุฉ ุงููุทุฑูุญุฉ. ุณูุณุฃูู ุนูุง ุฅุฐุง ููุช ุชุฑูุฏ ุงุณุชุฎุฏุงู ููู ุชูููู ูู DeepSpeedุ ูุชุฌูุจ ุจู "ูุนู" ูุชูุฏู ูุณุงุฑ ููู ุชูููู DeepSpeed.

ุณูุคุฏู ุฐูู ุฅูู ุฅูุดุงุก ููู ุชูููู ุณูุชู ุงุณุชุฎุฏุงูู ุชููุงุฆููุง ูุถุจุท ุงูุฎูุงุฑุงุช ุงูุงูุชุฑุงุถูุฉ ุจุดูู ุตุญูุญ ุนูุฏ ุงูููุงู ุจูุง ููู:

```bash
accelerate launch my_script.py --args_to_my_script
```

ุนูู ุณุจูู ุงููุซุงูุ ุฅููู ููููุฉ ุชุดุบูู ูุซุงู NLP `examples/by_feature/deepspeed_with_config_support.py` (ูู ุงูุฌุฐุฑ ุงูุฎุงุต ุจุงููุณุชูุฏุน) ุจุงุณุชุฎุฏุงู ููู ุชูููู DeepSpeed:

**ูุซุงู ุนูู ููู ุชูููู DeepSpeed ููุฑุญูุฉ ZeRO 2**

```bash
compute_environment: LOCAL_MACHINE
deepspeed_config:
deepspeed_config_file: /home/ubuntu/accelerate/examples/configs/deepspeed_config_templates/zero_stage2_config.json
zero3_init_flag: true
distributed_type: DEEPSPEED
fsdp_config: {}
machine_rank: 0
main_process_ip: null
main_process_port: null
main_training_function: main
mixed_precision: fp16
num_machines: 1
num_processes: 2
use_cpu: false
```

ูุน ูุญุชููุงุช `zero_stage2_config.json` ููุง ููู:

```json
{
"fp16": {
"enabled": true,
"loss_scale": 0,
"loss_scale_window": 1000,
"initial_scale_power": 16,
"hysteresis": 2,
"min_loss_scale": 1
},
"optimizer": {
"type": "AdamW",
"params": {
"lr": "auto",
"weight_decay": "auto",
"torch_adam": true,
"adam_w_mode": true
}
},
"scheduler": {
"type": "WarmupDecayLR",
"params": {
"warmup_min_lr": "auto",
"warmup_max_lr": "auto",
"warmup_num_steps": "auto",
"total_num_steps": "auto"
}
},
"zero_optimization": {
"stage": 2,
"allgather_partitions": true,
"allgather_bucket_size": 2e8,
"overlap_comm": true,
"reduce_scatter": true,
"reduce_bucket_size": "auto",
"contiguous_gradients": true
},
"gradient_accumulation_steps": 1,
"gradient_clipping": "auto",
"steps_per_print": 2000,
"train_batch_size": "auto",
"train_micro_batch_size_per_gpu": "auto",
"wall_clock_breakdown": false
}
```

```bash
accelerate launch examples/by_feature/deepspeed_with_config_support.py \
--config_name "gpt2-large" \
--tokenizer_name "gpt2-large" \
--dataset_name "wikitext" \
--dataset_config_name "wikitext-2-raw-v1" \
--block_size 128 \
--output_dir "./clm/clm_deepspeed_stage2_accelerate" \
--learning_rate 5e-4 \
--per_device_train_batch_size 24 \
--per_device_eval_batch_Multiplier 24 \
--num_train_epochs 3 \
--with_tracking \
--report_to "wandb"\
```

**ูุซุงู ุนูู ููู ุชูููู DeepSpeed ููุฑุญูุฉ ZeRO 3 ูุน ุฅุฒุงุญุฉ ุงูุชุญููู ุฅูู CPU**

```bash
compute_environment: LOCAL_MACHINE
deepspeed_config:
deepspeed_config_file: /home/ubuntu/accelerate/examples/configs/deepspeed_config_templates/zero_stage3_offload_config.json
zero3_init_flag: true
distributed_type: DEEPSPEED
fsdp_config: {}
machine_rank: 0
main_process_ip: null
main_process_port: null
main_training_function: main
mixed_precision: fp16
num_machines: 1
num_processes: 2
use_cpu: false
```

ูุน ูุญุชููุงุช `zero_stage3_offload_config.json` ููุง ููู:

```json
{
"fp16": {
"enabled": true,
"loss_scale": 0,
"loss_scale_window": 1000,
"initial_scale_power": 16,
"hysteresis": 2,
"min_loss_scale": 1
},
"optimizer": {
"type": "AdamW",
"params": {
"lr": "auto",
"weight_decay": "auto"
}
},
"scheduler": {
"type": "WarmupDecayLR",
"params": {
"warmup_min_lr": "auto",
"warmup_max_lr": "auto",
"warmup_num_steps": "auto",
"total_num_steps": "auto"
}
},
"zero_optimization": {
"stage": 3,
"offload_optimizer": {
"device": "cpu",
"pin_memory": true
},
"offload_param": {
"device": "cpu",
"pin_memory": true
},
"overlap_comm": true,
"contiguous_gradients": true,
"reduce_bucket_size": "auto",
"stage3_prefetch_bucket_size": "auto",
"stage3_param_persistence_threshold": "auto",
"sub_group_size": 1e9,
"stage3_max_live_parameters": 1e9,
"stage3_max_reuse_distance": 1e9,
"stage3_gather_16bit_weights_on_model_save": "auto"
},
"gradient_accumulation_steps": 1,
"gradient_clipping": "auto",
"steps_per_print": 2000,
"train_batch_size": "auto",
"train_micro_batch_size_per_gpu": "auto",
"wall_clock_breakdown": false
}
```

```bash
accelerate launch examples/by_feature/deepspeed_with_config_support.py \
--config_name "gpt2-large" \
--tokenizer_name "gpt2-large" \
--dataset_name "wikitext" \
--dataset_config_name "wikitext-2-raw-v1" \
--block_size 128 \
--output_dir "./clm/clm_deepspeed_stage3_offload_accelerate" \
--learning_rate 5e-4 \
--per_device_train_batch_size 32 \
--per_device_eval_batch_size 32 \
--num_train_epochs 3 \
--with_tracking \
--report_to "wandb"\
```

**ูุซุงู ุนูู ุชูููู ZeRO++**

ููููู ุงุณุชุฎุฏุงู ููุฒุงุช ZeRO++ ูู ุฎูุงู ุงุณุชุฎุฏุงู ูุนููุงุช ุงูุชูููู ุงูููุงุณุจุฉ. ูุงุญุธ ุฃู ZeRO++ ูู ุงูุชุฏุงุฏ ูู ZeRO Stage 3. ูููุง ููู ููููุฉ ุชุนุฏูู ููู ุงูุชููููุ ูู [ุฏููู DeepSpeed ุญูู ZeRO++](https://www.deepspeed.ai/tutorials/zeropp/):

```json
{
"zero_optimization": {
"stage": 3,
"reduce_bucket_size": "auto",

"zero_quantized_weights": true,
"zero_hpz_partition_size": 8,
"zero_quantized_gradients": true,

"contiguous_gradients": true,
"overlap_comm": true
}
}
```

ุจุงููุณุจุฉ ููุชุฌุฒุฆุฉ ุงููุฑููุฉุ ูุฌุจ ุชุนููู ุญุฌู ุงูุชุฌุฒุฆุฉ `zero_hpz_partition_size` ุจุดูู ูุซุงูู ุฅูู ุนุฏุฏ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU) ููู ุนูุฏุฉ. (ุนูู ุณุจูู ุงููุซุงูุ ููุชุฑุถ ููู ุงูุชูููู ุฃุนูุงู 8 ูุญุฏุงุช GPU ููู ุนูุฏุฉ)

**ุชุบููุฑุงุช ุงูุดูุฑุฉ ุงููููุฉ ุนูุฏ ุงุณุชุฎุฏุงู ููู ุชูููู DeepSpeed**

1. ูุญุณูุงุช DeepSpeed ูุฌุฏุงูููุง ุงูุฒูููุฉ: ููุญุตูู ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ูุฐู ุงูููุถูุนุงุชุ ูุฑุฌู ุงูุงุทูุงุน ุนูู ูุซุงุฆู [ูุญุณูุงุช DeepSpeed](https://deepspeed.readthedocs.io/en/latest/optimizers.html) ู[ุฌุฏุงูู DeepSpeed ุงูุฒูููุฉ](https://deepspeed.readthedocs.io/en/latest/schedulers.html). ูุณูููู ูุธุฑุฉ ุนูู ุงูุชุบููุฑุงุช ุงููุทููุจุฉ ูู ุงูุดูุฑุฉ ุนูุฏ ุงุณุชุฎุฏุงู ูุฐู ุงูููุฒุงุช.

   ุฃ) ูุญุณู DeepSpeed + ุฌุฏูู DeepSpeed ุงูุฒููู: ุงูุญุงูุฉ ุงูุชู ูููู ูููุง ูู ูู ููุชุงุญู `optimizer` ู`scheduler` ููุฌูุฏูู ูู ููู ุชูููู DeepSpeed. ูู ูุฐู ุงูุญุงูุฉุ ุณูุชู ุงุณุชุฎุฏุงูููุง ููุฌุจ ุนูู ุงููุณุชุฎุฏู ุงุณุชุฎุฏุงู `accelerate.utils.DummyOptim` ู`accelerate.utils.DummyScheduler` ููุญู ูุญู ุงููุญุณูุงุช ูุงูุฌุฏุงูู ุงูุฒูููุฉ ูู PyTorch/ุงููุฎุตุตุฉ ูู ุดูุฑุชู.

   ูููุง ููู ููุชุทู ูู `examples/by_feature/deepspeed_with_config_support.py` ููุถุญ ุฐูู:

   ```python
   # ุฅูุดุงุก ูุญุณู Dummy ุฅุฐุง ุชู ุชุญุฏูุฏ "optimizer" ูู ููู ุงูุชููููุ ูุฅูุง ูู ุจุฅูุดุงุก ูุญุณู Adam
   optimizer_cls = (
   torch.optim.AdamW
   if accelerator.state.deepspeed_plugin is None
   or "optimizer" not in accelerator.state.deepspeed_plugin.deepspeed_config
   else DummyOptim
   )
   optimizer = optimizer_cls(optimizer_grouped_parameters, lr=args.learning_rate)

   # ุฅูุดุงุก ุฌุฏูู ุฒููู Dummy ุฅุฐุง ุชู ุชุญุฏูุฏ "scheduler" ูู ููู ุงูุชููููุ ูุฅูุง ูู ุจุฅูุดุงุก ุฌุฏูู ุฒููู ูู ุงูููุน "args.lr_scheduler_type"
   if (
   accelerator.state.deepspeed_plugin is None
   or "scheduler" not in accelerator.state.deepspeed_plugin.deepspeed_config
   ):
   lr_scheduler = get_scheduler(
   name=args.lr_scheduler_type,
   optimizer=optimizer,
   num_warmup_steps=args.num_warmup_steps,
   num_training_steps=args.max_train_steps,
   )
   else:
   lr_scheduler = DummyScheduler(
   optimizer, total_num_steps=args.max_train_steps, warmup_num_steps=args.num_warmup_steps
   )
   ```

   ุจ) ูุญุณู ูุฎุตุต + ุฌุฏูู ุฒููู ูุฎุตุต: ุงูุญุงูุฉ ุงูุชู ูููู ูููุง ูู ูู ููุชุงุญู `optimizer` ู`scheduler` ุบุงุฆุจูู ูู ููู ุชูููู DeepSpeed. ูู ูุฐู ุงูุญุงูุฉุ ูุง ููุฒู ุฅุฌุฑุงุก ุฃู ุชุบููุฑุงุช ุนูู ุงูุดูุฑุฉ ูู ูุจู ุงููุณุชุฎุฏูุ ููุฐู ูู ุงูุญุงูุฉ ุนูุฏ ุงุณุชุฎุฏุงู ุงูุชูุงูู ุนุจุฑ ูููู ุฅุถุงูู ูู DeepSpeed.

   ูู ุงููุซุงู ุฃุนูุงูุ ูููููุง ุฃู ูุฑู ุฃู ุงูุดูุฑุฉ ุชุจูู ุฏูู ุชุบููุฑ ุฅุฐุง ูุงูุช ููุงุชูุญ `optimizer` ู`scheduler` ุบุงุฆุจุฉ ูู ููู ุชูููู DeepSpeed.

   ุฌ) ูุญุณู ูุฎุตุต + ุฌุฏูู DeepSpeed ุงูุฒููู: ุงูุญุงูุฉ ุงูุชู ูููู ูููุง ููุชุงุญ `scheduler` ููุท ููุฌูุฏูุง ูู ููู ุชูููู DeepSpeed. ูู ูุฐู ุงูุญุงูุฉุ ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุงุณุชุฎุฏุงู `accelerate.utils.DummyScheduler` ููุญู ูุญู ุงูุฌุฏูู ุงูุฒููู ูู PyTorch/ุงููุฎุตุต ูู ุดูุฑุชู.

   ุฏ) ูุญุณู DeepSpeed + ุฌุฏูู ุฒููู ูุฎุตุต: ุงูุญุงูุฉ ุงูุชู ูููู ูููุง ููุชุงุญ `optimizer` ููุท ููุฌูุฏูุง ูู ููู ุชูููู DeepSpeed. ุณูุคุฏู ุฐูู ุฅูู ุญุฏูุซ ุฎุทุฃ ูุฃูู ูุง ููููู ุงุณุชุฎุฏุงู ุฌุฏูู DeepSpeed ุงูุฒููู ุฅูุง ุนูุฏ ุงุณุชุฎุฏุงู ูุญุณู DeepSpeed.

2. ูุงุญุธ ููู "auto" ูู ูููุงุช ุชูููู DeepSpeed ูู ุงูุฃูุซูุฉ ุฃุนูุงู. ุชุชู ูุนุงูุฌุฉ ูุฐู ุงูููู ุชููุงุฆููุง ุจูุงุณุทุฉ ุทุฑููุฉ `prepare` ุจูุงุกู ุนูู ุงููููุฐุฌุ ูุฏูุฑุงุช ุงูุชุฏุฑูุจุ ูุงููุญุณูุงุช ูุงูุฌุฏุงูู ุงูุฒูููุฉ ุงูููููุฉ ุงูููุฏูุฉ ุฅูู ุทุฑููุฉ `prepare`.

   ุชุชู ูุนุงูุฌุฉ ููู "auto" ุงููุญุฏุฏุฉ ูู ุงูุฃูุซูุฉ ุฃุนูุงู ููุท ุจูุงุณุทุฉ ุทุฑููุฉ `prepare`ุ ููุฌุจ ุนูู ุงููุณุชุฎุฏู ุชุญุฏูุฏ ุงูููู ุงูุฃุฎุฑู ุตุฑุงุญุฉ.

   ูุชู ุญุณุงุจ ููู "auto" ุนูู ุงููุญู ุงูุชุงูู:

   - `reduce_bucket_size`: `hidden_size * hidden_size`
   - `stage3_prefetch_bucket_size`: `int(0.9 * hidden_size * hidden_size)`
   - `stage3_param_persistence_threshold`: `10 * hidden_size`

   ุจุงููุณุจุฉ ูููุฒุฉ "auto" ููุนูู ููุฐู ุงูุฅุฏุฎุงูุงุช ุงูุซูุงุซุฉ ูู ููู ุงูุชูููู - ุณูุณุชุฎุฏู Accelerate `model.config.hidden_size` ุฃู `max(model.config.hidden_sizes)` ูู `hidden_size`. ุฅุฐุง ูู ููู ุฃู ูู ูุฐูู ูุชุงุญูุงุ ูุณูู ููุดู ุงูุฅุทูุงู ูุณูุชุนูู ุนููู ุชุนููู ุฅุฏุฎุงูุงุช ููู ุงูุชูููู ูุฐู ูุฏูููุง. ุชุฐูุฑ ุฃู ุฃูู ุฅุฏุฎุงููู ูููู ุงูุชูููู ููุง ูุฎุงุฒู ูุคูุชุฉ ููุงุชุตุงูุงุช - ูููุง ูุจุฑุชุ ุฒุงุฏุช ููุงุกุฉ ุงูุงุชุตุงูุงุชุ ููููุง ูุจุฑุชุ ุงุณุชูููุช ุงููุฒูุฏ ูู ุฐุงูุฑุฉ ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช (GPU)ุ ูุฐุง ููู ูุงุจูุฉ ููุถุจุท ููููุง ูุฃุฏุงุก ุงูููุงูุถุฉ.

**ุฃุดูุงุก ูุฌุจ ููุงุญุธุชูุง ุนูุฏ ุงุณุชุฎุฏุงู ููู ุชูููู DeepSpeed**

ูููุง ููู ูููุฐุฌ ูู ุงูุดูุฑุฉ ูุณุชุฎุฏู `deepspeed_config_file` ูู ุณููุงุฑูููุงุช ูุฎุชููุฉ:

ุดูุฑุฉ `test.py`:

```python
from accelerate import Accelerator
from accelerate.state import AcceleratorState


def main():
accelerator = Accelerator()
accelerator.print(f"{AcceleratorState()}")


if __name__ == "__main__":
main()
```

**ุงูุณููุงุฑูู 1**: ููู ุชูููู Accelerate ุงูุฐู ุชู ุงูุชูุงุนุจ ุจู ูุฏูููุง ูุงูุฐู ูุญุชูู ุนูู `deepspeed_config_file` ุฅูู ุฌุงูุจ ุฅุฏุฎุงูุงุช ุฃุฎุฑู.

1. ูุญุชููุงุช ููู ุชูููู `accelerate`:

   ```yaml
   command_file: null
   commands: null
   compute_environment: LOCAL_MACHINE
   deepspeed_config:
   gradient_accumulation_steps: 1
   gradient_clipping: 1.0
   offload_optimizer_device: 'cpu'
   offload_param_device: 'cpu'
   zero3_init_flag: true
   zero3_save_16bit_model: true
   zero_stage: 3
   deepspeed_config_file: 'ds_config.json'
   distributed_type: DEEPSPEED
   downcast_bf16: 'no'
   dynamo_backend: 'NO'
   fsdp_config: {}
   gpu_ids: null
   machine_rank: 0
   main_process_ip: null
   main_process_port: null
   main_training_function: main
   megatron_lm_config: {}
   num_machines: 1
   num_processes: 2
   rdzv_backend: static
   same_network: true
   tpu_name: null
   tpu_zone: null
   use_cpu: false
   ```

2. `ds_config.json`:

   ```json
   {
   "bf16": {
   "enabled": true
   },
   "zero_optimization": {
   "stage": 3,
   "stage3_gather_16bit_weights_on_model_save": false,
   "offload_optimizer": {
   "device": "none"
   },
   "offload_param": {
   "device": "none"
   }
   },
   "gradient_clipping": 1.0,
   "train_batch_size": "auto",
   "train_micro_batch_size_per_gpu": "auto",
   "gradient_accumulation_steps": 10,
   "steps_per_print": 2000000
   }
   ```

3. ุฅุฎุฑุงุฌ `accelerate launch test.py`:

   ```bash
   ValueError: When using `deepspeed_config_file`, the following accelerate config variables will be ignored:
   ['gradient_accumulation_steps', 'gradient_clipping', 'zero_stage', 'offload_optimizer_device', 'offload_param_device',
   'zero3_save_16bit_model', 'mixed_precision'].
   Please specify them appropriately in the DeepSpeed config file.
   If you are using an accelerate config file, remove other config variables mentioned in the above specified list.
   The easiest method is to create a new config following the questionnaire via `accelerate config`.
   It will only ask for the necessary config variables when using `deepspeed_config_file`.
   ```

**ุงูุณููุงุฑูู 2**: ุงุณุชุฎุฏู ุญู ุงูุฎุทุฃ ูุฅูุดุงุก ููู ุชูููู ุฌุฏูุฏ ูุชุญูู ูู ุนุฏู ุธููุฑ ุฎุทุฃ ุงูุบููุถ ุงูุขู.

1. ูู ุจุชุดุบูู `accelerate config`:

   ```bash
   $ accelerate config
   -------------------------------------------------------------------------------------------------------------------------------
   On which compute environment are you running?
   This machine
   -------------------------------------------------------------------------------------------------------------------------------
   What type of machine are you using?
   multi-GPU
   How many different machines will you use (use more than 1 for multi-node training)? [1]:
   Do you wish to optimize your script with torch dynamo?[yes/NO]:
## ุงูุญูุธ ูุงูุชุญููู

1. ูู ูุชุบูุฑ ุญูุธ ูุชุญููู ุงูููุงุฐุฌ ูู ZeRO Stage-1 ูStage-2.
2. ูู ZeRO Stage-3ุ ูุญุชูู `state_dict` ููุท ุนูู ุงููุคุดุฑุงุช ุงูููุงููุฉ ูุฃู ุฃูุฒุงู ุงููููุฐุฌ ูุฌุฒุฃุฉ ุนุจุฑ ุนุฏุฉ ูุญุฏุงุช ูุนุงูุฌุฉ ุฑุณูููุฉ. ูููุฑ ZeRO Stage-3 ุฎูุงุฑูู:

ุฃ. ุญูุธ ุฃูุฒุงู ุงููููุฐุฌ ุงููุงููุฉ ุฐุงุช 16 ุจุช ูุชุญููููุง ูุจุงุดุฑุฉ ูู ููุช ูุงุญู ุจุงุณุชุฎุฏุงู `model.load_state_dict(torch.load(pytorch_model.bin))`.

ููุฐุงุ ูู ุจุชุนููู `zero_optimization.stage3_gather_16bit_weights_on_model_save` ุฅูู True ูู ููู ุชูููู DeepSpeed ุฃู ูู ุจุชุนููู `zero3_save_16bit_model` ุฅูู True ูู DeepSpeed Plugin.

**ูุงุญุธ ุฃู ูุฐุง ุงูุฎูุงุฑ ูุชุทูุจ ุชูุญูุฏ ุงูุฃูุฒุงู ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณูููุฉ ูุงุญุฏุฉุ ููููู ุฃู ูููู ุจุทูุฆูุง ููุณุชููููุง ููุฐุงูุฑุฉุ ูุฐุง ุงุณุชุฎุฏู ูุฐู ุงูููุฒุฉ ุนูุฏ ุงูุญุงุฌุฉ ููุท.**

ูููุง ููู ููุชุทู ูู `examples/by_feature/deepspeed_with_config_support.py` ููุถุญ ุฐูู:

```python
unwrapped_model = accelerator.unwrap_model(model)

# New Code #
# Saves the whole/unpartitioned fp16 model when in ZeRO Stage-3 to the output directory if
# `stage3_gather_16bit_weights_on_model_save` is True in DeepSpeed Config file or
# `zero3_save_16bit_model` is True in DeepSpeed Plugin.
# For Zero Stages 1 and 2, models are saved as usual in the output directory.
# The model name saved is `pytorch_model.bin`
unwrapped_model.save_pretrained(
args.output_dir,
is_main_process=accelerator.is_main_process,
save_function=accelerator.save,
state_dict=accelerator.get_state_dict(model),
)
```

ุจ. ููุญุตูู ุนูู ุฃูุฒุงู 32 ุจุชุ ูู ุฃููุงู ุจุญูุธ ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู `model.save_checkpoint()`.

ูููุง ููู ููุชุทู ูู `examples/by_feature/deepspeed_with_config_support.py` ููุถุญ ุฐูู:

```python
success = model.save_checkpoint(PATH, ckpt_id, checkpoint_state_dict)
status_msg = f"checkpointing: PATH={PATH}, ckpt_id={ckpt_id}"
if success:
logging.info(f"Success {status_msg}")
else:
logging.warning(f"Failure {status_msg}")
```

ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ุฃูุณุงู ูููุฐุฌ ZeRO ูููุณุงู ุงููุญุณู ุฅูู ุฌุงูุจ `zero_to_fp32.py` script ูู ุฏููู ููุทุฉ ุงูุชูุชูุด.

ููููู ุงุณุชุฎุฏุงู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ููููุงู ุจุงูุฏูุฌ ุบูุฑ ุงููุชุตู. ูุง ูุชุทูุจ ูููุงุช ุชูููู ุฃู ูุญุฏุงุช ูุนุงูุฌุฉ ุฑุณูููุฉ. ูููุง ููู ูุซุงู ุนูู ุงุณุชุฎุฏุงูู:

```bash
$ cd /path/to/checkpoint_dir
$ ./zero_to_fp32.py . pytorch_model.bin
Processing zero checkpoint at global_step1
Detected checkpoint of type zero stage 3, world_size: 2
Saving fp32 state dict to pytorch_model.bin (total_numel=60506624)
```

ููุญุตูู ุนูู ูููุฐุฌ 32 ุจุช ููุญูุธ/ุงูุงุณุชุฏูุงูุ ููููู ุงูููุงู ุจูุง ููู:

```python
from deepspeed.utils.zero_to_fp32 import load_state_dict_from_zero_checkpoint

unwrapped_model = accelerator.unwrap_model(model)
fp32_model = load_state_dict_from_zero_checkpoint(unwrapped_model, checkpoint_dir)
```

ุฅุฐุง ููุช ููุชููุง ููุท ุจู `state_dict`ุ ูููููู ุงูููุงู ุจูุง ููู:

```python
from deepspeed.utils.zero_to_fp32 import get_fp32_state_dict_from_zero_checkpoint

state_dict = get_fp32_state_dict_from_zero_checkpoint(checkpoint_dir)
```

ูุงุญุธ ุฃู ุฌููุน ูุฐู ุงููุธุงุฆู ุชุชุทูุจ ~2x ุฐุงูุฑุฉ (ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงูุนุงูุฉ) ูุญุฌู ููุทุฉ ุงูุชูุชูุด ุงูููุงุฆูุฉ.

## ุงุณุชุฏูุงู Zero

ูุฏุนู DeepSpeed Zero Inference ูุฑุญูุฉ Zero 3 ูุน Zero-Infinity.

ูุณุชุฎุฏู ููุณ ุจุฑูุชูููู Zero ููุง ูู ุงูุญุงู ูู ุงูุชุฏุฑูุจุ ููููู ูุง ูุณุชุฎุฏู ูุญุณููุง ููุฎุทุทูุง ููุนุฏู ุงูุชุนููุ ููุง ุชููู ุงููุฑุญูุฉ 3 ุฐุงุช ุตูุฉ.

ูุน ุชูุงูู ุงูุชุณุฑูุนุ ุชุญุชุงุฌ ููุท ุฅูู ุฅุนุฏุงุฏ ุงููููุฐุฌ ูdataloader ููุง ูู ููุถุญ ุฃุฏูุงู:

```python
model, eval_dataloader = accelerator.prepare(model, eval_dataloader)
```

## ุจุนุถ ุงูุชุญุฐูุฑุงุช ุงูุชู ูุฌุจ ูุฑุงุนุงุชูุง

1. ูุง ูุฏุนู ุงูุชูุงูู ุงูุญุงูู ููุงุฒุงุฉ ุงูุฃูุงุจูุจ ูู DeepSpeed.
2. ูุง ูุฏุนู ุงูุชูุงูู ุงูุญุงูู `mpu`ุ ููุง ูุญุฏ ูู ููุงุฒุงุฉ ุงููุตูููุฉ ุงููุฏุนููุฉ ูู Megatron-LM.
3. ูุง ูุฏุนู ุงูุชูุงูู ุงูุญุงูู ููุงุฐุฌ ูุชุนุฏุฏุฉ.

## ููุงุฑุฏ DeepSpeed

ูููู ุงูุนุซูุฑ ุนูู ุงููุซุงุฆู ุงูุฎุงุตุฉ ุจุงูุฌูุงูุจ ุงูุฏุงุฎููุฉ ุงููุชุนููุฉ ุจู deepspeed [ููุง](../package_reference/deepspeed).

- [ูุดุฑูุน GitHub](https://github.com/microsoft/deepspeed)
- [ูุซุงุฆู ุงูุงุณุชุฎุฏุงู](https://www.deepspeed.ai/getting-started/)
- [ูุซุงุฆู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช](https://deepspeed.readthedocs.io/en/latest/index.html)
- [ุงูููุดูุฑุงุช ุนูู ุงููุฏููุฉ](https://www.microsoft.com/en-us/research/search/?q=deepspeed)

ุงูุฃูุฑุงู:

- [ZeRO: Memory Optimizations Toward Training Trillion Parameter Models](https://arxiv.org/abs/1910.02054)
- [ZeRO-Offload: Democratizing Billion-Scale Model Training](https://arxiv.org/abs/2101.06840)
- [ZeRO-Infinity: Breaking the GPU Memory Wall for Extreme Scale Deep Learning](https://arxiv.org/abs/2104.07857)
- [ZeRO++: Extremely Efficient Collective Communication for Giant Model Training](https://arxiv.org/abs/2306.10209)

ุฃุฎูุฑูุงุ ูุฑุฌู ุชุฐูุฑ ุฃู ๐ค `Accelerate` ูุฏูุฌ DeepSpeed ููุทุ ูุฐูู ุฅุฐุง ูุงุฌูุชู ุฃู ูุดููุงุช ุฃู ุฃุณุฆูุฉ ุชุชุนูู ุจุงุณุชุฎุฏุงู DeepSpeedุ ููุฑุฌู ุฅุฑุณุงู ูุดููุฉ ุฅูู [DeepSpeed GitHub](https://github.com/microsoft/DeepSpeed/issues).

<Tip>

ุจุงููุณุจุฉ ูุฃููุฆู ุงูููุชููู ุจุฃูุฌู ุงูุชุดุงุจู ูุงูุงุฎุชูุงู ุจูู FSDP ูDeepSpeedุ ูุฑุฌู ุงูุงุทูุงุน ุนูู [ุฏููู ุงูููุงููู ููุง](../concept_guides/fsdp_and_deepspeed.md)!

</Tip>